{"version":3,"file":"bundle.js","sources":["../src/core/utils/utils.js","../src/core/load/load-spinner.js","../src/core/components/grabbable.js","../src/core/components/nav-pointer.js","../src/core/components/weather-viz.js","../src/core/components/shaderfrog/shader-frog.js","../src/aps/particle-player.js","../src/aps/particles.js","../src/demo/components/proximity-glitch.js","../src/stats/elements/ring-dial.js","../src/stats/elements/meter.js","../src/stats/stats.js","../src/core/components/game.js","../src/core/components/player.js","../src/core/socket/client-socket.js","../src/core/components/collectible.js","../src/core/login/login.js","../src/ae/aframe-effects.js","../src/demo/components/cloud.js","../src/demo/components/npc.js","../src/demo/components/dotrow.js","../src/core/components/userdata.js","../src/demo/components/iot-api.js","../src/core/components/log.js","../src/core/components/launchable.js","../src/demo/components/launchrow.js","../src/core/components/vrui/controls.js","../src/core/components/vrui/vrui.js","../src/core/components/chat.js","../src/core/components/cs1-jukebox.js","../src/core/components/my-components.js","../src/main.js","../src/core/services/bgm.js"],"sourcesContent":["export default CS1=>{\n  CS1.utils = {\n    uid: (()=>{\n        const firstItem = {\n            value: \"0\"\n        };\n        /*length can be increased for lists with more items.*/\n        let counter = \"123456789\".split('')\n            .reduce((acc, curValue, curIndex, arr) => {\n                const curObj = {};\n                curObj.value = curValue;\n                curObj.prev = acc;\n\n                return curObj;\n            }, firstItem);\n        firstItem.prev = counter;\n\n        return function () {\n            let now = Date.now();\n            if (typeof performance === \"object\" && typeof performance.now === \"function\") {\n                now = performance.now().toString().replace('.', '');\n            }\n            counter = counter.prev;\n            return `${now}${Math.random().toString(16).substr(2)}${counter.value}`;\n        }\n    })(),\n    \n    isEqual : function (value, other) {\n      \n      function compare(item1, item2) {\n\n        // Get the object type\n        var itemType = Object.prototype.toString.call(item1);\n\n        // If the two items are not the same type, return false\n        if (itemType !== Object.prototype.toString.call(item2)) return false;\n\n        // If it's a function, convert to a string and compare\n        // Otherwise, just compare\n        if (itemType === '[object Function]') {\n          if (item1.toString() !== item2.toString()) return false;\n        } else {\n          if (item1 !== item2) return false;\n        }\n      }\n      \n\n      // ...\n\n      // Compare properties\n      for (var key in value) {\n        if (value.hasOwnProperty(key)) {\n            if (compare(value[key], other[key]) === false) return false;\n        }\n      }\n\n      // If nothing failed, return true\n      return true;\n\n    },\n    \n    toColor: function (num) {\n          num >>>= 0;\n          var b = num & 0xFF,\n              g = (num & 0xFF00) >>> 8,\n              r = (num & 0xFF0000) >>> 16,\n              a = ( (num & 0xFF000000) >>> 24 ) / 255 ;\n          return \"rgba(\" + [r, g, b, a].join(\",\") + \")\";\n      },\n    \n    randomFromArray: function (array) {\n      if(array.length>0){\n        return array[Math.floor(Math.random()*array.length)];\n      }else{\n        return false;\n      }\n    }\n       \n\n  }\n}","export default(()=>{\n\n  window.addEventListener('load', function () {\n    let loadSpinner = document.createElement('div');\n    loadSpinner.className = 'lds-grid';\n    for(let i=0;i<9;i++){\n      loadSpinner.appendChild(document.createElement('div'));\n    } \n    loadSpinner.style.left = window.innerWidth/2 - 32 + 'px';\n    let loadingScreen =  document.querySelector('#loading-screen');\n    loadingScreen.style.width = window.innerWidth + 'px';\n    loadingScreen.style.height = window.innerHeight + 'px';\n    loadingScreen.appendChild(loadSpinner);\n  }, false);\n  \n})()","function findComponent(componentName)\n{\n\treturn document.querySelector(`[${componentName}]`).components[componentName];\n}\n//Moves the subject to a new parent while preserving its transform in the world\nfunction reparentObject3D(subject, newParent)\n{\n\tsubject.updateMatrixWorld();\n\tsubject.matrix.copy(subject.matrixWorld);\n\tsubject.applyMatrix(new THREE.Matrix4().getInverse(newParent.matrixWorld));\n\tnewParent.add(subject);\n}\n// Copys the world transforms between objects even if the have different parents\nvar copyTransform = (function()\n{\n\tvar scratchMat = new THREE.Matrix4();\n\treturn function(source, destination)\n\t{\n\t\tdestination.matrix.copy(source.matrixWorld);\n\t\tdestination.applyMatrix(scratchMat.getInverse(destination.parent.matrixWorld));\n\t}\n})();\nfunction toVector(o)\n{\n\treturn new THREE.Vector3(o.x, o.y, o.z);\n}\nfunction toList(collection)\n{\n\tvar list = [];\n\tfor(var i=0;i<collection.length;i++)\n\t{\n\t\tlist.push(collection[i]);\n\t}\n\treturn list;\n}\nfunction addDot(el, position, radius, color)\n{\n\tcolor = color || \"red\";\n\tvar dot = document.createElement(\"a-sphere\");\n\tdot.setAttribute(\"radius\", radius);\n\tdot.setAttribute(\"position\", position);\n\tdot.setAttribute(\"color\", color);\n\tel.appendChild(dot);\n}\nfunction directionLocalToWorld(object, localDirection)\n{\n\treturn localDirection.transformDirection(object.matrixWorld);\n}\n\nexport default (function grabbable(){\n  \n  \n  AFRAME.registerSystem('grabbable', {\n  schema: {},  // System schema. Parses into `this.data`.\n\n  init: function () {\n\n      //use object to allow for further development\n    CS1.grabbables={}; \n    \n    CS1.__updateGrabbables = (grabbablesData)=>{\n        if(Object.keys(CS1.grabbables).length === 0 || !CS1.grabbables[grabbablesData[0].name] || !CS1.game.hasBegun) return;\n        grabbablesData.forEach( (d,index)=>{\n          let b = CS1.grabbables[d.name];\n          if(CS1.debug){\n            console.log('Individual body data from server:');\n            console.log(d);\n          } \n          if(d.position) b.object3D.position.copy(d.position);\n          if(d.scale) b.object3D.scale.copy(d.scale);\n          if(d.rotation) b.object3D.quaternion.copy(d.rotation);\n      \n        });\n      }\n  \n    CS1.socket.on('add-grabbable-primitive',d=>{\n      if(d.origin==CS1.socket.id)return;\n      const entity = document.createElement(d.type);\n      entity.setAttribute('grabbable','remote:true');\n      entity.object3D.position.set(d.data.position.x,d.data.position.y,d.data.position.z);\n      entity.object3D.scale.set(d.data.scale.x,d.data.scale.y,d.data.scale.z);\n      entity.object3D.setRotationFromQuaternion(new THREE.Quaternion(d.data.rotation.x,d.data.rotation.y,d.data.rotation.z,d.data.rotation.w));\n      entity.soundState = d.data.soundState;\n      if(d.custom){\n        for (let [key, value] of Object.entries(d.custom)) {\n          if(value)entity.setAttribute(key,value);\n        }\n      }\n      CS1.scene.appendChild(entity);\n    });\n    \n  },\n\n  \n  });//end system definition\n  \n  AFRAME.registerComponent(\"grabbable\", {\n\tschema: {\n\t\torigin: { type: \"selector\" },\n    remote: { default: false}\n\t},\n\n\tinit: function()\n\t{\n\t\tvar self = this;\n    self.cursor = false;\n\t\tself.isDragging = false;\n\t\tself.originEl = this.data.origin || this.el;\n\t\tself.proxyObject = null;\n\n\t\tself.el.classList.add(\"interactive\");\n    \n    \n    if(self.el.components.log){\n      //this.el.components.log.data.channel = this.name;\n      self.el.setAttribute('log',`channel:${String(self.name)}`)\n      if(!CS1.socket._callbacks[\"$vr-log\"])\n      CS1.socket.on('vr-log',data=>{\n        CS1.log(data.msg ,String(data.channel));\n      });\n    }\n    \n    \n    self.name=Object.keys(CS1.grabbables).length;\n    CS1.grabbables[self.name]=self.el;\n    \n    if(CS1 && CS1.game && CS1.game.hasBegun && !this.data.remote){\n      console.log('Adding a grabbable after game has begun.');\n      const c = {};\n      c.color = self.el.getAttribute('color');\n      const s = self.el.getAttribute('src');\n      if(s) c.src = s;\n      onGameStart();\n      let d = {\n            name: self.name,\n            position: self.el.object3D.position,\n            scale: self.el.object3D.scale,\n            rotation: { \n              x: self.el.object3D.quaternion.x,\n              y: self.el.object3D.quaternion.y,\n              z: self.el.object3D.quaternion.z,\n              w: self.el.object3D.quaternion.w,\n            },\n            soundState: self.el.soundState\n          };\n      CS1.socket.emit('add-grabbable-primitive',{type:self.el.nodeName,\n                                                 data:d,\n                                                 custom:c,\n                                                 origin:CS1.socket.id\n                                            \n                                                });\n    }\n      \n    self.el.addEventListener(\"mousedown\", grab);\n    self.el.addEventListener(\"mouseup\", release);\n    \n    function onGameStart(){\n      \n      if(CS1.device==\"Mobile\"){\n  \n      self.el.addEventListener(\"click\", function(e){\n             grab(e);\n             setTimeout(function(e){\n               document.querySelector('#cam-cursor').setAttribute('material','color: yellow');\n               release(e);\n               setTimeout(function(e){\n                 document.querySelector('#cam-cursor').setAttribute('material','color: crimson');\n               },500);\n             },5000);\n      });\n          \n      self.el.addEventListener('mouseenter',e=>{\n              document.querySelector('#cam-cursor').setAttribute('material', {color: 'green'});\n            });\n      self.el.addEventListener('mouseleave',e=>{\n              document.querySelector('#cam-cursor').setAttribute('material', {color: 'crimson'})\n            });\n\n          \n      } else if(CS1.device==\"Standard\"){ //No headset and not mobile\n    \n          self.el.addEventListener('mouseenter',e=>{\n              document.querySelector('#cam-cursor').setAttribute('material', {color: 'green'});\n            });\n          self.el.addEventListener('mouseleave',e=>{\n              document.querySelector('#cam-cursor').setAttribute('material', {color: 'crimson'})\n            });\n      } \n      document.removeEventListener('gameStart', onGameStart);\n      \n    }\n    \n    document.addEventListener('gameStart', onGameStart);\n            \n    function grab(e){\n      \n\t\t\te.cancelBubble = true;\n\t\t\tif(self.isDragging) return;\n      \n\t\t\tself.isDragging = true;\n\n\t\t\tself.cursor = e.detail.cursorEl;\n\t\t\tif(self.cursor == self.el.sceneEl) self.cursor = document.querySelector(\"[camera]\"); //This handles the scenario where the user isn't using motion controllers\n      \n      \n      // avoid seeing flickering at origin during reparenting\n      self.el.setAttribute('visible', false);\n      setTimeout(function(){\n        self.el.setAttribute('visible', true);\n      },20);\n\n\t\t\tcreateProxyObject(self.cursor.object3D);\n\t\t\t\n\t\t\tself.originEl.emit(\"grabStart\", e);\n\t\t\tself.originEl.addState(\"moving\");\n\t\t}\n\n\t\tif(AFRAME.utils.device.checkHeadsetConnected () ){ \n      self.el.addEventListener(\"mouseup\", release);\n    }\n    else self.el.addEventListener(\"mouseup\", release);\n    \n    function release(e)\n\t\t{\n\t\t\tif(self.isDragging)\n\t\t\t{ \n        //CS1.socket.emit('logall',{msg:`${CS1.myPlayer.name} releasing!` ,channel:self.name});\n\t\t\t\tself.isDragging = false;\n\n\t\t\t\tif(self.proxyObject)\n\t\t\t\t{\n\t\t\t\t\tself.proxyObject.parent.remove(self.proxyObject);\n\t\t\t\t\tself.proxyObject = null;\n\t\t\t\t}\n\n\t\t\t\tself.originEl.setAttribute(\"position\", self.originEl.getAttribute(\"position\")); //seems pointless, but will force the event system to notify subscribers\n\t\t\t\tself.originEl.setAttribute(\"rotation\", self.originEl.getAttribute(\"rotation\")); //seems pointless, but will force the event system to notify subscribers\n\n\t\t\t\tself.originEl.emit(\"grabEnd\",e);\n\t\t\t\tself.originEl.removeState(\"moving\");\n       \n        \n       \n\t\t\t}\n\t\t}\n\n\t\tfunction createProxyObject(cursorObject)\n\t\t{\n\t\t\tself.proxyObject = new THREE.Object3D();\n      self.originEl.visible = false;\n      //handle object momentary flicker at world origin\n      setTimeout(function(){\n        self.originEl.visible = true;\n      },1000);\n\t\t\tcursorObject.add(self.proxyObject);\n\t\t\tcopyTransform(self.originEl.object3D, self.proxyObject);\t\t\t\t\n\t\t}\n    \n    \n    \n    \n    \n\t},\n\n\ttick: function()\n\t{\n\t\tvar self = this;\n\t\tif(self.proxyObject)\n\t\t{\n\t\t\tcopyTransform(self.proxyObject, self.originEl.object3D);\n\t\t\tself.originEl.setAttribute(\"position\", self.originEl.getAttribute(\"position\")); //seems pointless, but will force the event system to notify subscribers\n\t\t\t\tself.originEl.setAttribute(\"rotation\", self.originEl.getAttribute(\"rotation\")); //seems pointless, but will force the event system to notify subscribers\n\t\t}\n     \n\t}\n})\n  \n})()","export default (function navpointer(){\n\n  AFRAME.registerComponent('nav-pointer', {\n  init: function () {\n    const el = this.el;\n// On click, send the NPC to the target location.\n    el.addEventListener('click',e=>{\n      const ctrlEl = el.sceneEl.querySelector('[nav-agent]');\n      if(ctrlEl) ctrlEl.setAttribute('nav-agent', {\n        active: true,\n        destination: e.detail.intersection.point\n      });\n    });\n    el.addEventListener('mouseenter',e=>{\n      el.setAttribute('material', {color: 'green'});\n    });\n    el.addEventListener('mouseleave',e=>{\n      el.setAttribute('material', {color: 'crimson'})\n    });\n    \n    el.addEventListener('mousedown',e=>{\n      //console.log(e);\n    });\n \n    // Refresh the raycaster after models load.\n    el.sceneEl.addEventListener('object3dset',e=>{\n      this.el.components.raycaster.refreshObjects();\n    });\n  }\n});\n  \n})()","export default (function d3graph(){\n  \n  AFRAME.registerComponent('weather-viz', {\n    schema:{\n      side: {type:'string', default:'double'},\n      url: {type:'string', default:'https://api.openweathermap.org/data/2.5/forecast/?appid=56df5e300fabead0a56fc2d706e6aa7d&id=4959473'}\n    },\n    dependencies: ['geometry', 'material'],\n    init: function () {\n      this.el.setAttribute('width',6);\n      this.el.setAttribute('height',4);\n      this.canvas=document.createElement('canvas');\n      this.canvas.style.position = 'absolute';\n      this.canvas.style.left = -2000;\n      this.canvas.id=CS1.utils.uid();\n      this.canvas.setAttribute('crossOrigin','anonymous');\n      document.querySelector('a-scene').appendChild(this.canvas);\n      this.el.setAttribute('material',`shader:flat;src:#${this.canvas.id};side:${this.data.side}`);\n      \n      this.cursor = document.querySelector('#cam-cursor');\n\n      var ctx = this.ctx = this.canvas.getContext('2d');\n      ctx.fillStyle = 'rgb(0, 0, 0)';\n      ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);  \n      this.dataProcessed=false;\n      fetch(this.data.url)\n        .then(resp=>{return resp.json()})\n        .then(json=>{this.processData(json)})\n        .catch(err=>{console.log(err)})\n    },\n    processData: function(dataToProcess){\n        this.data = [];\n        dataToProcess.list.forEach(day=>{\n          //console.log(day.dt_txt , this.k2f(day.main.temp_max)+'F');\n          this.data.push({dt:day.dt_txt,temp_max:this.k2f(day.main.temp_max)});\n        });\n        this.dataProcessed=true;\n    },\n    k2f: function(k){\n      return Math.round((k - 273.15) * 9/5 + 32);\n    },\n    tick: function(t,dt){\n      if(!this.dataProcessed)return;\n      this.visualizeData(t);\n      this.updateCanvas(); \n    },\n    visualizeData: function(t){\n      let canvas = this.canvas;\n      let dt_width = canvas.width/this.data.length;\n      let ctx = this.ctx;\n      if(this.cursor.getAttribute('material').color=='green')t=1000;\n      this.data.forEach((d,i)=>{\n        let hue = t*(d.temp_max / 900);\n        ctx.fillStyle = 'hsl(' + hue + ', 50%, 30%)';\n        ctx.fillRect(i*dt_width, 0, dt_width, canvas.height);\n      });\n      \n      \n      \n    \n    },\n    drawRectangles: function(t){\n      var canvas = this.canvas;\n      var ctx = this.ctx;\n      var x;\n      var y;\n      var hue = t / 10;\n      ctx.fillStyle = 'hsl(' + hue + ', 50%, 80%)';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      hue = t / 15;\n      ctx.fillStyle = 'hsl(' + hue + ', 50%, 60%)';\n      x = canvas.width / 10;\n      y = canvas.height / 10;\n      ctx.fillRect(x, y, canvas.width - x * 2, canvas.height - y * 2);\n      hue = t / 20;\n      ctx.fillStyle = 'hsl(' + hue + ', 50%, 40%)';\n      x = canvas.width / 5;\n      y = canvas.height / 5;\n      ctx.fillRect(x, y, canvas.width - x * 2, canvas.height - y * 2);\n    },\n    updateCanvas: function(){\n      var el = this.el;\n      var material;\n      material = el.getObject3D('mesh').material;\n        if (!material.map) {\n            return;\n      }\n      material.map.needsUpdate = true;   \n    }\n    \n  });\n  \n})()","var shaders = {};\nimport Polkadot_Shader from './shaders/Polkadot_Shader.json';\nshaders['Polkadot_Shader']=Polkadot_Shader;\nimport Sun_Shader from './shaders/Sun_Shader.json';\nshaders['Sun_Shader']=Sun_Shader;\nimport Jelly_Shader from './shaders/Jelly_Shader.json';\nshaders['Jelly_Shader']=Jelly_Shader;\nimport Green_Dance_Shader from './shaders/Green_Dance_Shader.json';\nshaders['Green_Dance_Shader']=Green_Dance_Shader;\nimport Cosmic_Shader from './shaders/Cosmic_Shader.json';\nshaders['Cosmic_Shader']=Cosmic_Shader;\nimport Cool_Tiles_Shader from './shaders/Cool_Tiles_Shader.json';\nshaders['Cool_Tiles_Shader']=Cool_Tiles_Shader;\nimport Disco_Shader from './shaders/Disco_Shader.json';\nshaders['Disco_Shader']=Disco_Shader;\nimport Marching_Ants_Shader from './shaders/Marching_Ants_Shader.json';\nshaders['Marching_Ants_Shader']=Marching_Ants_Shader;\nimport Goo_Shader from './shaders/Goo_Shader.json';\nshaders['Goo_Shader']=Goo_Shader;\nimport Psycho_Shader from './shaders/Psycho_Shader.json';\nshaders['Psycho_Shader']=Psycho_Shader;\nimport Ova_Shader from './shaders/Ova_Shader.json';\nshaders['Ova_Shader']=Ova_Shader;\nimport Thruster_Shader from './shaders/Thruster_Shader.json';\nshaders['Thruster_Shader']=Thruster_Shader;\nimport Flowing_Circles_Shader from './shaders/Flowing_Circles_Shader.json';\nshaders['Flowing_Circles_Shader']=Flowing_Circles_Shader;\nimport Electric_Shader from './shaders/Electric_Shader.json';\nshaders['Electric_Shader']=Electric_Shader;\nimport CS1_Shader from './shaders/CS1_Shader.json';\nshaders['CS1_Shader']=CS1_Shader;\n\nexport default CS1=>{\n  \nCS1.shaderfrog = shaders;\n\nvar defaultThreeUniforms = [\n    'normalMatrix', 'viewMatrix', 'projectionMatrix', 'position', 'normal',\n    'modelViewMatrix', 'uv', 'uv2', 'modelMatrix'\n];\n\nfunction ShaderRuntime() {}\n\nShaderRuntime.prototype = {\n\n    mainCamera: null,\n    cubeCameras: {},\n\n    reserved: { time: null, cameraPosition: null },\n\n    umap: {\n        float: { type: 'f', value: 0 },\n        int: { type: 'i', value: 0 },\n        vec2: { type: 'v2', value() { return new THREE.Vector2(); } },\n        vec3: { type: 'v3', value() { return new THREE.Vector3(); } },\n        vec4: { type: 'v4', value() { return new THREE.Vector4(); } },\n        samplerCube: { type: 't' },\n        sampler2D: { type: 't' }\n    },\n\n    getUmap( type ) {\n        let value = this.umap[ type ].value;\n        return typeof value === 'function' ? value() : value;\n    },\n\n    registerCamera( camera ) {\n\n        if( !( camera instanceof THREE.Camera ) ) {\n            throw new Error( 'Cannot register a non-camera as a camera!' );\n        }\n\n        this.mainCamera = camera;\n\n    },\n\n    registerCubeCamera( name, camera ) {\n\n        if( !camera.renderTarget ) {\n            throw new Error( 'Cannot register a non-camera as a camera!' );\n        }\n\n        this.cubeCameras[ name ] = camera;\n\n    },\n\n    unregisterCamera( name ) {\n\n        if( name in this.cubeCameras ) {\n\n            delete this.cubeCameras[ name ];\n            \n        } else if( name === this.mainCamera ) {\n\n            delete this.mainCamera;\n\n        } else {\n\n            throw new Error( 'You never registered camera ' + name );\n\n        }\n\n    },\n\n    updateSource( identifier, config, findBy ) {\n\n        findBy = findBy || 'name';\n\n        if( !this.shaderTypes[ identifier ] ) {\n            throw new Error( 'Runtime Error: Cannot update shader ' + identifier + ' because it has not been added.' );\n        }\n\n        let newShaderData = this.add( identifier, config ),\n            shader, x;\n\n        for( x = 0; shader = this.runningShaders[ x++ ]; ) {\n            if( shader[ findBy ] === identifier ) {\n                extend( shader.material, omit( newShaderData, 'id' ) );\n                shader.material.needsUpdate = true;\n            }\n        }\n\n    },\n\n    renameShader( oldName, newName ) {\n\n        let x, shader;\n\n        if( !( oldName in this.shaderTypes ) ) {\n            throw new Error('Could not rename shader ' + oldName + ' to ' + newName + '. It does not exist.');\n        }\n\n        this.shaderTypes[ newName ] = this.shaderTypes[ oldName ];\n        delete this.shaderTypes[ oldName ];\n\n        for( x = 0; shader = this.runningShaders[ x++ ]; ) {\n            if( shader.name === oldName ) {\n                shader.name = newName;\n            }\n        }\n\n    },\n\n    get( identifier ) {\n\n        let shaderType = this.shaderTypes[ identifier ];\n\n        if( !shaderType.initted ) {\n\n            this.create( identifier );\n        }\n\n        return shaderType.material;\n\n    },\n\n    add( shaderName, config ) {\n\n        let newData = clone( config ),\n            uniform;\n        newData.fragmentShader = config.fragment;\n        newData.vertexShader = config.vertex;\n        delete newData.fragment;\n        delete newData.vertex;\n\n        for( var uniformName in newData.uniforms ) {\n            uniform = newData.uniforms[ uniformName ];\n            if( uniform.value === null ) {\n                newData.uniforms[ uniformName ].value = this.getUmap( uniform.glslType );\n            }\n        }\n        \n        if( shaderName in this.shaderTypes ) {\n            // maybe not needed? too sleepy, need document\n            extend( this.shaderTypes[ shaderName ], newData );\n        } else {\n            this.shaderTypes[ shaderName ] = newData;\n        }\n\n        return newData;\n\n    },\n\n    create( identifier ) {\n\n        let shaderType = this.shaderTypes[ identifier ];\n      \n        delete shaderType.id;\n\n        shaderType.material = new THREE.RawShaderMaterial( shaderType );\n\n        this.runningShaders.push( shaderType );\n\n        shaderType.init && shaderType.init( shaderType.material );\n        shaderType.material.needsUpdate = true;\n\n        shaderType.initted = true;\n\n        return shaderType.material;\n\n    },\n\n    updateRuntime( identifier, data, findBy ) {\n\n        findBy = findBy || 'name';\n\n        let shader, x, uniformName, uniform;\n\n        // This loop does not appear to be a slowdown culprit\n        for( x = 0; shader = this.runningShaders[ x++ ]; ) {\n            if( shader[ findBy ] === identifier ) {\n                for( uniformName in data.uniforms ) {\n\n                    if( uniformName in this.reserved ) {\n                        continue;\n                    }\n\n                    if( uniformName in shader.material.uniforms ) {\n\n                        uniform = data.uniforms[ uniformName ];\n\n                        // this is nasty, since the shader serializes\n                        // CubeCamera model to string. Maybe not update it at\n                        // all?\n                        if( uniform.type === 't' && typeof uniform.value === 'string' ) {\n                            uniform.value = this.cubeCameras[ uniform.value ].renderTarget;\n                        }\n\n                        shader.material.uniforms[ uniformName ].value = data.uniforms[ uniformName ].value;\n                    }\n                }\n            }\n        }\n\n    },\n\n    // Update global shader uniform values\n    updateShaders( time, obj ) {\n\n        let shader, x;\n\n        obj = obj || {};\n\n        for( x = 0; shader = this.runningShaders[ x++ ]; ) {\n\n            for( let uniform in obj.uniforms ) {\n                if( uniform in shader.material.uniforms ) {\n                    shader.material.uniforms[ uniform ].value = obj.uniforms[ uniform ];\n                }\n            }\n\n            if( 'cameraPosition' in shader.material.uniforms && this.mainCamera ) {\n\n                shader.material.uniforms.cameraPosition.value = this.mainCamera.position.clone();\n\n            }\n\n            if( 'viewMatrix' in shader.material.uniforms && this.mainCamera ) {\n\n                shader.material.uniforms.viewMatrix.value = this.mainCamera.matrixWorldInverse;\n\n            }\n\n            if( 'time' in shader.material.uniforms ) {\n\n                shader.material.uniforms.time.value = time;\n\n            }\n\n        }\n\n    },\n\n    shaderTypes: shaders,\n\n    runningShaders: []\n\n};\n\n// Convenience methods so we don't have to include underscore\nfunction extend() {\n    let length = arguments.length,\n        obj = arguments[ 0 ];\n\n    if( length < 2 ) {\n        return obj;\n    }\n\n    for( let index = 1; index < length; index++ ) {\n        let source = arguments[ index ],\n            keys = Object.keys( source || {} ),\n            l = keys.length;\n        for( let i = 0; i < l; i++ ) {\n            let key = keys[i];\n            obj[ key ] = source[ key ];\n        }\n    }\n\n    return obj;\n}\n\nfunction clone( obj ) {\n    return extend( {}, obj );\n}\n\nfunction omit( obj, ...keys ) {\n    let cloned = clone( obj ), x, key;\n    for( x = 0; key = keys[ x++ ]; ) {\n        delete cloned[ key ];\n    }\n    return cloned;\n}\n  \nAFRAME.registerSystem('shader-frog', {\n  init:function(){\n    this.frog_runtime = new ShaderRuntime();\n    this.clock = new THREE.Clock();\n    var self = this;\n        \n    var scene = document.querySelector('a-scene');\n    if (scene.hasLoaded) {\n      registerCamera().bind(this);;\n    } else {\n      scene.addEventListener('loaded', registerCamera);\n    }\n    function registerCamera () {\n       var camera = document.querySelector(\"a-scene\").systems[\"camera\"];\n       if(camera && camera.sceneEl && camera.sceneEl.camera){\n         camera = camera.sceneEl.camera;\n         self.frog_runtime.registerCamera(camera);\n       }\n    }\n  },\n  tick: function (t) {\n    this.frog_runtime.updateShaders( this.clock.getElapsedTime() );\n  }\n});\nAFRAME.registerComponent('shader-frog',{\n  schema:{\n    name:{type:\"string\"}\n  },\n  init: function(){\n    this.originalMaterial = this.el.getObject3D('mesh').material;\n    this.shaderData = shaders[this.data.name];\n  },\n  update: function(){\n    this.system.frog_runtime.add(this.data.name,this.shaderData);\n    var material = this.system.frog_runtime.get(this.data.name);\n    this.el.getObject3D('mesh').material = material;\n  },\n  remove: function(){\n    this.el.getObject3D('mesh').material = this.originalMaterial;\n  }\n});\n  \n}\n","export default (function particlePlayer(){\n\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.BufferGeometryUtils = {\n\n\tcomputeTangents: function ( geometry ) {\n\n\t\tvar index = geometry.index;\n\t\tvar attributes = geometry.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar indices = index.array;\n\t\tvar positions = attributes.position.array;\n\t\tvar normals = attributes.normal.array;\n\t\tvar uvs = attributes.uv.array;\n\n\t\tvar nVertices = positions.length / 3;\n\n\t\tif ( attributes.tangent === undefined ) {\n\n\t\t\tgeometry.addAttribute( 'tangent', new THREE.BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\n\n\t\t}\n\n\t\tvar tangents = attributes.tangent.array;\n\n\t\tvar tan1 = [], tan2 = [];\n\n\t\tfor ( var i = 0; i < nVertices; i ++ ) {\n\n\t\t\ttan1[ i ] = new THREE.Vector3();\n\t\t\ttan2[ i ] = new THREE.Vector3();\n\n\t\t}\n\n\t\tvar vA = new THREE.Vector3(),\n\t\t\tvB = new THREE.Vector3(),\n\t\t\tvC = new THREE.Vector3(),\n\n\t\t\tuvA = new THREE.Vector2(),\n\t\t\tuvB = new THREE.Vector2(),\n\t\t\tuvC = new THREE.Vector2(),\n\n\t\t\tsdir = new THREE.Vector3(),\n\t\t\ttdir = new THREE.Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromArray( positions, a * 3 );\n\t\t\tvB.fromArray( positions, b * 3 );\n\t\t\tvC.fromArray( positions, c * 3 );\n\n\t\t\tuvA.fromArray( uvs, a * 2 );\n\t\t\tuvB.fromArray( uvs, b * 2 );\n\t\t\tuvC.fromArray( uvs, c * 2 );\n\n\t\t\tvar x1 = vB.x - vA.x;\n\t\t\tvar x2 = vC.x - vA.x;\n\n\t\t\tvar y1 = vB.y - vA.y;\n\t\t\tvar y2 = vC.y - vA.y;\n\n\t\t\tvar z1 = vB.z - vA.z;\n\t\t\tvar z2 = vC.z - vA.z;\n\n\t\t\tvar s1 = uvB.x - uvA.x;\n\t\t\tvar s2 = uvC.x - uvA.x;\n\n\t\t\tvar t1 = uvB.y - uvA.y;\n\t\t\tvar t2 = uvC.y - uvA.y;\n\n\t\t\tvar r = 1.0 / ( s1 * t2 - s2 * t1 );\n\n\t\t\tsdir.set(\n\t\t\t\t( t2 * x1 - t1 * x2 ) * r,\n\t\t\t\t( t2 * y1 - t1 * y2 ) * r,\n\t\t\t\t( t2 * z1 - t1 * z2 ) * r\n\t\t\t);\n\n\t\t\ttdir.set(\n\t\t\t\t( s1 * x2 - s2 * x1 ) * r,\n\t\t\t\t( s1 * y2 - s2 * y1 ) * r,\n\t\t\t\t( s1 * z2 - s2 * z1 ) * r\n\t\t\t);\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tvar groups = geometry.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: indices.length\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( var i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tvar group = groups[ i ];\n\n\t\t\tvar start = group.start;\n\t\t\tvar count = group.count;\n\n\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindices[ j + 0 ],\n\t\t\t\t\tindices[ j + 1 ],\n\t\t\t\t\tindices[ j + 2 ]\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar tmp = new THREE.Vector3(), tmp2 = new THREE.Vector3();\n\t\tvar n = new THREE.Vector3(), n2 = new THREE.Vector3();\n\t\tvar w, t, test;\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromArray( normals, v * 3 );\n\t\t\tn2.copy( n );\n\n\t\t\tt = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\ttest = tmp2.dot( tan2[ v ] );\n\t\t\tw = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangents[ v * 4 ] = tmp.x;\n\t\t\ttangents[ v * 4 + 1 ] = tmp.y;\n\t\t\ttangents[ v * 4 + 2 ] = tmp.z;\n\t\t\ttangents[ v * 4 + 3 ] = w;\n\n\t\t}\n\n\t\tfor ( var i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tvar group = groups[ i ];\n\n\t\t\tvar start = group.start;\n\t\t\tvar count = group.count;\n\n\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( indices[ j + 0 ] );\n\t\t\t\thandleVertex( indices[ j + 1 ] );\n\t\t\t\thandleVertex( indices[ j + 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\t/**\n\t * @param  {Array<THREE.BufferGeometry>} geometries\n\t * @return {THREE.BufferGeometry}\n\t */\n\tmergeBufferGeometries: function ( geometries, useGroups ) {\n\n\t\tvar isIndexed = geometries[ 0 ].index !== null;\n\n\t\tvar attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\t\tvar morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\t\tvar attributes = {};\n\t\tvar morphAttributes = {};\n\n\t\tvar mergedGeometry = new THREE.BufferGeometry();\n\n\t\tvar offset = 0;\n\n\t\tfor ( var i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tvar geometry = geometries[ i ];\n\n\t\t\t// ensure that all geometries are indexed, or none\n\n\t\t\tif ( isIndexed !== ( geometry.index !== null ) ) return null;\n\n\t\t\t// gather attributes, exit early if they're different\n\n\t\t\tfor ( var name in geometry.attributes ) {\n\n\t\t\t\tif ( ! attributesUsed.has( name ) ) return null;\n\n\t\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\t}\n\n\t\t\t// gather morph attributes, exit early if they're different\n\n\t\t\tfor ( var name in geometry.morphAttributes ) {\n\n\t\t\t\tif ( ! morphAttributesUsed.has( name ) ) return null;\n\n\t\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t\t}\n\n\t\t\t// gather .userData\n\n\t\t\tmergedGeometry.userData = mergedGeometry.userData || {};\n\t\t\tmergedGeometry.userData.mergedUserData = mergedGeometry.userData.mergedUserData || [];\n\t\t\tmergedGeometry.userData.mergedUserData.push( geometry.userData );\n\n\t\t\tif ( useGroups ) {\n\n\t\t\t\tvar count;\n\n\t\t\t\tif ( isIndexed ) {\n\n\t\t\t\t\tcount = geometry.index.count;\n\n\t\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\t\toffset += count;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// merge indices\n\n\t\tif ( isIndexed ) {\n\n\t\t\tvar indexOffset = 0;\n\t\t\tvar mergedIndex = [];\n\n\t\t\tfor ( var i = 0; i < geometries.length; ++ i ) {\n\n\t\t\t\tvar index = geometries[ i ].index;\n\n\t\t\t\tfor ( var j = 0; j < index.count; ++ j ) {\n\n\t\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t\t}\n\n\t\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t\t}\n\n\t\t// merge attributes\n\n\t\tfor ( var name in attributes ) {\n\n\t\t\tvar mergedAttribute = this.mergeBufferAttributes( attributes[ name ] );\n\n\t\t\tif ( ! mergedAttribute ) return null;\n\n\t\t\tmergedGeometry.addAttribute( name, mergedAttribute );\n\n\t\t}\n\n\t\t// merge morph attributes\n\n\t\tfor ( var name in morphAttributes ) {\n\n\t\t\tvar numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\t\tif ( numMorphTargets === 0 ) break;\n\n\t\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\t\tfor ( var i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\t\tvar morphAttributesToMerge = [];\n\n\t\t\t\tfor ( var j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tvar mergedMorphAttribute = this.mergeBufferAttributes( morphAttributesToMerge );\n\n\t\t\t\tif ( ! mergedMorphAttribute ) return null;\n\n\t\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn mergedGeometry;\n\n\t},\n\n\t/**\n\t * @param {Array<THREE.BufferAttribute>} attributes\n\t * @return {THREE.BufferAttribute}\n\t */\n\tmergeBufferAttributes: function ( attributes ) {\n\n\t\tvar TypedArray;\n\t\tvar itemSize;\n\t\tvar normalized;\n\t\tvar arrayLength = 0;\n\n\t\tfor ( var i = 0; i < attributes.length; ++ i ) {\n\n\t\t\tvar attribute = attributes[ i ];\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) return null;\n\n\t\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\t\tif ( TypedArray !== attribute.array.constructor ) return null;\n\n\t\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\t\tif ( itemSize !== attribute.itemSize ) return null;\n\n\t\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\t\tif ( normalized !== attribute.normalized ) return null;\n\n\t\t\tarrayLength += attribute.array.length;\n\n\t\t}\n\n\t\tvar array = new TypedArray( arrayLength );\n\t\tvar offset = 0;\n\n\t\tfor ( var i = 0; i < attributes.length; ++ i ) {\n\n\t\t\tarray.set( attributes[ i ].array, offset );\n\n\t\t\toffset += attributes[ i ].array.length;\n\n\t\t}\n\n\t\treturn new THREE.BufferAttribute( array, itemSize, normalized );\n\n\t}\n\n};\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* global AFRAME */\n\n__webpack_require__(0);\n\nif (typeof AFRAME === 'undefined') {\n  throw new Error(\n    'Component attempted to register before AFRAME was available.'\n  );\n}\n\nconst NUM_PLANE_POSITIONS = 12;\n\nconst BLENDINGS = {\n  normal: THREE.NormalBlending,\n  additive: THREE.AdditiveBlending,\n  substractive: THREE.SubstractiveBlending,\n  multiply: THREE.MultiplyBlending\n};\n\nconst SHADERS = {\n  flat: THREE.MeshBasicMaterial,\n  lambert: THREE.MeshLambertMaterial,\n  phong: THREE.MeshPhongMaterial,\n  standard: THREE.MeshStandardMaterial\n};\n\nconst OFFSCREEN_VEC3 = new THREE.Vector3(-99999, -99999, -99999);\n\n/**\n * Particle Player component for A-Frame.\n */\nAFRAME.registerComponent('particleplayer', {\n  schema: {\n    blending: {\n      default: 'additive',\n      oneOf: ['normal', 'additive', 'multiply', 'substractive']\n    },\n    color: {default: '#fff', type: 'color'},\n    count: {default: '100%'},\n    delay: {default: 0, type: 'int'},\n    dur: {default: 1000, type: 'int'},\n    img: {type: 'selector'},\n    interpolate: {default: false},\n    loop: {default: 'false'},\n    on: {default: 'play'},//init\n    poolSize: {default: 5, type: 'int'}, // number of simultaneous particle systems\n    protation: {type: 'vec3'},\n    pscale: {default: 1.0, type: 'float'},\n    scale: {default: 1.0, type: 'float'},\n    shader: {\n      default: 'flat',\n      oneOf: ['flat', 'lambert', 'phong', 'standard']\n    },\n    src: {type: 'string',default:'energy'}\n  },\n\n  multiple: true,\n\n  init: function() {\n    this.frame = 0;\n    this.framedata = null;\n    this.indexPool = null;\n    this.lastFrame = 0;\n    this.material = null;\n    this.msPerFrame = 0;\n    this.numFrames = 0;\n    this.numParticles = 0; // total number of particles per system\n    this.originalVertexPositions = [];\n    this.particleCount = 0; // actual number of particles to spawn per event (data.count)\n    this.particleSystems = [];\n    this.protation = false;\n    this.restPositions = []; // position at first frame each particle is alive\n    this.restRotations = [];\n    this.sprite_rotation = false;\n    this.systems = null;\n    this.useRotation = false;\n    this.src = CS1.particles[this.data.src];\n  },\n\n  update: function(oldData) {\n    const data = this.data;\n    \n    if (!data.src) {\n      return;\n    }\n\n    if (oldData.on !== data.on) {\n      if (oldData.on) {\n        this.el.removeEventListener(oldData.on, this.start);\n      }\n      if (data.on !== 'play') {\n        this.el.addEventListener(data.on, this.start.bind(this));\n      }\n    }\n\n    this.loadParticlesJSON(this.src, data.scale);\n\n    this.numFrames = this.framedata.length;\n    this.numParticles = this.numFrames > 0 ? this.framedata[0].length : 0;\n\n    if (data.count[data.count.length - 1] === '%') {\n      this.particleCount = Math.floor(\n        (parseInt(data.count) * this.numParticles) / 100.0\n      );\n    } else {\n      this.particleCount = parseInt(data.count);\n    }\n    this.particleCount = Math.min(\n      this.numParticles,\n      Math.max(0, this.particleCount)\n    );\n\n    this.msPerFrame = data.dur / this.numFrames;\n\n    this.indexPool = new Array(this.numParticles);\n\n    const materialParams = {\n      color: new THREE.Color(data.color),\n      side: THREE.DoubleSide,\n      blending: BLENDINGS[data.blending],\n      map: data.img ? new THREE.TextureLoader().load(data.img.src) : null,\n      depthWrite: false,\n      opacity: data.opacity,\n      transparent: !!data.img || data.blending !== 'normal' || data.opacity < 1\n    };\n    if (SHADERS[data.shader] !== undefined) {\n      this.material = new SHADERS[data.shader](materialParams);\n    } else {\n      this.material = new SHADERS['flat'](materialParams);\n    }\n\n    this.createParticles(data.poolSize);\n\n    if (data.on === 'init') {\n      this.start();\n    }\n  },\n\n  loadParticlesJSON: function(json, scale) {\n    var alive;\n\n    this.restPositions.length = 0;\n    this.restRotations.length = 0;\n\n    const jsonData = json;\n    const frames = jsonData.frames;\n    const precision = jsonData.precision;\n\n    this.useRotation = jsonData.rotation;\n\n    if (jsonData.sprite_rotation !== false) {\n      this.sprite_rotation = {\n        x: jsonData.sprite_rotation[0] / precision,\n        y: jsonData.sprite_rotation[1] / precision,\n        z: jsonData.sprite_rotation[2] / precision\n      };\n    } else {\n      this.sprite_rotation = false;\n    }\n\n    this.framedata = new Array(frames.length);\n    for (let frameIndex = 0; frameIndex < frames.length; frameIndex++) {\n      this.framedata[frameIndex] = new Array(frames[frameIndex].length);\n      for (\n        let particleIndex = 0;\n        particleIndex < frames[frameIndex].length;\n        particleIndex++\n      ) {\n        let rawP = frames[frameIndex][particleIndex]; // data of particle i in frame f\n        alive = rawP !== 0; // 0 means not alive yet this frame.\n\n        let p = (this.framedata[frameIndex][particleIndex] = {\n          position: alive\n            ? {\n                x: (rawP[0] / precision) * scale,\n                y: (rawP[1] / precision) * scale,\n                z: (rawP[2] / precision) * scale\n              }\n            : null,\n          alive: alive\n        });\n\n        if (jsonData.rotation) {\n          p.rotation = alive\n            ? {\n                x: rawP[3] / precision,\n                y: rawP[4] / precision,\n                z: rawP[5] / precision\n              }\n            : null;\n        }\n\n        if (alive && frameIndex === 0) {\n          this.restPositions[particleIndex] = p.position\n            ? {x: p.position.y, y: p.position.y, z: p.position.z}\n            : null;\n          this.restRotations[particleIndex] = p.rotation\n            ? {x: p.rotation.y, y: p.rotation.y, z: p.rotation.z}\n            : null;\n        }\n      }\n    }\n  },\n\n  createParticles: (function() {\n    const tempGeometries = [];\n\n    return function(numParticleSystems) {\n      const data = this.data;\n      var loop = parseInt(this.data.loop);\n\n      this.particleSystems.length = 0;\n\n      if (isNaN(loop)) {\n        loop = this.data.loop === 'true' ? Number.MAX_VALUE : 0;\n      }\n\n      for (let i = 0; i < numParticleSystems; i++) {\n        let particleSystem = {\n          active: false,\n          activeParticleIndices: new Array(this.particleCount),\n          loopCount: 0,\n          loopTotal: loop,\n          mesh: null,\n          time: 0\n        };\n\n        // Fill array of geometries to merge.\n        const ratio = data.img ? data.img.width / data.img.height : 1;\n        tempGeometries.length = 0;\n        for (let p = 0; p < this.numParticles; p++) {\n          let geometry = new THREE.PlaneBufferGeometry(\n            0.1 * ratio * data.pscale,\n            0.1 * data.pscale\n          );\n          if (this.sprite_rotation !== false) {\n            geometry.rotateX(this.sprite_rotation.x);\n            geometry.rotateY(this.sprite_rotation.y);\n            geometry.rotateZ(this.sprite_rotation.z);\n          } else {\n            geometry.rotateX((this.data.protation.x * Math.PI) / 180);\n            geometry.rotateY((this.data.protation.y * Math.PI) / 180);\n            geometry.rotateZ((this.data.protation.z * Math.PI) / 180);\n          }\n          tempGeometries.push(geometry);\n        }\n\n        // Create merged geometry for whole particle system.\n        let mergedBufferGeometry = THREE.BufferGeometryUtils.mergeBufferGeometries(\n          tempGeometries\n        );\n\n        particleSystem.mesh = new THREE.Mesh(\n          mergedBufferGeometry,\n          this.material\n        );\n        particleSystem.mesh.visible = false;\n        this.el.setObject3D(`particleplayer${i}`, particleSystem.mesh);\n        copyArray(\n          this.originalVertexPositions,\n          mergedBufferGeometry.attributes.position.array\n        );\n\n        // Hide all particles by default.\n        for (\n          let i = 0;\n          i < mergedBufferGeometry.attributes.position.array.length;\n          i++\n        ) {\n          mergedBufferGeometry.attributes.position.array[i] = -99999;\n        }\n\n        for (let i = 0; i < particleSystem.activeParticleIndices.length; i++) {\n          particleSystem.activeParticleIndices[i] = i;\n        };\n\n        this.particleSystems.push(particleSystem);\n      }\n    };\n  })(),\n\n  start: function(evt) {\n    if (this.data.delay > 0) {\n      setTimeout(() => this.startAfterDelay(evt), this.data.delay);\n    } else {\n      this.startAfterDelay(evt);\n    }\n  },\n\n  startAfterDelay: function(evt) {\n    // position, rotation\n    var found = -1;\n    var particleSystem;\n    var oldestTime = 0;\n    var position = evt ? evt.detail.position : null;\n    var rotation = evt ? evt.detail.rotation : null;\n\n    if (!(position instanceof THREE.Vector3)) {\n      position = new THREE.Vector3();\n    }\n    if (!(rotation instanceof THREE.Euler)) {\n      rotation = new THREE.Euler();\n    }\n\n    // find available (or oldest) particle system\n    for (var i = 0; i < this.particleSystems.length; i++) {\n      if (this.particleSystems[i].active === false) {\n        found = i;\n        break;\n      }\n      if (this.particleSystems[i].time > oldestTime) {\n        found = i;\n        oldestTime = this.particleSystems[i].time;\n      }\n    }\n\n    particleSystem = this.particleSystems[found];\n    particleSystem.active = true;\n    particleSystem.loopCount = 1;\n    particleSystem.mesh.visible = true;\n    particleSystem.mesh.position.copy(position);\n    particleSystem.mesh.rotation.copy(rotation);\n    particleSystem.time = 0;\n\n    this.resetParticles(particleSystem);\n  },\n\n  doLoop: function(particleSystem) {\n    particleSystem.loopCount++;\n    particleSystem.frame = -1;\n    particleSystem.time = 0;\n    this.resetParticles(particleSystem);\n  },\n\n  resetParticle: function(particleSystem, particleIndex) {\n    const geometry = particleSystem.mesh.geometry;\n\n    if (this.restPositions[particleIndex]) {\n      transformPlane(\n        particleIndex,\n        geometry,\n        this.originalVertexPositions,\n        this.restPositions[particleIndex],\n        this.useRotation && this.restRotations[particleIndex]\n      );\n    } else {\n      // Hide.\n      transformPlane(\n        particleIndex,\n        geometry,\n        this.originalVertexPositions,\n        OFFSCREEN_VEC3\n      );\n    }\n\n    // TODO: Can update transformPlane for lookAt.\n    // lookAt does not support rotated or translated parents! :_(\n    // part.lookAt(this.camera.position);\n  },\n\n  /**\n   * When starting or finishing (looping) animation, this resets particles\n   * to their initial position and, if user asked for replaying less than 100%\n   * of particles, randomly choose them.\n   */\n  resetParticles: function(particleSystem) {\n    var i;\n    var rand;\n\n    // no picking, just hide and reset\n    if (this.particleCount === this.numParticles) {\n      for (i = 0; i < this.numParticles; i++) {\n        this.resetParticle(particleSystem, i);\n      }\n      return;\n    }\n\n    // hide particles from last animation and initialize indexPool\n    const geometry = particleSystem.mesh.geometry;\n    for (i = 0; i < this.numParticles; i++) {\n      if (i < this.particleCount) {\n        transformPlane(\n          particleSystem.activeParticleIndices[i],\n          geometry,\n          this.originalVertexPositions,\n          OFFSCREEN_VEC3\n        );\n      }\n      this.indexPool[i] = i;\n    }\n\n    // scramble indexPool\n    for (i = 0; i < this.particleCount; i++) {\n      rand = i + Math.floor(Math.random() * (this.numParticles - i));\n      particleSystem.activeParticleIndices[i] = this.indexPool[rand];\n      this.indexPool[rand] = this.indexPool[i];\n      this.resetParticle(\n        particleSystem,\n        particleSystem.activeParticleIndices[i]\n      );\n    }\n  },\n\n  tick: (function() {\n    const helperPositionVec3 = new THREE.Vector3();\n\n    return function(time, delta) {\n      var frame; // current particle system frame\n      var fdata; // all particles data in current frame\n      var fdataNext; // next frame (for interpolation)\n      var useRotation = this.useRotation;\n      var frameTime; // time in current frame (for interpolation)\n      var relTime; // current particle system relative time (0-1)\n      var interpolate; // whether interpolate between frames or not\n\n      for (\n        let particleSystemIndex = 0;\n        particleSystemIndex < this.particleSystems.length;\n        particleSystemIndex++\n      ) {\n        let particleSystem = this.particleSystems[particleSystemIndex];\n        if (!particleSystem.active) {\n          continue;\n        }\n\n        // if the duration is so short that there's no need to interpolate, don't do it\n        // even if user asked for it.\n        interpolate =\n          this.data.interpolate && this.data.dur / this.numFrames > delta;\n        relTime = particleSystem.time / this.data.dur;\n        frame = relTime * this.numFrames;\n        fdata = this.framedata[Math.floor(frame)];\n        if (interpolate) {\n          frameTime = frame - Math.floor(frame);\n          fdataNext =\n            frame < this.numFrames - 1\n              ? this.framedata[Math.floor(frame) + 1]\n              : null;\n        }\n\n        for (\n          let activeParticleIndex = 0;\n          activeParticleIndex < particleSystem.activeParticleIndices.length;\n          activeParticleIndex++\n        ) {\n\n          let particleIndex =\n            particleSystem.activeParticleIndices[activeParticleIndex];\n          let rotation = useRotation && fdata[particleIndex].rotation;\n\n          // TODO: Add vertex position to original position to all vertices of plane...\n          if (!fdata[particleIndex].alive) {\n            // Hide plane off-screen when not alive.\n            transformPlane(\n              particleIndex,\n              particleSystem.mesh.geometry,\n              this.originalVertexPositions,\n              OFFSCREEN_VEC3\n            );\n            continue;\n          }\n\n          if (interpolate && fdataNext && fdataNext[particleIndex].alive) {\n            helperPositionVec3.lerpVectors(\n              fdata[particleIndex].position,\n              fdataNext[particleIndex].position,\n              frameTime\n            );\n            transformPlane(\n              particleIndex,\n              particleSystem.mesh.geometry,\n              this.originalVertexPositions,\n              helperPositionVec3,\n              rotation\n            );\n          } else {\n            transformPlane(\n              particleIndex,\n              particleSystem.mesh.geometry,\n              this.originalVertexPositions,\n              fdata[particleIndex].position,\n              rotation\n            );\n          }\n        }\n\n        particleSystem.time += delta;\n        if (particleSystem.time >= this.data.dur) {\n          if (particleSystem.loopCount < particleSystem.loopTotal) {\n            this.el.emit('particleplayerloop', null, false);\n            this.doLoop(particleSystem);\n          } else {\n            this.el.emit('particleplayerfinished', null, false);\n            particleSystem.active = false;\n            particleSystem.mesh.visible = false;\n          }\n          continue;\n        }\n      }\n    };\n  })(),\n\n  _transformPlane: transformPlane\n});\n\n// Use triangle geometry as a helper for rotating.\nconst tri = (function() {\n  const tri = new THREE.Geometry();\n  tri.vertices.push(new THREE.Vector3());\n  tri.vertices.push(new THREE.Vector3());\n  tri.vertices.push(new THREE.Vector3());\n  tri.faces.push(new THREE.Face3(0, 1, 2));\n  return tri;\n})();\n\n/**\n * Faces of a plane are v0, v2, v1 and v2, v3, v1.\n * Positions are 12 numbers: [v0, v1, v2, v3].\n */\nfunction transformPlane(\n  particleIndex,\n  geometry,\n  originalArray,\n  position,\n  rotation\n) {\n  const array = geometry.attributes.position.array;\n  const index = particleIndex * NUM_PLANE_POSITIONS;\n\n  // Calculate first face (0, 2, 1).\n  tri.vertices[0].set(\n    originalArray[index + 0],\n    originalArray[index + 1],\n    originalArray[index + 2]\n  );\n  tri.vertices[1].set(\n    originalArray[index + 3],\n    originalArray[index + 4],\n    originalArray[index + 5]\n  );\n  tri.vertices[2].set(\n    originalArray[index + 6],\n    originalArray[index + 7],\n    originalArray[index + 8]\n  );\n  if (rotation) {\n    tri.rotateX(rotation.x);\n    tri.rotateY(rotation.y);\n    tri.rotateZ(rotation.z);\n  }\n  tri.vertices[0].add(position);\n  tri.vertices[1].add(position);\n  tri.vertices[2].add(position);\n  array[index + 0] = tri.vertices[0].x;\n  array[index + 1] = tri.vertices[0].y;\n  array[index + 2] = tri.vertices[0].z;\n  array[index + 3] = tri.vertices[1].x;\n  array[index + 4] = tri.vertices[1].y;\n  array[index + 5] = tri.vertices[1].z;\n  array[index + 6] = tri.vertices[2].x;\n  array[index + 7] = tri.vertices[2].y;\n  array[index + 8] = tri.vertices[2].z;\n\n  // Calculate second face (2, 3, 1) just for the last vertex.\n  tri.vertices[0].set(\n    originalArray[index + 3],\n    originalArray[index + 4],\n    originalArray[index + 5]\n  );\n  tri.vertices[1].set(\n    originalArray[index + 6],\n    originalArray[index + 7],\n    originalArray[index + 8]\n  );\n  tri.vertices[2].set(\n    originalArray[index + 9],\n    originalArray[index + 10],\n    originalArray[index + 11]\n  );\n  if (rotation) {\n    tri.rotateX(rotation.x);\n    tri.rotateY(rotation.y);\n    tri.rotateZ(rotation.z);\n  }\n  tri.vertices[0].add(position);\n  tri.vertices[1].add(position);\n  tri.vertices[2].add(position);\n  array[index + 9] = tri.vertices[2].x;\n  array[index + 10] = tri.vertices[2].y;\n  array[index + 11] = tri.vertices[2].z;\n\n  geometry.attributes.position.needsUpdate = true;\n}\nmodule.exports.transformPlane = transformPlane;\n\nfunction copyArray(dest, src) {\n  dest.length = 0;\n  for (let i = 0; i < src.length; i++) {\n    dest[i] = src[i];\n  }\n}\n\n\n/***/ })\n/******/ ]);\n  \n  \n})()","import particlePlayer from './particle-player';\n\nimport Particles_Dust from './particles/Particles_Dust.json';\n\nimport Particles_Energy from './particles/Particles_Energy.json';\n\nimport Particles_Orb from './particles/Particles_Orb.json';\n\n\nexport default CS1=>{\n  \n  CS1.particles={};\n  CS1.particles.dust = Particles_Dust;\n  CS1.particles.energy = Particles_Energy;\n  CS1.particles.orb = Particles_Orb;\n  \n  AFRAME.registerComponent('particles', {\n    schema: {\n      type: {type:'string',default:'magic'},\n      color: {type:'string',default:'#891010'},\n      scale: {type:'number',default:1},\n      loop: {type:'boolean',default:false}\n    },\n    init: function () {\n      \n      let pos = this.el.getAttribute('position');\n      \n      let posString = `${pos.x} ${pos.y} ${pos.z}`;\n      \n      this.e;\n  \n      if(this.data.type=='magic'){\n        this.e = document.createElement('a-entity');\n\n        this.e.setAttribute('position',posString);\n        this.e.setAttribute('scale','4 1.5 4');\n        this.p1 = document.createElement('a-entity');\n        this.p2 = document.createElement('a-entity');\n        this.p3 = document.createElement('a-entity');\n\n\n        this.p1.setAttribute('particleplayer',`src: orb; img: #star-tex; dur: 1000; count: 40%; scale: ${this.data.scale}; pscale: 9; interpolate: false; shader: standard; poolSize: 1; loop: ${this.data.loop}`);\n        this.p2.setAttribute('particleplayer',`color:${this.data.color}; src: energy; img:#energy-tex; dur: 1000; count: 100%; scale: ${this.data.scale}; pscale: 12; interpolate: false; shader: standard; poolSize: 1; loop: ${this.data.loop};`);\n        this.p3.setAttribute('particleplayer',`src: dust; img: #dust-tex; dur: 1000; count: 100%; scale: ${this.data.scale}; pscale: 1; interpolate: false; shader: standard; poolSize: 1; loop: ${this.data.loop}; color: #558`);\n\n        this.e.appendChild(this.p1);\n        this.e.appendChild(this.p2);\n        this.e.appendChild(this.p3);\n\n        document.querySelector('a-scene').appendChild(this.e);\n          \n      }\n    },\n    tick: function(t,dt){\n    \n    },\n    fire: function(){\n      let pos = this.el.getAttribute('position'); \n      let posString = `${pos.x} ${pos.y} ${pos.z}`;\n      this.e.setAttribute('position',posString);\n      this.p1.components.particleplayer.start();\n      this.p2.components.particleplayer.start();\n      this.p3.components.particleplayer.start();\n    }\n    \n  });\n  \n}","export default CS1=>{\n\n AFRAME.registerComponent('proximity-glitch', {\n   schema: {\n     threshold: {type: 'number', default: 2},\n     affects: {type: 'string', default: ''},\n     value:{type:'number',default:-0.1},\n     sound: {type: 'string',default:'https://cdn.glitch.com/6b222f93-e194-41e2-aaf6-59e5af64658d%2Fbuzz.mp3?1555284089077'},\n   },\n   init: function () {\n      this.sound = document.createElement('a-sound');\n      this.sound.setAttribute('src',`url(${this.data.sound})`);\n      this.el.appendChild(this.sound);\n      this.soundIsPlaying=false;\n      this.sound.addEventListener('sound-ended',e=>{\n        this.soundIsPlaying=false;     \n      });\n      this.scene=document.querySelector('a-scene');\n      this.scene.setAttribute('glitch','');\n      this.baseEffects=this.scene.getAttribute('effects');\n    },\n   tick: function (t,dt) {\n     if(CS1.game.playerDistanceTo(this.el)<this.data.threshold){  \n       this.scene.setAttribute('effects',`glitch,${this.baseEffects}`);\n       if(this.data.affects){\n         CS1.hud[this.data.affects].setValue(CS1.hud[this.data.affects].value+this.data.value);\n         if(!this.soundIsPlaying){\n           this.sound.components.sound.playSound();\n           this.soundIsPlaying = true;\n         }\n       }\n     }else{\n       this.scene.setAttribute('effects',this.baseEffects);\n     }\n   }\n  });\n\n}","\nconst defaults={\n  labelText: 'Label Text',\n  suffix: '',\n  labelColor: '#e23fcf',\n  gradientColor1: '#78F8EC',\n  gradientColor2: '#6E4AE2',\n  max: 100\n}\n\nconst RingDial = function(custom) {\n    this.opts = Object.assign({}, defaults, custom);\n    this.size = 2000/9;\n    this.strokeWidth = this.size / 8;\n    this.radius = (this.size / 2) - (this.strokeWidth / 2);\n    this.value = 0;\n    this.cachedValue = this.value;\n    this.targetValue = false;\n    this.isAnimating = false;\n    this.direction = 'up';\n    this.svg;\n    this.defs;\n    this.slice;\n    this.overlay;\n    this.text;\n    this.label;\n    this.arrow;\n    this.create(this.opts.labelColor,this.opts.gradientColor1,this.opts.gradientColor2);\n}\n\nRingDial.prototype.create = function(labelColor,gradientColor1,gradientColor2) {\n    this.createSvg();\n    this.createDefs(gradientColor1,gradientColor2);\n    this.createSlice();\n    this.createOverlay();\n    this.createText(gradientColor2);\n    //this.createArrow();\n    this.createLabel(labelColor);\n    this.opts.container.appendChild(this.svg);\n};\n\nRingDial.prototype.createSvg = function() {\n    var svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n    svg.setAttribute('width', this.size + 'px');\n    svg.setAttribute('height', this.size + 'px');\n    this.svg = svg;\n};\n\nRingDial.prototype.createDefs = function(gc1,gc2) {\n    var defs = document.createElementNS(\"http://www.w3.org/2000/svg\", \"defs\");\n    var linearGradient = document.createElementNS(\"http://www.w3.org/2000/svg\", \"linearGradient\");\n    linearGradient.setAttribute('id', 'gradient'+this.opts.labelText);\n    var stop1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"stop\");\n    stop1.setAttribute('stop-color', gc2);\n    stop1.setAttribute('offset', '0%');\n    linearGradient.appendChild(stop1);\n    var stop2 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"stop\");\n    stop2.setAttribute('stop-color', gc1);\n    stop2.setAttribute('offset', '100%');\n    linearGradient.appendChild(stop2);\n    var linearGradientBackground = document.createElementNS(\"http://www.w3.org/2000/svg\", \"linearGradient\");\n    linearGradientBackground.setAttribute('id', 'gradient-background');\n    var stop1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"stop\");\n    stop1.setAttribute('stop-color', 'rgba(0, 0, 0, 0.2)');\n    stop1.setAttribute('offset', '0%');\n    linearGradientBackground.appendChild(stop1);\n    var stop2 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"stop\");\n    stop2.setAttribute('stop-color', 'rgba(0, 0, 0, 0.05)');\n    stop2.setAttribute('offset', '100%');\n    linearGradientBackground.appendChild(stop2);\n    defs.appendChild(linearGradient);\n    defs.appendChild(linearGradientBackground);\n    this.svg.appendChild(defs);\n    this.defs = defs;\n};\n\nRingDial.prototype.createSlice = function() {\n    var slice = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n    slice.setAttribute('fill', 'none');\n    slice.setAttribute('stroke', `url(#gradient${this.opts.labelText})`);\n    slice.setAttribute('stroke-width', this.strokeWidth);\n    slice.setAttribute('transform', 'translate(' + this.strokeWidth / 2 + ',' + this.strokeWidth / 2 + ')');\n    slice.setAttribute('class', 'animate-draw');\n    this.svg.appendChild(slice);\n    this.slice = slice;\n};\n\nRingDial.prototype.createOverlay = function() {\n    var r = this.size - (this.size / 2) - this.strokeWidth / 2;\n    var circle = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\n    circle.setAttribute('cx', this.size / 2);\n    circle.setAttribute('cy', this.size / 2);\n    circle.setAttribute('r', r);\n    if(navigator.vendor.includes('Apple')){\n      circle.setAttribute('fill', 'rgba(0, 0, 0, 0.05)');\n    }else\n       circle.setAttribute('fill', 'url(#gradient-background)');\n    this.svg.appendChild(circle);\n    this.overlay = circle;\n};\n\nRingDial.prototype.createText = function(c) {\n    var fontSize = this.size / 3.5;\n    var text = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n    text.setAttribute('x', (this.size / 2) + fontSize / 7.5);\n    text.setAttribute('y', (this.size / 2) + fontSize / 4);\n    text.setAttribute('font-size', fontSize);\n    text.setAttribute('fill', c);\n    text.setAttribute('text-anchor', 'middle');\n    var tspanSize = fontSize / 3;\n    text.innerHTML = 0 + `<tspan font-size=${tspanSize} dy=${-tspanSize * 1.2}>${this.opts.suffix}</tspan>`;\n    this.svg.appendChild(text);\n    this.text = text;\n};\n\nRingDial.prototype.createLabel = function(c) {\n    let n=4.5;\n    if(this.opts.labelText.length>8)n=7\n    var fontSize = this.size / n;\n    var text = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n    text.setAttribute('x', this.size / 2);\n    text.setAttribute('y', (2*this.size / 3) + fontSize / (n-1));\n    text.setAttribute('font-family', 'Century Gothic, Lato');\n    text.setAttribute('font-size', fontSize);\n    text.setAttribute('fill', c);\n    text.setAttribute('text-anchor', 'middle');\n    var tspanSize = fontSize / 3;\n    text.innerHTML = this.opts.labelText;\n    this.svg.appendChild(text);\n    this.label = text;\n};\n\nRingDial.prototype.createArrow = function() {\n    var arrowSize = this.size / 10;\n    var arrowYOffset, m;\n    if(this.direction === 'up') {\n        arrowYOffset = arrowSize / 2;\n        m = -1;\n    }\n    else if(this.direction === 'down') {\n        arrowYOffset = 0;\n        m = 1;\n    }\n    var arrowPosX = ((this.size / 2) - arrowSize / 2);\n    var arrowPosY = (this.size - this.size / 3) + arrowYOffset;\n    var arrowDOffset =  m * (arrowSize / 1.5);\n    var arrow = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n    arrow.setAttribute('d', 'M 0 0 ' + arrowSize + ' 0 ' + arrowSize / 2 + ' ' + arrowDOffset + ' 0 0 Z');\n    arrow.setAttribute('fill', '#97F8F0');\n    arrow.setAttribute('opacity', '0.6');\n    arrow.setAttribute('transform', 'translate(' + arrowPosX + ',' + arrowPosY + ')');\n    this.svg.appendChild(arrow);\n    this.arrow = arrow;\n};\n\nRingDial.prototype.animateStart = function() {\n    var v = 0;\n    var self = this;\n    var intervalOne = setInterval(function() {\n        var p = +(v / self.value).toFixed(2);\n        var a = (p < 0.95) ? 2 - (2 * p) : 0.05;\n        v += a;\n        // Stop\n        if(v >= +self.value) {\n            v = self.value;\n            clearInterval(intervalOne);\n        }\n        self.setValue(v);\n    }, 10);\n};\n\nRingDial.prototype.animateTo = function(to,s=3,t=0.1) {\n    let m=this.opts.max;\n    s*=m/100;\n    t*=m/100;\n    if(to>m)to=m;\n    if(to<0)to=0;\n    var v = this.value;\n    var self = this;\n    this.isAnimating = true;\n    var intervalOne = setInterval(function() {\n        var p =  (v>to)? +(to /v).toFixed(2)  : +(v / to).toFixed(2);\n        var a = (p < 0.95) ? s - (s * p) : t;\n        if(to<v){\n          v -= a;\n            // Stop\n            if(v <= -to) {\n                self.value = to;\n                clearInterval(intervalOne);\n                self.cachedValue = self.value;\n                self.isAnimating = false;\n            }\n        }else {\n           v += a;\n            // Stop\n            if(v >= +to) {\n                self.value = to;\n                if(to>=self.opts.max){\n                  self.svg.currentScale=0\n                  setTimeout(e=>{\n                    self.setValue(self.opts.max);\n                    self.svg.currentScale=1;\n                  },100);\n                }\n                clearInterval(intervalOne);\n                self.cachedValue = self.value;\n                self.isAnimating = false;\n            }\n        }\n        self.setValue(v);\n    }, 10);\n};\n\nRingDial.prototype.changeBy = function(amt) {\n   this.targetValue = this.targetValue?this.targetValue+amt:this.value+amt;\n   this.animateTo(this.targetValue);\n};\n\nRingDial.prototype.animateReset = function() {\n    this.setValue(0);\n};\n\nRingDial.prototype.polarToCartesian = function(centerX, centerY, radius, angleInDegrees) {\n  var angleInRadians = (angleInDegrees-90) * Math.PI / 180.0;\n  return {\n    x: centerX + (radius * Math.cos(angleInRadians)),\n    y: centerY + (radius * Math.sin(angleInRadians))\n  };\n}\n\nRingDial.prototype.describeArc = function(x, y, radius, startAngle, endAngle){\n    var start = this.polarToCartesian(x, y, radius, endAngle);\n    var end = this.polarToCartesian(x, y, radius, startAngle);\n    var largeArcFlag = endAngle - startAngle <= 180 ? \"0\" : \"1\";\n    var d = [\n        \"M\", start.x, start.y, \n        \"A\", radius, radius, 0, largeArcFlag, 0, end.x, end.y\n    ].join(\" \");\n    return d;       \n}\n\nRingDial.prototype.setValue = function(value) {\t\n\t\tvar c = (value / this.opts.max) * 360;\n\t\tif(c === 360)\n\t\t\tc = 359.99;\n\t\tvar xy = this.size / 2 - this.strokeWidth / 2;\n\t\tvar d = this.describeArc(xy, xy, xy, 180, 180 + c);\n    this.slice.setAttribute('d', d);\n    var tspanSize = (this.size / 3.5) / 3;\n    this.text.innerHTML = Math.floor(value) + `<tspan font-size=${tspanSize} dy=${-tspanSize * 1.2}>${this.opts.suffix}</tspan>`;\n    this.value = value;\n};\n\nexport default RingDial;","export default class Meter{\n\n  constructor(container,labelText='label',color='white',value=0,min=0,max=1,low=0.25,high=0.75,optimum=0.8){\n    this.widget = document.createElement('div');\n    this.widget.style.fontSize = 2000/9/4.5 + 'px';\n    this.widget.style.marginTop = 2000/81 + 'px';\n    this.widget.style.marginBottom = 2000/81 + 'px';\n    this.widget.style.color = color;\n    this.value = 0;\n    this.min = parseFloat(min);\n    this.max = parseFloat(max);\n    this.range = max-min;\n    this.el = document.createElement('meter');\n    this.el.cachedValue = this.value;\n    this.el.targetValue = false;\n    this.el.isAnimating = false;\n    this.el.setAttribute('value',value);\n    this.el.setAttribute('min',min);\n    this.el.setAttribute('max',max);\n    this.el.setAttribute('low',low);\n    this.el.setAttribute('high',high);\n    this.el.setAttribute('optimum',optimum);\n    this.el.style.width = 1250/8 + 'px';\n    this.el.style.height = 1250/32 + 'px';\n    this.widget.appendChild(this.el);\n    this.label = document.createElement('div');\n    this.label.style.textAlign = 'center';\n    this.label.innerHTML = labelText;\n    this.widget.appendChild(this.label);\n    container.appendChild(this.widget);\n  }\n  \n  animateTo(to) {\n      var v = parseFloat(this.el.getAttribute('value'));\n      var self = this.el;\n      self.range = this.range;\n      self.isAnimating = true;\n      var intervalOne = setInterval(function() {\n          var p =  (v>to)? +(to /v).toFixed(4)  : +(v / to).toFixed(4);\n          var a = (p < 0.95) ? self.range/30 - (self.range/30 * p) : 0.003;\n          if(to<v){\n            \n            v -= a;\n              // Stop\n              if(v <= -to) {\n                  self.value = to\n                  if(to<=0)self.setValue(0);\n                  clearInterval(intervalOne);\n                  self.cachedValue = self.value;\n                  self.isAnimating = false;\n              }\n          }else {\n             v += a;\n              // Stop\n              if(v >= +to) {\n                  self.value = to;\n                  if(to>=100)self.setValue(100);\n                  clearInterval(intervalOne);\n                  self.cachedValue = self.value;\n                  self.isAnimating = false;\n              }\n          }\n          self.value = v;\n          this.value = v;\n      }, 10);\n  };\n  \n  changeBy(amt) {\n     this.el.targetValue = this.el.targetValue?this.el.targetValue+amt:this.el.cachedValue+amt;\n     this.animateTo(this.el.targetValue);\n  }\n  \n\n\n}","let config = {\n  regions:{\n    top:true,\n    left:false,\n    right:false,\n    bottom:false\n  }\n}\n\nimport RingDial from './elements/ring-dial';\nimport Meter from './elements/meter';\n\nexport default CS1=>{\n\n  window.addEventListener('load', function () {\n    CS1.stats = {};\n    let statsElement = document.createElement('div');\n    statsElement.id = 'vr-stats';\n    CS1.stats.container = statsElement;\n    if(!statsElement)return;\n    let containers = generateRegions(statsElement);\n    containers.top.style.pointerEvents='none';\n    CS1.stats.pointsDial = new RingDial({\n        container: containers.top,\n        labelText: 'points',\n        labelColor: '#ccc',\n        gradientColor1: 'white',\n        gradientColor2: 'red',\n        max: 1000                     \n    });\n    CS1.stats.energyDial = new RingDial({\n        container: containers.top,\n        labelText: 'energy',\n        labelColor: '#ccc',\n        gradientColor1: 'white',\n        gradientColor2: 'lime',\n        max: 1000\n    });\n    CS1.stats.energyDial.setValue(500);\n    CS1.stats.magicDial = new RingDial({\n        container: containers.top,\n        labelText: 'magic',\n        labelColor: '#ccc',\n        gradientColor1: 'white',\n        gradientColor2: '#b45ef9',\n        suffix: '%',\n        max: 100                     \n    });\n    CS1.stats.oxygenMeter = new Meter(containers.top,'oxygen','#ccc',1.0);\n  \n  function generateRegions(statsElement){\n   let containers = {};\n   if(config.regions.top){\n     let top = document.createElement('div');\n     top.id = 'stats-top';\n     top.style.position = 'relative';\n     top.style.left = '0px';\n     top.style.top = '0px';\n     top.style.width = 2000 + 'px';\n     top.style.height = 2000/4 + 'px';\n     containers.top = top;\n     statsElement.appendChild(top);\n   }\n   if(config.regions.left){\n   \n   }\n   if(config.regions.right){\n   \n   }\n   if(config.regions.bottom){\n     let bottom = document.createElement('div');\n     bottom.id = 'stats-bottom';\n     bottom.style.position = 'absolute';\n     bottom.style.left = '0px';\n     bottom.style.top = 900 - 2000/8 + 'px';\n     bottom.style.width = 2000 + 'px';\n     bottom.style.height = 2000/8 + 'px';\n     containers.bottom = bottom;\n     statsElement.appendChild(bottom);\n   }\n   return containers;\n  }\n  \n  })\n  \n}\n","import config from '../../../.data/client-config.json';\nexport default CS1=>{AFRAME.registerComponent('game', {\n  schema: {mode:{type: 'string',default:'standard'}},\n  init: function () {\n    \n    CS1.game = this;\n    this.isRunning = false;\n    \n    this.determineDevice();\n    \n    this.name = config.gameName;\n    this.announcements = {};\n    this.announcements['welcome'] = config.welcomeMsg;\n    this.welcomeDelay = config.voice.welcomeDelay;\n    \n    document.querySelector('#scene-container').style.display='block';\n    document.querySelector('#loading-screen').style.display='none';\n    \n        \n    CS1.voices = window.speechSynthesis.getVoices();\n    \n    CS1.say = function(msg,name=\"none given\") {\n      var msg = new SpeechSynthesisUtterance(msg);\n      if(name == \"none given\")\n        msg.voice = speechSynthesis.getVoices().filter(function(voice) { return voice.name == config.voice.name; })[0];\n      else\n        msg.voice = speechSynthesis.getVoices().filter(function(voice) { return voice.name == name; })[0];\n      msg.pitch = config.voice.pitch;\n      msg.rate = config.voice.rate;\n      msg.volume = config.voice.volume;\n      speechSynthesis.speak(msg);\n    }\n    \n    CS1.sayall = function(msg,name){CS1.socket.emit('sayall',{msg:msg,name:name})}\n    \n    CS1.printVoices = ()=>{\n      speechSynthesis.getVoices().forEach(v=>{\n        console.log(v.name,v.lang);\n      });\n    }\n    \n    CS1.sounds = {};\n    \n    Object.keys(config.sounds).forEach(soundName=>{\n      CS1.sounds[soundName] = new Audio(config.sounds[soundName].url);\n      CS1.sounds[soundName].loop = config.sounds[soundName].loop || false;\n      CS1.sounds[soundName].volume = config.sounds[soundName].volume || 1;\n    });\n    \n    CS1.scene=AFRAME.scenes[0];\n    \n    CS1.otherPlayers = {};\n    \n  \n  },\n  \n  tick: function (time,dt) {\n   \n    \n    \n  },\n  \n  start: function () {\n    \n    CS1.logall = function(msg,channel=''){\n      CS1.socket.emit('logall',{msg:msg,channel:channel});\n    }\n    \n    if(CS1.device == \"Oculus Quest\"){\n      CS1.myPlayer.leftHand = CS1.myPlayer.components.player.lh;\n      CS1.myPlayer.rightHand = CS1.myPlayer.components.player.rh;\n      CS1.socket.emit('logall',{msg:`${CS1.myPlayer.name} is playing with an Oculus VR device!`,channel:'0'});\n    }\n    \n    CS1.game.hasBegun = true;\n\n    // Create a new event    \n    let event = new CustomEvent(\n      \"gameStart\", \n      {\n        detail: {\n          message: \"Let's play!\",\n          time: new Date(),\n        },\n        bubbles: true,\n        cancelable: true\n      }\n    );\n\n    // Dispatch the gameStart event\n    document.body.dispatchEvent(event);\n    \n  },\n  \n  playerDistanceTo: function (entity) {\n    return CS1.myPlayer.object3D.position.distanceTo(entity.object3D.position);\n  },\n  \n  fireParticles: function(el){\n    el.components.particles.fire();\n  },\n  \n  determineDevice: function(){\n    \n    navigator.getVRDisplays().then(function(displays) {\n      let scn = document.querySelector('a-scene');\n      if(displays && displays[0] && (displays[0].displayName == \"Oculus Quest\")){\n        document.querySelector('#cam-cursor').setAttribute('visible',false);\n        document.querySelector('#cam-cursor').setAttribute('fuse',false);\n        document.querySelector('#cam-cursor').pause();\n        CS1.device = \"Oculus Quest\";\n      }else if(AFRAME.utils.device.isMobile()){\n        CS1.myPlayer.cursor = document.querySelector('#cam-cursor');\n        CS1.device = \"Mobile\";\n        CS1.log(\"Mobile\");\n        scn.setAttribute('vr-mode-ui','enabled: false');\n        CS1.mylatesttap=0;\n        let mbc = document.querySelector('#mobile-btn-container');\n        \n        let icon = document.createElement('img');\n        \n        icon.setAttribute('src','https://cdn.glitch.com/376724db-dc5f-44ca-af35-36d00838079c%2Fmenu-64-icon.png?v=1562375093680');\n        icon.setAttribute('style','position:absolute;right:0px');\n        mbc.appendChild(icon);  \n        \n        icon.addEventListener('touchstart',e=>{\n          \n           let now = new Date().getTime();\n           let timesince = now - CS1.mylatesttap;\n           \n           if((timesince < 600) && (timesince > 0)){\n            // double tap  \n            \n            // Create a new event    \n            let event = new CustomEvent(\n              \"doubleTapMenu\", \n              {\n                detail: {\n                  message: \"Double Tappin!\",\n                  time: new Date(),\n                },\n                bubbles: true,\n                cancelable: true\n              }\n            );\n            // Dispatch the event\n            document.body.dispatchEvent(event); \n           }else{\n              // too much time to be a doubletap\n             \n           }\n           CS1.mylatesttap = new Date().getTime();          \n          \n        });\n        \n        \n        let icon2 = document.createElement('img');\n        \n        icon2.setAttribute('src','https://cdn.glitch.com/376724db-dc5f-44ca-af35-36d00838079c%2Fchat-64-icon.png?v=1562528152057');\n        icon2.setAttribute('style','position:absolute;left:0px');\n        mbc.appendChild(icon2);  \n        \n        icon2.addEventListener('touchstart',e=>{\n          \n           let now = new Date().getTime();\n           let timesince = now - CS1.mylatesttap;\n           \n           if((timesince < 600) && (timesince > 0)){\n            // double tap  \n            \n            // Create a new event    \n            let event = new CustomEvent(\n              \"doubleTapChat\", \n              {\n                detail: {\n                  message: \"Double Tappin!\",\n                  time: new Date(),\n                },\n                bubbles: true,\n                cancelable: true\n              }\n            );\n            // Dispatch the event\n            document.body.dispatchEvent(event); \n           }else{\n              // too much time to be a doubletap\n             \n           }\n           CS1.mylatesttap = new Date().getTime();          \n          \n        });\n        \n        \n        \n        \n        \n        \n      \n        \n       } else{ //No headset and not mobile\n           CS1.device = \"Standard\";\n           scn.setAttribute('vr-mode-ui','enabled: false');\n           CS1.myPlayer.cursor = document.querySelector('#cam-cursor');\n       }   \n    \n    })\n  \n  }\n   \n});}","import config from '../../../.data/client-config.json';\n\nexport default CS1=>{\n  \n  AFRAME.registerSystem('player', {\n  schema: {\n    avatars:{default:config.avatar.models}\n  },  // System schema. Parses into `this.data`.\n\n  init: function () {\n    \n    function avatarType2Add(p,c){\n      \n      p.model.removeAttribute('gltf-model');\n\n      \n      if(!p.HEAD){\n        \n        \n        p.HEAD = document.createElement('a-gltf-model');\n        p.HAND_L = document.createElement('a-gltf-model');\n        p.HAND_R = document.createElement('a-gltf-model');\n        \n        p.model.appendChild(p.HEAD);\n        p.model.appendChild(p.HAND_L);\n        p.model.appendChild(p.HAND_R);\n        \n        p.HEAD.setAttribute('src',c.url);\n        p.HAND_L.setAttribute('src',c.lefthand);\n        p.HAND_R.setAttribute('src',c.righthand);\n        \n      }else{\n        p.HEAD.setAttribute('visible',true);\n        p.HAND_L.setAttribute('visible',true);\n        p.HAND_R.setAttribute('visible',true);\n      }\n      \n      \n    }\n    \n    \n    CS1.__addOtherPlayer = newPlayerObject=>{\n      console.log(`Adding new player with id: ${newPlayerObject.id}`)\n      console.log(newPlayerObject);\n      console.log(newPlayerObject.data);\n      let c = config.avatar.models[newPlayerObject.data.faceIndex];\n      let p = document.createElement('a-entity');\n      p.model = document.createElement('a-gltf-model');\n      p.avatarType = c.type;\n      p.faceIndex = newPlayerObject.data.faceIndex;\n      p.device = newPlayerObject.data.device;\n      p.appendChild(p.model);\n      p.setAttribute('player','');\n      p.model.setAttribute('shadow','');\n      p.model.setAttribute('scale',`${c.scale} ${c.scale} ${c.scale}`);\n      p.model.setAttribute('visible','true');\n      if(p.avatarType === 1){\n        \n         \n        p.model.setAttribute('src',`${c.url}`);\n        p.model.setAttribute('animation-mixer','clip:idle');\n        p.model.setAttribute('rotation',`${-newPlayerObject.data.rotation.x} ${newPlayerObject.data.rotation.y+180} ${newPlayerObject.data.rotation.z}`);\n        \n      } else if(p.avatarType === 2){\n         \n        avatarType2Add(p,c);\n       \n       \n      }\n        \n      p.id = newPlayerObject.id;\n      p.name = newPlayerObject.name;\n      p.setAttribute('position',`${newPlayerObject.data.position.x} ${newPlayerObject.data.position.y} ${newPlayerObject.data.position.z}`);\n      //DO SOMETHING MAYBE HERE WITH AVATAR TYPE 2\n      p.msg = document.createElement('a-entity');\n      let test = `Hello\\nI am\\n${newPlayerObject.name}!`;\n      p.msg.setAttribute('text',`value:${test};\n                                     align:center;\n                                     width:8;\n                                     wrap-count:24; \n                                     color:yellow`);\n      p.msg.setAttribute('position',c.msg.offset);\n      p.msg.setAttribute('rotation','0 0 0');\n      p.model.appendChild(p.msg);\n      CS1.scene.appendChild(p);\n      CS1.otherPlayers[p.id]=p;\n      CS1.sounds.playerJoined.play();\n    }\n  \n    CS1.__updateOtherPlayers = o=>{\n      Object.keys(o).forEach(function(key,index) {\n        if(key != CS1.socket.id){\n          if(CS1.otherPlayers[key]){\n            let c = config.avatar.models[o[key].faceIndex];\n            let op = CS1.otherPlayers[key];\n            \n            if(op.faceIndex != o[key].faceIndex){\n              \n              \n              op.faceIndex = o[key].faceIndex;\n              (c.type == 1)?op.model.setAttribute('src',c.url):op.model.setAttribute('src','');\n              \n              if(op.avatarType != c.type){\n                \n                op.avatarType = c.type;\n                \n                if(c.type == 1){\n                  //op.model.object3D.rotateY(Math.PI);\n                  //op.msg.setAttribute('rotation','0 0 0'); \n                  \n                  if(op.HEAD){\n                      op.HEAD.setAttribute('visible',false);\n                      op.HAND_L.setAttribute('visible',false);\n                      op.HAND_R.setAttribute('visible',false);\n                    }\n                  op.model.setAttribute('animation-mixer','clip:idle');\n                  op.model.object3D.position.y = 0;\n                  \n                  \n                }  \n                else{\n                  \n                  op.model.setAttribute('rotation','0 0 0');  \n                  avatarType2Add(op,c);\n                }\n                    \n                \n                  \n              }\n              \n              \n            }\n            op.setAttribute('position',`${o[key].position.x} ${o[key].position.y+c.yOffset} ${o[key].position.z}`);\n            op.model.setAttribute('scale',`${c.scale} ${c.scale} ${c.scale}`);\n            op.msg.setAttribute('text',`color:${c.msg.color}`);\n            if(    op.avatarType===2 &&   op.HEAD  &&  (op.device === 'Oculus Quest')   ){\n              \n              \n              op.model.object3D.rotation.set(0,  THREE.Math.degToRad(o[key].rotation.y+180), 0 );\n              if(op.isWalking){ \n                  op.model.object3D.position.y = Math.cos(CS1.myPlayer.timePlayed/100)/10;\n              }\n              \n              op.msg.object3D.position.set(0,3,0);\n              op.HEAD.object3D.position.y = 1.4;\n              op.HEAD.object3D.rotation.set( THREE.Math.degToRad(-o[key].rotation.x/2), 0, 0 );\n              \n              op.HAND_L.object3D.position.set(-1.2*o[key].lhp.x , 1.2*o[key].lhp.y+0.1, -3*o[key].lhp.z);\n              op.HAND_L.object3D.rotation.set(THREE.Math.degToRad(-o[key].lhr.x+45) , \n                                              THREE.Math.degToRad(o[key].lhr.y-90) , \n                                              THREE.Math.degToRad(o[key].lhr.z)\n                                             );\n              op.HAND_R.object3D.position.set(-1.2*o[key].rhp.x  , 1.2*o[key].rhp.y+0.1 , -3*o[key].rhp.z); \n              op.HAND_R.object3D.rotation.set(THREE.Math.degToRad(-o[key].rhr.x+45) , \n                                              THREE.Math.degToRad(o[key].rhr.y+90) , \n                                              THREE.Math.degToRad(o[key].rhr.z)\n                                             );\n              \n\n              \n            }\n            else if(op.avatarType===2 && op.HEAD){  // TYPE 2 WITHOUT OCULUS\n              \n              op.msg.setAttribute('position',`${c.msg.offset}`);\n              \n              op.model.object3D.rotation.set(0,  THREE.Math.degToRad(o[key].rotation.y+180), 0 );\n              if(op.isWalking){ \n                  op.model.object3D.position.y = 1.4 + Math.cos(CS1.myPlayer.timePlayed/100)/10;\n              }\n              else op.model.object3D.position.y = 1.4;\n              \n              op.HEAD.object3D.rotation.set( THREE.Math.degToRad(-o[key].rotation.x/2), 0, 0 );\n              \n              op.HAND_L.object3D.position.set(1 , 0 , 0);\n              op.HAND_L.object3D.rotation.set(THREE.Math.degToRad(0) , \n                                              THREE.Math.degToRad(0) , \n                                              THREE.Math.degToRad(0)\n                                             );\n              op.HAND_R.object3D.position.set(-1  , 0 , 0);\n              op.HAND_R.object3D.rotation.set(THREE.Math.degToRad(0) , \n                                              THREE.Math.degToRad(0) , \n                                              THREE.Math.degToRad(0)\n                                             );\n            \n          \n              \n              \n            }\n            else if(op.avatarType===1){\n              op.msg.setAttribute('position',`${c.msg.offset}`);\n              op.model.setAttribute('rotation',`${-o[key].rotation.x/8} ${o[key].rotation.y+180} ${o[key].rotation.z}`);  \n            }\n            \n            \n            \n          }\n        }\n      });\n    }\n  \n    CS1.__removePlayer = id=>{\n      CS1.otherPlayers[id].parentNode.removeChild(CS1.otherPlayers[id]);\n      delete CS1.otherPlayers[id]; \n      CS1.sounds.playerLeft.play();\n    }\n  \n    CS1.__setPlayerMessage = data=>{\n      if(CS1.otherPlayers[data.id]){\n        let c = config.avatar.models[CS1.otherPlayers[data.id].faceIndex];\n        CS1.otherPlayers[data.id].msg.setAttribute('text',`value:${data.msg};\n        align:center;width:8;wrap-count:24;color:${c.msg.color}`);\n      }\n    }\n    \n  },\n\n \n});\n  \n  AFRAME.registerComponent('player', {\n    schema:{\n      me:{type:'boolean',default:false},\n      eyelevel:{default:1.6},\n      cursorcolor:{default:'crimson'},\n      rayobjects:{default:'[grabbable],.screen,.collidable,.jukebox'},\n      rayfar:{default:4},\n      speed:{default:0.2}\n    },\n    init: function () {\n      const self = this;\n      if(this.data.me){\n        CS1.myPlayer = this.el;\n        this.addCam(self);\n        this.addHands(self);\n        this.isWalking=false;\n        this.addMyListeners();\n        this.el.timePlayed = 0;\n        this.el.setAttribute('chat','');\n        this.el.setAttribute('userdata','');\n        CS1.myPlayer.spawnPos = this.el.getAttribute('position');\n        CS1.myPlayer.spawnRot = this.el.getAttribute('rotation');\n        this.totalSteps = 0;\n        this.active = false;\n      }else{\n        \n      }\n    \n    },\n    addCam: function(self){\n      const ic = document.querySelector('[camera][wasd-controls]');\n      ic.removeAttribute('wasd-controls');\n      ic.removeAttribute('look-controls');\n      ic.setAttribute('camera','active:false');\n      //console.log(ic);\n      self.cam = document.createElement('a-entity');\n      self.cam.id = 'cam';\n      CS1.cam = self.cam;\n      self.cam.setAttribute('camera','active:true');\n      self.cam.setAttribute('position',`0 ${this.data.eyelevel} 0`);\n      self.cam.setAttribute('look-controls','pointerLockEnabled:true;reverseTouchDrag:true');\n      const cc = document.createElement('a-cursor');\n      cc.id = 'cam-cursor';\n      cc.setAttribute('material',`color:${this.data.cursorcolor}`);\n      cc.setAttribute('raycaster',`objects:${this.data.rayobjects};far:${this.data.rayfar}`);\n      self.cam.appendChild(cc);\n      self.el.appendChild(self.cam);\n      self.cam.addEventListener('loaded',_=>{\n        ic.parentNode.removeChild(ic);\n      });\n    },\n    addHands: function(self){\n      self.lh = document.createElement('a-entity');\n      self.lh.setAttribute('laser-controls','hand:left');\n      //self.lh.setAttribute('position','-1 0 0');\n      //self.lh.setAttribute('oculus-touch-controls','hand:left');\n      self.lh.setAttribute('raycaster',`objects:${this.data.rayobjects};far:${this.data.rayfar};useWorldCoordinates:true`);\n      self.rh = document.createElement('a-entity');\n      self.rh.setAttribute('laser-controls','hand:right');\n      //self.rh.setAttribute('position','1 0 0');\n      //self.rh.setAttribute('oculus-touch-controls','hand:right');\n      self.rh.setAttribute('raycaster',`objects:${this.data.rayobjects};far:${this.data.rayfar};useWorldCoordinates:true`);\n      self.el.appendChild(self.lh);\n      self.el.appendChild(self.rh);\n    },\n    addMyListeners: function(){\n      let self = this;\n      CS1.myPlayer.setAttribute('movement-controls',`speed:0;camera:#cam`);\n      document.addEventListener('gameStart',e=>{\n        //console.log('Handling gameStart on my player.');\n        self.el.id = CS1.socket.id;\n        self.el.classList = 'my-player';\n        self.active = true;\n        \n        \n        \n        if(CS1.device == 'Oculus Quest'){\n          self.setOculusCtls();\n          CS1.scene.enterVR();\n          this.lh.addEventListener('model-loaded',e=>{\n            \n            this.lh.loaded = true;\n            \n\n            const object = this.lh.getObject3D('mesh');\n            \n            if (object) {\n              object.traverse(function (node) {\n                if (node.isMesh && node.name === 'stick') {\n              \n\n                  \n                 }\n               });\n            }\n            \n            \n            \n            \n          });\n        }\n        if(CS1.device == 'Mobile'){\n          this.setTouchCtls();\n        }\n        if(CS1.device == 'Standard'){\n          this.setKeyCtls();\n        }\n          \n          \n        \n        self.setSpeed(self.data.speed);\n        \n//         CS1.sounds.playerJoined.onended = ()=>{\n//           CS1.myPlayer.setAttribute('movement-controls',`speed:${self.data.speed};camera:#cam`);\n//         }\n\n        CS1.sounds.playerJoined.play()\n        .catch(err=>{\n          //CS1.myPlayer.setAttribute('movement-controls',`speed:${self.data.speed};camera:#cam`);            \n        });\n        \n        \n        //let c = config.avatar.models[0];\n        let playerData = {};\n        let pos = Object.assign({},CS1.myPlayer.getAttribute('position'));\n        pos.x = Number(pos.x.toFixed(2));\n        pos.y = Number(pos.y.toFixed(2))+0.3;\n        pos.z = Number(pos.z.toFixed(2));\n        playerData.position = pos;\n        let rot = Object.assign({},CS1.cam.getAttribute('rotation'));\n        rot.x = Number(Number(rot.x).toFixed(1));\n        rot.y = Number(Number(rot.y).toFixed(1));\n        rot.z = Number(Number(rot.z).toFixed(1));\n        playerData.rotation = rot;\n        playerData.faceIndex = 1;\n        playerData.device = CS1.device;\n        CS1.socket.playerData.faceIndex = playerData.faceIndex;\n        CS1.myPlayer._avatarType = config.avatar.models[CS1.socket.playerData.faceIndex].type;\n        if(    (CS1.device == 'Oculus Quest') &&  (CS1.myPlayer._avatarType === 2)  ){\n          playerData.lhp = {x:0,y:0,z:0};\n          playerData.lhr = {x:0,y:0,z:0};\n          playerData.rhp = {x:0,y:0,z:0};\n          playerData.rhr = {x:0,y:0,z:0};\n        }\n        CS1.socket.emit('new-player',playerData);\n        \n        \n        \n        \n        \n        \n        \n        \n      })\n    },\n    setKeyCtls: function(){\n      document.body.addEventListener('keydown',e=>{\n        // 0=idle, 1=walk\n         switch(e.which){\n           case 87:\n           case 38:\n           case 83:\n           case 40:\n             if(!this.isWalking){\n               CS1.socket.emit('anim',1);\n               this.isWalking=true;    \n             }       \n         }\n      });\n      document.body.addEventListener('keyup',e=>{\n        // 0=idle, 1=walk\n         switch(e.which){\n           case 87:\n           case 38:\n           case 83:\n           case 40:\n             CS1.socket.emit('anim',0);\n             this.isWalking=false;\n         }\n      });\n    },\n    setTouchCtls: function(){\n      window.addEventListener('touchstart',e=>{\n        if(!this.isWalking){\n               CS1.socket.emit('anim',1);\n               this.isWalking=true;    \n             }    \n      });\n      window.addEventListener('touchend',e=>{\n         CS1.socket.emit('anim',0);\n         this.isWalking=false;\n      });\n    },\n    setOculusCtls: function(){\n      \n      let lh = this.lh.components[\"oculus-touch-controls\"];\n      let rh = this.rh.components[\"oculus-touch-controls\"];\n        \n      \n      setTimeout(()=>{\n        \n        \n        if(AFRAME.utils.device.checkHeadsetConnected()){\n          lh.el.addEventListener('thumbsticktouchstart',e=>{\n             if(!this.isWalking){\n                   CS1.socket.emit('anim',1);\n                   this.isWalking=true;    \n                 }   \n          });\n          lh.el.addEventListener('thumbsticktouchend',e=>{\n             CS1.socket.emit('anim',0);\n             this.isWalking=false; \n          });\n          rh.el.addEventListener('thumbsticktouchstart',e=>{\n             if(!this.isWalking){\n                   CS1.socket.emit('anim',1);\n                   this.isWalking=true;    \n                 }   \n          });\n          rh.el.addEventListener('thumbsticktouchend',e=>{\n             CS1.socket.emit('anim',0);\n             this.isWalking=false; \n          });\n        }\n        \n        \n        \n      },3000);\n      \n      \n    },\n    tick: function(t,dt){\n      \n    if(!this.data.me && this.active)return;\n      \n    if(++this.totalSteps%6 == 0) {\n      \n      \n      let playerData = {};\n      let pos = Object.assign({},CS1.myPlayer.getAttribute('position'));\n      pos.x = Number(pos.x.toFixed(2));\n      pos.y = Number(pos.y.toFixed(2));\n      pos.z = Number(pos.z.toFixed(2));\n      playerData.position = pos;\n      let rot = Object.assign({},CS1.cam.getAttribute('rotation'));\n      rot.x = Number(Number(rot.x).toFixed(1));\n      rot.y = Number(Number(rot.y).toFixed(1));\n      rot.z = Number(Number(rot.z).toFixed(1));\n      playerData.rotation = rot;\n      playerData.faceIndex = CS1.socket.playerData.faceIndex;\n      if(   (CS1.device == 'Oculus Quest') &&  (CS1.myPlayer._avatarType === 2)  && this.lh.hasLoaded ){\n          \n          let lhp = this.lh.getAttribute('position');\n            \n          playerData.lhp = {};\n          playerData.lhp.x = Number(lhp.x.toFixed(2));\n          playerData.lhp.y = Number(lhp.y.toFixed(2));\n          playerData.lhp.z = Number(lhp.z.toFixed(2));\n          let lhr = this.lh.getAttribute('rotation')\n          playerData.lhr = {};\n          playerData.lhr.x = Number(lhr.x.toFixed(1));\n          playerData.lhr.y = Number(lhr.y.toFixed(1));\n          playerData.lhr.z = Number(lhr.z.toFixed(1));\n          let rhp = this.rh.getAttribute('position')\n          playerData.rhp = {};\n          playerData.rhp.x = Number(rhp.x.toFixed(2));\n          playerData.rhp.y = Number(rhp.y.toFixed(2));\n          playerData.rhp.z = Number(rhp.z.toFixed(2));\n          let rhr = this.rh.getAttribute('rotation')\n          playerData.rhr = {};\n          playerData.rhr.x = Number(rhr.x.toFixed(1));\n          playerData.rhr.y = Number(rhr.y.toFixed(1));\n          playerData.rhr.z = Number(rhr.z.toFixed(1));\n        \n      }\n      CS1.socket.setPlayerData(playerData);\n      CS1.socket.sendUpdateToServer();\n      if(this.totalSteps%36 == 0 && CS1.hud && CS1.hud.oxygenMeter){\n        CS1.hud.oxygenMeter.animateTo(CS1.hud.oxygenMeter.el.value-0.0035);\n      }\n      \n      \n    }\n      \n      \n    this.el.timePlayed += dt;\n      \n      \n    },\n    setSpeed: function(s){\n      if(document.querySelector('#navmesh'))\n        this.el.setAttribute('movement-controls',`constrainToNavMesh: true; speed: ${s}`);\n      else\n        this.el.setAttribute('movement-controls',`speed: ${s}`);  \n    }\n    \n  });\n  \n  \n  \n  AFRAME.registerPrimitive('a-player', {\n  defaultComponents: {\n    player: {me:true},\n  },\n\n  // Maps HTML attributes to component properties.\n  mappings: {\n    eyelevel: 'player.eyelevel',\n    cursorcolor: 'player.cursorcolor',\n    rayobjects: 'player.rayobjects',\n    rayfar: 'player.rayfar',\n    speed: 'player.speed'\n  }\n});\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n}\n\n\n\n/*\n<a-entity id=\"my-player\" \n              position=\"0 0 0\"\n              movement-controls=\"constrainToNavMesh: true; speed: 0.2\"\n              player=\"me:true\"\n              chat\n              userdata>\n      \n        <a-entity id=\"cam\"\n                camera\n                position=\"0 1.6 0\"\n                rotation=\"31.283 -12.834 0\"\n                look-controls=\"pointerLockEnabled:true;reverseTouchDrag:true\">\n        \n          <a-cursor id=\"cam-cursor\" \n                    material=\"color:crimson\"\n                    raycaster=\"objects:[grabbable],[sign-in],[iot-api], .screen, .collidable;far:4\"></a-cursor>\n\n        </a-entity>\n        \n        <a-entity id=\"left-hand\" position=\"0 1 0\" laser-controls=\"hand: left\"  \n                raycaster=\"objects:[grabbable],[sign-in],[iot-api], .screen, .collidable;far:4;useWorldCoordinates:true\" ></a-entity>\n        \n      \n<a-entity id=\"right-hand\" position=\"0 1 0\" laser-controls=\"hand: right\"  \n                raycaster=\"objects:[grabbable],[sign-in],[iot-api], .screen, .collidable;far:4;useWorldCoordinates:true\" ></a-entity>\n        \n        \n          \n</a-entity>\n*/\n\n\n\n/*\n\n\np.model.addEventListener('model-loaded', () => { \n        \n          const object = p.model.getObject3D('mesh');\n\n\n          if (object) {\n            object.traverse(function (node) {\n              \n              switch(node.name){\n                case 'BODY': p.BODY = node;\n                  break;\n                case 'HAND_L': p.HAND_L = node;\n                  break;\n                case 'HAND_R': p.HAND_R = node;\n                  break;\n                case 'HEAD': p.HEAD = node;\n                  break;\n              }\n       \n             });\n          }\n        \n        \n        \n        });\n\n\n*/","import config from '../../../.data/client-config.json';\nexport default CS1=>{\n  let socket = CS1.socket = io();\n  socket.on('connect',()=>{\n\n    if(socket.authid){\n      \n      socket.emit('reauth',socket.authid);\n      socket.id = socket.authid;\n      console.log('Emitting reauth!');\n      console.log('socket.id : ',socket.id);\n      console.log('socket.playerData : ');\n      console.log(socket.playerData);\n      console.log('socket.lastPlayerData : ');\n      console.log(socket.lastPlayerData);\n      socket.isInitialized = true;\n      \n    }else{\n      \n      socket.playerData = {position:{},rotation:{},faceIndex:0};\n      socket.lastPlayerData = {position:{},rotation:{},faceIndex:0};\n      //REVISIT\n      CS1.login = (un,pw)=>{\n          socket.emit('login',{name:un,pw:pw});\n        }  \n      \n    }\n    \n    \n    \n    \n  }); \n  \n  socket.on('login-results',data=>{\n    //console.log(data);\n    if(data.success) {\n      document.querySelector('#login').style.zIndex = -1;\n      document.querySelector('#login').style.display = 'none'; \n      document.querySelector('#login').setAttribute('hidden','');\n      CS1.myPlayer.name = data.name;\n      CS1.game.start();\n      socket.authid=socket.id;\n    }\n    else document.getElementById('login-msg').innerHTML = data.msg;\n  });\n  \n  socket.on('anim', data=>{\n    let clips = ['idle','walk'];\n    if(CS1.otherPlayers[data.id]){\n      \n      CS1.otherPlayers[data.id].isWalking = data.anim;\n      if(CS1.otherPlayers[data.id].avatarType===1)\n        CS1.otherPlayers[data.id].firstElementChild.setAttribute('animation-mixer',`clip:${clips[data.anim]}`);\n      \n    }\n  });\n  \n  socket.on('avatar', data=>{\n    if(CS1.otherPlayers[data.id])\n      CS1.otherPlayers[data.id].components.player.setAvatar(data.avatar);\n  });\n    \n  socket.on('disconnect', ()=>{\n    console.log('I have disconnected.');\n    //socket.isInitialized = false;\n  });\n  \n  socket.initializePlayerData = playerData=>{\n    socket.isInitialized = true;\n    socket.playerData = playerData;\n    socket.playerData.faceIndex = 0;\n    socket.emit('new-player', playerData);\n  }\n  \n  socket.setPlayerData = playerData=>{\n    socket.playerData = Object.assign({},playerData);\n  }\n  \n  socket.on('new-player', newPlayerObject=>{\n    if(CS1.debug)console.log('New player object received: ', newPlayerObject);\n    if(CS1.game.hasBegun && newPlayerObject.id != CS1.socket.id) {\n      setTimeout(()=>{CS1.say(`${newPlayerObject.name} has joined the game!`)},1000);\n      CS1.__addOtherPlayer(newPlayerObject);\n    }\n  });\n  \n  socket.on('initial-bodies-state', data=>{\n    if(CS1.debug){\n      console.warn('SETTING INITIAL BODIES STATE');\n      console.log(data);\n    }\n    CS1.__updateGrabbables(data);\n  });\n  \n  const isEqual=CS1.utils.isEqual;\n  //Object.is(socket.playerData, socket.lastPlayerData)\n  socket.sendUpdateToServer = ()=>{\n    \n    \n    if(!AFRAME.utils.deepEqual( socket.lastPlayerData , socket.playerData )){\n      \n      \n      socket.emit('send-update',socket.playerData);\n      \n      socket.lastPlayerData = Object.assign({},socket.playerData);\n      \n      let bodiesData = [];\n      for(var name in CS1.grabbables){\n        let b = CS1.grabbables[name];\n        if(b.states.includes(\"moving\") || b.dirty){\n          let d = {\n            name: name,\n            position: b.object3D.position,\n            scale: b.object3D.scale,\n            rotation: { \n              x: b.object3D.quaternion.x,\n              y: b.object3D.quaternion.y,\n              z: b.object3D.quaternion.z,\n              w: b.object3D.quaternion.w,\n            },\n            soundState: b.soundState\n          };\n          b.dirty = false;\n          bodiesData.push(d);\n        }\n      }\n      if(bodiesData.length > 0) {\n        socket.emit('update-bodies',bodiesData);\n        if(CS1.debug){\n          console.log(`SENDING ${bodiesData[0].name} DATA TO SERVER`);\n          console.log(bodiesData);\n        } \n      }\n      \n      \n      \n    }\n    \n\n    \n  }\n  \n  socket.on('players-already-here', o=>{\n    if(CS1.debug){\n      console.log('receiving players already here');\n      console.log(o);\n    }\n    Object.keys(o).forEach(function(key,index) {\n      CS1.__addOtherPlayer({\"id\":key,\n        \"name\":o[key].name,\n        \"data\":{\"position\": o[key].position,\n                \"rotation\": o[key].rotation,\n                \"faceIndex\":o[key].faceIndex}\n        });\n    });\n    setTimeout(()=>{CS1.say(CS1.game.announcements.welcome);},CS1.game.welcomeDelay);\n  });\n  \n  socket.on('request-for-bodies', ()=>{\n  let ibs = {};\n  for(name in CS1.grabbables){\n    if (!CS1.grabbables.hasOwnProperty(name)) continue;\n    let b = CS1.grabbables[name];\n    ibs[name] = {\n          name: name,\n          position: b.object3D.position,\n          scale: b.object3D.scale,\n          rotation: { \n            x: b.object3D.quaternion.x,\n            y: b.object3D.quaternion.y,\n            z: b.object3D.quaternion.z,\n            w: b.object3D.quaternion.w,\n          },\n          soundState: b.soundState\n        };\n  }\n    socket.emit('initial-bodies-state',ibs);\n    if(CS1.debug){\n      console.warn('SENDING INITIAL BODIES STATE TO SERVER');\n      console.log(ibs);\n    }\n});\n  \n  socket.on('update-bodies', grabbablesData=>{\n    if(CS1.game.hasBegun)CS1.__updateGrabbables(grabbablesData);\n  });\n  \n  socket.on('update-players', playersObject=>{\n    if(CS1.game && CS1.game.hasBegun)CS1.__updateOtherPlayers(playersObject);\n  });\n\n  socket.on('remove-player',id=>{\n    if(CS1.game.hasBegun && CS1.otherPlayers[id]){\n      let name = CS1.otherPlayers[id].name;\n      CS1.__removePlayer(id);\n      setTimeout(()=>{CS1.say(`${name} ${config.playerLeftMsg}`)},1500);\n    }\n  });\n  \n  socket.on('msg',data=>{\n    if(CS1.game.hasBegun)CS1.__setPlayerMessage(data);\n  });\n  \n  socket.on('failed-socket',()=>{\n    window.location.reload();\n  });\n  \n  socket.on('log',msg=>{console.log(msg)});\n  \n  socket.on('say',data=>{\n    CS1.say(data.msg,data.name);\n  });\n  \n\n\n  \n}","import config from '../config/client-config.json';\nexport default CS1=>{\n  \n  AFRAME.registerSystem('collectible', {\n  schema: {},  // System schema. Parses into `this.data`.\n\n  init: function () {\n    \n    CS1.collectibles=[];\n   \n    CS1.socket.on('collect',data=>{\n      if(!(CS1.game && CS1.game.hasBegun))return;\n      let collectedEntity = CS1.collectibles[data.index];\n      if(collectedEntity.el.components.sound__loop)collectedEntity.el.components.sound__loop.pause();\n      collectedEntity.el.setAttribute('visible',false);\n      //collectedEntity.el.setAttribute('scale','0 0 0');\n      collectedEntity.soundIsPlaying=true;\n      collectedEntity.el.components.sound__collect.playSound();\n      if(collectedEntity.data.cb && !AFRAME.utils.device.isMobile()){\n        CS1.game[collectedEntity.data.cb](collectedEntity.el);\n      }\n      collectedEntity.el.addEventListener('sound-ended',e=>{\n        collectedEntity.soundIsPlaying=false;\n        collectedEntity.pause();     \n      });\n      if(data.collector==CS1.socket.id && collectedEntity.data.affects){  \n        if(collectedEntity.data.affects.includes('avatar')){\n           let s;\n           switch(collectedEntity.el.id){\n             case 'avatar-upgrade-1':\n               s=0.35;\n               break;\n             case 'avatar-upgrade-2':\n               s=0.5\n           }\n           CS1.myPlayer.components.player.setSpeed(s);\n           console.log('speed boost');\n        }else  \n        CS1.hud[collectedEntity.data.affects].changeBy(collectedEntity.data.value);\n      }\n      if( (data.collector!=CS1.socket.id) && (collectedEntity.data.affects=='avatarUpgrade')){  \n         console.log(CS1.otherPlayers[data.collector]);\n        let m,t;\n         switch(collectedEntity.el.id){\n           case 'avatar-upgrade-1':\n              m = document.querySelector('#avatar-to-clone-1').cloneNode();\n              t = 'Skully';\n              break;\n           case 'avatar-upgrade-2':\n              m = document.querySelector('#avatar-to-clone-2').cloneNode();\n              t = 'Speedy';\n         }\n        \n         let op = CS1.otherPlayers[data.collector];\n         m.appendChild(op.msg);\n         op.msg.setAttribute('text',`value:${t};\n                                   align:center;\n                                   width:8;\n                                   wrap-count:24; \n                                   color:yellow`);\n         m.setAttribute('visible',true);\n         op.appendChild(m);\n         op.removeChild(op.model);\n         op.model = m;\n         \n      }\n    });\n    \n    CS1.socket.on('spawn-collectible',index=>{\n      let collectedEntity = CS1.collectibles[index];\n      if(collectedEntity.el.components.sound__loop)collectedEntity.el.components.sound__loop.play();\n      collectedEntity.el.setAttribute('visible',true);\n      //collectedEntity.el.setAttribute('scale','1 1 1');\n      collectedEntity.play();\n    });\n\n    CS1.socket.on('request-for-collectibles',()=>{\n      let d=[];\n      CS1.collectibles.forEach(c=>{\n        d.push({spawns:c.data.spawns,spawnDelay:c.data.spawnDelay});\n      });\n      CS1.socket.emit('initial-collectibles-state', d);\n    });\n    \n    \n    \n    \n    \n  },\n\n \n});\n  \n  \n  AFRAME.registerComponent(\"collectible\", {\n\tschema: {\n    threshold: {type: 'number', default: 2.7},\n    soundCollect: {type: 'string',default:'https://cdn.glitch.com/f8abb766-9950-44ff-9adb-2f5f53fdaf1b%2Fpowerup_1.mp3?1552158629039'},\n    soundLoop: {},\n    cb:{type:'string',default:''},\n    affects:{type:'string',default:''},\n    value:{type:'number',default:1},\n    spawns:{type:'boolean',default:false},\n    spawnDelay:{type:'number',default:5}\n\t},\n\tinit: function()\n\t{\n    \n    this.el.setAttribute('sound__collect',`src:url(${this.data.soundCollect})`);\n    if(this.data.soundLoop)this.el.setAttribute('sound__loop',`src:url(${this.data.soundLoop});autoplay:true;loop:true`);\n    CS1.collectibles.push(this);\n    this.soundIsPlaying=false;\n      \n  }, \n\ttick: function()\n\t{   \n     if((this.el.object3D.position.distanceTo(CS1.myPlayer.object3D.position) < this.data.threshold)&&\n          this.data.affects!='avatarUpgrade'){ \n       this.collect();\n     }\n     if(this.data.affects=='avatarUpgrade' &&\n        (this.el.parentElement.object3D.position.distanceTo(CS1.myPlayer.object3D.position) < this.data.threshold) ){\n       this.collect();\n     }\n\t\t\n\t},\n  \n  collect: function(){\n    if(this.soundIsPlaying)return;\n    if(CS1.socket.disconnected){\n      if(this.el.components.sound__loop)this.el.components.sound__loop.pause();\n      this.el.setAttribute('visible',false);\n      this.el.setAttribute('scale','0 0 0');\n      this.soundIsPlaying=true;\n      this.el.components.sound__collect.playSound();\n      if(this.data.cb)CS1.game[this.data.cb](this.el);\n      if(this.data.affects && this.data.affects !== 'avatarUpgrade')\n        CS1.hud[this.data.affects].animateTo(CS1.hud[this.data.affects].value+this.data.value);\n      this.el.addEventListener('sound-ended',e=>{\n        this.soundIsPlaying=false;\n        this.pause();   \n      }); \n      if(this.data.spawns){\n             setTimeout(()=>{\n                if(this.el.components.sound__loop)this.el.components.sound__loop.play();\n                this.el.setAttribute('visible',true);\n                this.el.setAttribute('scale','1 1 1');\n                this.play();\n             },this.data.spawnDelay*1000);\n           }\n    } else{\n      CS1.socket.emit('request-collection',{index: CS1.collectibles.indexOf(this)}); \n    \n    }\n \n  }\n  \n  \n})\n  \n}","import config from '../../../.data/client-config.json';\nexport default(()=>{\nwindow.onload = e=>{\n  let loginHTML = `\n<div class=\"modal fade\" id=\"login-modal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\" style=\"display: block;background-color:${config.theme.overlayColor}\">\n    <div class=\"modal-dialog\">\n\t\t  <div class=\"loginmodal-container\" style=\"background-color:${config.theme.formColor}\">\n          <image id=\"logo\" src=${config.theme.logo} width=\"64px\">\n          <h3 id=\"gamename\" style=\"color:${config.theme.titleFontColor}\">${config.gameName}</h3>\n\t\t\t<div>\t  \n\t\t\t\t\t<input  placeholder=\"username\" class=\"q1\">\n          <input  placeholder=\"password\" type=\"password\" class=\"q2\"> \n          <button id=\"lb\" style=\"background-color:${config.theme.formButtonColor}\">Submit</button> \n          <div style=\"color:${config.theme.formButtonColor}\" id=\"login-msg\"></div> \n      </div>\t\t\t\t\n\n\t\t\t</div>\n\t</div>\n</div>\n`\n let loginContainer = document.querySelector('#login');\n loginContainer.innerHTML = loginHTML;\n setTimeout(e=>{\n   document.querySelector('.q1').focus(); \n   if(!(CS1 && CS1.socket.connected)){\n     document.getElementById('login-msg').innerHTML = 'OFFLINE MODE';\n      document.querySelector('#lb').setAttribute('value','Play Game Offline');\n   }\n },1000);\n document.getElementById('lb').addEventListener(\"click\",login);\n document.querySelector('.q2').addEventListener(\"keydown\",e=>{\n   if(e.code=='Enter')login(e);\n }); \n  \n  function login(e){\n    e.preventDefault(); \n    if(!(CS1 && CS1.socket.connected)){\n      loginContainer.style.zIndex = -1;\n      loginContainer.setAttribute('hidden','');\n      CS1.myPlayer.components[\"movement-controls\"].data.speed=CS1.myPlayer.startSpeed;\n      CS1.sounds.playerJoined.play();\n      setTimeout(()=>{CS1.say(CS1.game.announcements.welcome)},CS1.game.welcomeDelay);    \n    }\n    else if(document.querySelector('.q1').value.length > 0 && document.querySelector('.q2').value.length > 0){\n     if(navigator.vendor.includes('Apple')){\n        CS1.sounds.playerJoined.play()\n         .catch(err=>{console.log(err)});\n      } \n     CS1.login(document.querySelector('.q1').value,document.querySelector('.q2').value);\n      document.querySelector('.q1').value = '';\n      document.querySelector('.q2').value = '';\n    }\n  }\n  \n}\n  \n})()\n","export default (function aframeEffects(){\n\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tif (!window.AFRAME) {\n\t    var Component = function (el, id) {\n\t        var self = this;\n\t        this.el = el;\n\t        this.el;\n\t        this.id = id;\n\t        this.attrName = this.name + (id ? '__' + id : '');\n\t        this.el.components[this.attrName] = this;\n\t        this.data = {};\n\t    };\n\n\t    var System = function (el) {\n\t        var self = this;\n\t        this.el = this.sceneEl = el;\n\t        this.el.systems[this.name] = this;\n\t    };\n\n\t    AFRAME = {\n\t        components: {},\n\t        systems: {},\n\t        registerShader: function () {}\n\t    };\n\n\t    AFRAME.registerComponent = function (name, definition) {\n\t        var NewComponent;\n\t        var proto = {};\n\n\t        Object.keys(definition).forEach(function (key) {\n\t            proto[key] = {\n\t                value: definition[key],\n\t                writable: true\n\t            };\n\t        });\n\n\t        NewComponent = function (el, attr, id) {\n\t            Component.call(this, el, attr, id);\n\t        };\n\n\t        NewComponent.prototype = Object.create(Component.prototype, proto);\n\t        NewComponent.prototype.name = name;\n\t        NewComponent.prototype.constructor = NewComponent;\n\n\t        AFRAME.components[name] = NewComponent;\n\t        return NewComponent;              \n\t    };\n\n\t    AFRAME.registerSystem = function (name, definition) {\n\t        var NewSystem;\n\t        var proto = {};\n\n\t        Object.keys(definition).forEach(function (key) {\n\t            proto[key] = {\n\t                value: definition[key],\n\t                writable: true\n\t            };\n\t        });\n\n\t        NewSystem = function (el, attr, id) {\n\t            System.call(this, el, attr, id);\n\t        };\n\n\t        NewSystem.prototype = Object.create(System.prototype, proto);\n\t        NewSystem.prototype.name = name;\n\t        NewSystem.prototype.constructor = NewSystem;\n\n\t        AFRAME.systems[name] = NewSystem;\n\t        return NewSystem;              \n\t    };\n\n\t    var fx = function(renderer, scene, cameras) {\n\t        this.sceneEl = this;\n\t        this.renderTarget = null;\n\t        this.renderer = renderer;\n\t        this.object3D = scene;\n\t        this.cameras = Array.isArray(cameras) ? cameras : [cameras];\n\t        this.components = {};\n\t        this.systems = {};\n\t        this.isPlaying = true;\n\t        this.systems.effects = new AFRAME.systems.effects(this)\n\t        this.systems.effects.init();\n\t    };\n\n\t    fx.prototype = Object.create({}, {\n\t        chain: {\n\t            value: function(chain) {\n\t                var sys = this.systems.effects, self = this;\n\t                var oldData = sys.data;\n\t                sys.data = chain;\n\t                sys.update(oldData);\n\t                sys.tick(0,0);\n\t            }\n\t        },\n\n\t        camera: {\n\t            set: function(cameras) {\n\t                this.cameras = Array.isArray(cameras) ? cameras : [cameras];\n\t            },\n\t            \n\t            get: function () {\n\t                return this.cameras[0];\n\t            }\n\t        },\n\n\t        scene: {\n\t            set: function(v) {\n\t                this.object3D = v;\n\t            },\n\t            \n\t            get: function () {\n\t                return this.object3D;\n\t            }\n\t        },\n\n\t        init: {\n\t            value: function(name) {\n\t                this.remove(name);\n\t                var arr = name.split(\"__\");\n\t                var pro = AFRAME.components[arr[0]];\n\t                if(!pro) return null;\n\t                var obj = new pro(this, arr[1]);\n\t                if(obj.schema.type || obj.schema.default) {\n\t                    obj.data = obj.schema.default;\n\t                } else {\n\t                    for(var i in obj.schema) {\n\t                        obj.data[i] = obj.schema[i].default;\n\t                    }\n\t                }\n\t                if(obj.init) obj.init();\n\t                if(obj.update) obj.update({});\n\t                return obj;\n\t            }\n\t        },\n\n\t        update: {\n\t            value: function(name, data) {\n\t                var obj = this.components[name];\n\t                if(!obj) { obj = this.init(name); }\n\t                if(!obj || data === undefined) return;\n\t                \n\t                var oldData = obj.data, nd = obj.data, schema = obj.schema;\n\t                if (obj.schema.type || obj.schema.default) {\n\t                    obj.data = data;\n\t                } else {\n\t                    oldData = {};\n\t                    for(var o in nd) {\n\t                        oldData[o] = nd[o];\n\t                        if (data[o]) nd[o] = data[o]; \n\t                    }\n\t                }\n\t                if(obj.update) obj.update(oldData);\n\t            }\n\t        },\n\n\t        remove: {\n\t            value: function(name) {\n\t                var obj = this.components[name];\n\t                if(obj && obj.remove) { obj.remove(); }\n\t                delete this.components[name];\n\t            }\n\t        },\n\n\t        render: { \n\t            value: function(time) {\n\t                var behaviors = this.components;\n\t                var sys = this.systems.effects;\n\n\t                var timeDelta = this.time ? time - this.time : 0;\n\t                this.time = time;\n\n\t                for(var b in behaviors) {\n\t                    var behavior = behaviors[b];\n\t                    if (behavior.tick) behavior.tick(time, timeDelta);\n\t                }\n\n\t                sys.tick(time, timeDelta);\n\t                sys.cameras = this.cameras;\n\n\t                for(var b in behaviors) {\n\t                    var behavior = behaviors[b];\n\t                    if (behavior.tock) behavior.tock(time, timeDelta);\n\t                }\n\n\t                sys.tock(time, timeDelta);\n\t            }\n\t        }\n\t    });\n\n\t    window.AFRAME.Effects = fx;\n\t}\n\n\t__webpack_require__(1)\n\t__webpack_require__(3)\n\t__webpack_require__(17)\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(2);\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n\t// Copyright 2017-2018 Yannis Gravezas <wizgrav@gmail.com> MIT licensed\n\n\tAFRAME.registerSystem(\"effects\", {\n\t    schema: { type: \"array\", default: [] },\n\n\t    init: function () {\n\t        this.effects = {};\n\t        this.passes = [];\n\t        this._passes = [];\n\t        this.cameras = [];\n\t        this.setupPostState();\n\t        this.needsOverride = true;\n\t        this.lightComponents = [];\n\t\t\tthis.LightState = {\n\t\t\t\trows: 0,\n\t\t\t\tcols: 0,\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\ttileData: { value: null },\n\t\t\t\ttileTexture: { value: null },\n\t\t\t\tlightTexture: {\n\t\t\t\t\tvalue: new THREE.DataTexture( new Float32Array( 32 * 2 * 4 ), 32, 2, THREE.RGBAFormat, THREE.FloatType )\n\t\t\t\t},\n\t\t\t};\n\t    },\n\n\t    update: function () {\n\t        this.needsUpdate = true;\n\t    },\n\t    \n\t    addLight: function (behavior) {\n\t\t\tthis.lightComponents.push(behavior);\n\t\t},\n\t\t\n\t\tremoveLight: function (behavior) {\n\t\t\tvar index = this.lightComponents.indexOf(behavior);\n\t\t\tthis.lightComponents.splice(index);\n\t    },\n\t    \n\t    setupPostState: function () {\n\t        this.renderTarget = new THREE.WebGLRenderTarget(1, 1, { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat });\n\t        this.renderTarget.texture.generateMipmaps = false;\n\t        this.renderTarget.depthBuffer = true;\n\t        this.renderTarget.depthTexture = new THREE.DepthTexture();\n\t        this.renderTarget.depthTexture.type = THREE.UnsignedShortType;\n\t        this.renderTarget.depthTexture.minFilter = THREE.LinearFilter;\n\t        this.renderTarget.stencilBuffer = false;\n\t        this.scene = new THREE.Scene();\n\t        this.camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\t        this.quad = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), null);\n\t        this.quad.frustumCulled = false;\n\t        this.scene.add(this.quad);\n\t        this.sceneLeft = new THREE.Scene();\n\t        this.quadLeft = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), null);\n\t        this.quadLeft.geometry.attributes.uv.array.set([0, 1, 0.5, 1, 0, 0, 0.5, 0]);\n\t        this.quadLeft.frustumCulled = false;\n\t        this.sceneLeft.add(this.quadLeft);\n\t        this.sceneRight = new THREE.Scene();\n\t        this.quadRight = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), null);\n\t        this.quadRight.geometry.attributes.uv.array.set([0.5, 1, 1, 1, 0.5, 0, 1, 0]);\n\t        this.quadRight.frustumCulled = false;\n\t        this.sceneRight.add(this.quadRight);\n\t        this.targets = [\n\t            new THREE.WebGLRenderTarget(1, 1, { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat }),\n\t            new THREE.WebGLRenderTarget(1, 1, { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat })\n\t        ];\n\t        \n\t        this.tDiffuse = {type: \"t\", value: null};\n\t        this.tDepth = {type: \"t\", value: this.renderTarget.depthTexture};\n\t        this.cameraFar = {type: \"f\", value: 0};\n\t        this.cameraNear = {type: \"f\", value: 0};\n\t        this.time = { type: \"f\", value: 0 };\n\t        this.timeDelta = { type: \"f\", value: 0 };\n\t        this.uvClamp = { type: \"v2\", value: this.uvBoth };\n\t        this.resolution = { type: \"v4\", value: new THREE.Vector4() };\n\n\t    },\n\n\t    vertexShader: [\n\t        '#include <common>',\n\t        'varying vec2 vUv;',\n\t        'void main() {',\n\t        '   vUv = uv;',\n\t        '   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\t        '}'\n\t    ].join('\\n'),\n\n\t    uvLeft: new THREE.Vector2(0, 0.5),\n\t    uvRight: new THREE.Vector2(0.5, 1),\n\t    uvBoth: new THREE.Vector2(0, 1),\n\n\t    parseToken: /([#a-z0-9\\-\\_]+)\\.{0,1}([#a-z0-9\\-\\_]*)\\s*\\({0,1}\\s*([\\$a-z0-9\\-\\_\\.\\s]*)\\){0,1}([\\!\\?]{0,1})/i,\n\n\t    renderPass: function (material, renderTarget, viewCb, forceClear){\n\t        var renderer = this.sceneEl.renderer;\n\t        this.quad.material = material;\n\t        var isFn = typeof viewCb === \"function\";\n\t        var s = renderTarget || renderer.getSize();\n\t        this.resolution.value.set(s.width, s.height, 1/s.width, 1/s.height);\n\t        var oldClear = renderer.autoClear;\n\t        renderer.autoClear = false;\n\t        if (viewCb) {\n\t            if (this.cameras.length > 1){\n\t                this.quadLeft.material = material;\n\t                this.uvClamp.value = this.uvLeft;\n\t                setView(0, 0, Math.round(s.width * 0.5), s.height);\n\t                if (isFn) viewCb(material, this.cameras[0], -1);\n\t\t\t\t    renderer.render(this.sceneLeft, this.camera, renderTarget, oldClear || forceClear);        \n\t                \n\t                this.quadRight.material = material;\n\t                this.uvClamp.value = this.uvRight;\n\t                setView(Math.round(s.width * 0.5), 0, Math.round(s.width * 0.5), s.height);\n\t                if (isFn) viewCb(material, this.cameras[1], 1);\n\t                renderer.render( this.sceneRight, this.camera, renderTarget);\n\n\t                this.uvClamp.value = this.uvBoth;\n\t                setView(0, 0, s.width, s.height);\n\t            } else {\n\t                setView(0, 0, s.width, s.height);\n\t                if (isFn) viewCb(material, this.sceneEl.camera, 0);\n\t                renderer.render( this.scene, this.camera, renderTarget, oldClear || forceClear);\n\t            }\n\t        } else {\n\t            setView(0, 0, s.width, s.height);\n\t            renderer.render(this.scene, this.camera, renderTarget, oldClear || forceClear);\n\t        }\n\t        renderer.autoClear = oldClear;\n\t        function setView(x,y,w,h) {\n\t            if (renderTarget) {\n\t                renderTarget.viewport.set( x, y, w, h );\n\t\t\t\t\trenderTarget.scissor.set( x, y, w, h );\n\t            } else {\n\t                renderer.setViewport( x, y, w, h );\n\t\t\t\t\trenderer.setScissor( x, y, w, h );\n\t            }\n\t        }\n\t    },\n\n\t    materialize: function (m) {\n\t        var fs = [\n\t            \"uniform vec2 uvClamp;\",\n\t            \"vec4 textureVR( sampler2D sampler, vec2 uv ) {\",\n\t            \" return texture2D(sampler, vec2(clamp(uv.x, uvClamp.x, uvClamp.y), uv.y));\",\n\t            \"} \",\n\t            m.fragmentShader            \n\t        ].join(\"\\n\");\n\t        \n\t        m.uniforms.uvClamp = this.uvClamp;\n\t        \n\t        return new THREE.ShaderMaterial({\n\t            uniforms: m.uniforms,\n\t            vertexShader: m.vertexShader || this.vertexShader,\n\t            fragmentShader: fs,\n\t            depthWrite: false,\n\t            depthTest: false,\n\t            blending: THREE.NoBlending,\n\t            fog: false,\n\t            extensions: {\n\t                derivatives: true\n\t            },\n\t            defines: m.defines || {}\n\t        });\n\t    },\n\n\t    fuse: function (temp, alpha) {\n\t        if (!temp.length) return;\n\t        var self = this, count=0;\n\t        var chunks = [], head = [], main = [], includes = {}, \n\t            needsDepth = false, needsDiffuse = false, k;\n\t \n\t        var uniforms = {\n\t            time: this.time,\n\t            timeDelta: this.timeDelta,\n\t            resolution: this.resolution\n\t        };\n\n\t        temp.forEach(function (obj) {\n\t            var callMain = true, swapMain = false, args=[];\n\t            if (typeof obj === \"string\") {\n\t                var tok = self.parseToken.exec(obj);\n\t                if(!tok) return;\n\t                \n\t                callMain = tok[4] !== \"!\";\n\t                swapMain = tok[4] === \"?\";\n\t                obj = tok[1];\n\t                var prop = tok[2];\n\t                var temp = {};\n\t                \n\t                if(obj[0] === \"#\") {\n\t                    var el = document.querySelector(obj);\n\t                    if(!el) return;\n\t                    \n\t                    obj = {\n\t                        attrName: [obj.replace(\"#\", \"script_\"), \"_\", (count++), \"_\"].join(\"\"),\n\t                        fragment: prop ? \n\t                            (el[prop] instanceof Document ? el[prop].body.textContent : el[prop]) \n\t                            : el.textContent,\n\t                        depth: el.dataset.depth !== undefined,\n\t                        diffuse: el.dataset.diffuse !== undefined,\n\t                        includes: el.dataset.includes ? el.dataset.includes.trim().split(\" \") : null,\n\t                        defaults: el.dataset.defaults ? el.dataset.defaults.trim().split(\" \") : null\n\t                    };\n\t                } else {\n\t                    obj = self.effects[obj];\n\t                    if (!obj) return;\n\t                    if (prop) {\n\t                        obj = obj.exports ? obj.exports[prop] : null;\n\t                        if (!obj) return;\n\t                        obj.attrName = tok[1] + \"_\" + prop + \"_\";\n\t                    }\n\t                }\n\t                if (tok[3]) {\n\t                    args = tok[3].trim().split(\" \");\n\t                }\n\t            }\n\t            var prefix = (obj.attrName ? obj.attrName : \"undefined_\" + (count++)) + \"_\";\n\t            prefix = prefix.replace(\"__\",\"_\");\n\t            if (obj.defaults) {\n\t                obj.defaults.forEach(function (d, i) {\n\t                    var v = args[i];\n\t                    chunks.push([\"#define $\", i, \" \", v  && v !== \"$\" ? v : d ].join(\"\").replace(/\\$/g, prefix).replace(\"__\",\"_\"));\n\t                });\n\t            }\n\t            if (obj.diffuse) { needsDiffuse = true; }\n\t            if (obj.depth) { needsDepth = true; }\n\t            if (obj.fragment) { chunks.push(obj.fragment.replace(/\\$/g, prefix)); }\n\t            if (obj.uniforms) {\n\t                for (var u in obj.uniforms) {\n\t                    uniforms[prefix + u] = obj.uniforms[u];\n\t                }\n\t            };\n\t            if (obj.includes) {\n\t                obj.includes.forEach(function (inc) {\n\t                    includes[inc] = true;\n\t                });\n\t            }\n\t            if (callMain) {\n\t                main.push([\"  \", prefix, \"main(\", ( swapMain ? \"origColor, color\": \"color, origColor\"), \", vUv, depth);\"].join(\"\"));\n\t            }\n\t        });\n\t        var t2u = { \"i\": \"int\", \"f\": \"float\", \"t\": \"sampler2D\",\n\t            \"v2\": \"vec2\", \"v3\": \"vec3\", \"c\": \"vec3\",\"v4\": \"vec4\", \n\t            \"m2\": \"mat2\", \"m3\":\"mat3\", \"m4\": \"mat4\", \"b\": \"bool\" };\n\n\t        for(k in includes) { head.push(\"#include <\" + k + \">\"); }\n\t        \n\t        var premain = [\n\t            \"void main () {\" \n\t        ];\n\t        uniforms[\"tDiffuse\"] = this.tDiffuse;\n\t             \n\t        if (needsDiffuse){\n\t             premain.push(\"  vec4 color = texture2D(tDiffuse, vUv);\"); \n\t        } else {\n\t             premain.push(\"  vec4 color = vec4(0.0);\"); \n\t        }\n\t        premain.push(\"  vec4 origColor = color;\"); \n\t        \n\t        uniforms[\"tDepth\"] = this.tDepth;\n\t        uniforms[\"cameraFar\"] = this.cameraFar;\n\t        uniforms[\"cameraNear\"] = this.cameraNear;\n\t            \n\t        if (needsDepth){\n\t            premain.push(\"  float depth = texture2D(tDepth, vUv).x;\");\n\t        } else {\n\t            premain.push(\"  float depth = 0.0;\");\n\t        }\n\t        \n\t        for(k in uniforms) {\n\t            var u = uniforms[k];\n\t            head.push([\"uniform\", t2u[u.type], k, \";\"].join(\" \"));\n\t        }\n\t        \n\t        head.push(\"varying vec2 vUv;\");\n\t        var source = [\n\t            head.join(\"\\n\"), chunks.join(\"\\n\"), \"\\n\",\n\t                premain.join(\"\\n\"), main.join(\"\\n\"), \n\t                alpha ? \"  gl_FragColor = color;\" : \"  gl_FragColor = vec4(color.rgb, 1.0);\", \"}\"\n\t        ].join(\"\\n\");\n\n\t        var material = this.materialize({\n\t            fragmentShader: source, \n\t            uniforms: uniforms\n\t        });\n\n\t        if(this.sceneEl.components.debug) console.log(source, material);\n\t        return material;\n\t    },\n\n\t    rebuild: function () {\n\t        var self = this, passes = [], temp = [];\n\t        this.passes.forEach(function(pass){\n\t            if (pass.dispose) pass.dispose();\n\t        });\n\t        this.data.forEach(function (k) {\n\t            if(!k){\n\t                pickup();\n\t                return;\n\t            }\n\t            var obj, name;\n\t            var tok = self.parseToken.exec(k);\n\t            if(!tok || !tok[1]) return;\n\t            name = tok[1];\n\t            obj = self.effects[name];\n\t            if (!obj){\n\t                temp.push(k);\n\t                return;\n\t            }\n\t            if (obj.pass) {\n\t                pickup();\n\t                passes.push({ pass: obj.pass, behavior: obj } );\n\t            } else if (obj.material){\n\t                pickup();\n\t                passes.push({ pass: makepass(obj.material, false, obj.vr), behavior: obj });\n\t            } else {\n\t                temp.push(k);\n\t            }          \n\t        });\n\n\t        function pickup () {\n\t            if (!temp.length) return;\n\t            passes.push({ pass: makepass(self.fuse(temp), true)});\n\t            temp = [];\n\t        }\n\n\t        function makepass (material, dispose, viewCb) {\n\t            return {\n\t                render: function(renderer, writeBuffer, readBuffer){\n\t                    self.renderPass(material, writeBuffer, viewCb);\n\t                },\n\n\t                dispose: function () {\n\t                    if (dispose) material.dispose();\n\t                }\n\t            }\n\t        }\n\t        pickup();\n\t        this.needsUpdate = false;\n\t        this.passes = passes;\n\t    },\n\n\t    isActive: function (behavior, resize) {\n\t        var scene = this.sceneEl;\n\t        if (behavior.bypass) return false;\n\t        var isEnabled = scene.renderTarget ? true : false;\n\t        if (!isEnabled) return false;\n\t        if (resize && (this.needsResize || behavior.needsResize) && behavior.setSize) {\n\t            var size = scene.renderer.getSize();\n\t            behavior.setSize(size.width, size.height);\n\t            delete behavior.needsResize;\n\t        }\n\t        return true;\n\t    },\n\n\t    register: function (behavior) {\n\t        this.effects[behavior.attrName] = behavior;\n\t        this.needsUpdate = true;\n\t    },\n\n\t    unregister: function (behavior) {\n\t        delete this.effects[behavior.attrName];\n\t        this.needsUpdate = true;\n\t    },\n\n\t    tick: function (time, timeDelta) {\n\t        var self = this, sceneEl = this.sceneEl, renderer = sceneEl.renderer, effect = sceneEl.effect, \n\t            rt = this.renderTarget, rts = this.targets, scene = sceneEl.object3D;\n\t        if(!rt || !renderer) { return; }\n\t        if (this.needsOverride) {\n\t            if(scene.onBeforeRender) {\n\t                scene.onBeforeRender = function (renderer, scene, camera) {\n\t                    var size = renderer.getSize();\n\t                    if (size.width !== rt.width || size.height !== rt.height) {\n\t                        rt.setSize(size.width, size.height);\n\t                        rts[0].setSize(size.width, size.height);\n\t                        rts[1].setSize(size.width, size.height);\n\t                        self.resolution.value.set(size.width, size.height, 1/size.width, 1/size.height);\n\t                        self.needsResize = true;\n\t                        self.resizeTiles();\n\t                    }\n\t                    if(camera instanceof THREE.ArrayCamera) {\n\t                        self.cameras = camera.cameras;\n\t                    } else {\n\t                        self.cameras.push(camera);\n\t                    }\n\t                    self.tileLights(renderer, scene, camera);\n\t                }\n\t            } else {\n\t                var rendererRender = renderer.render;\n\t                renderer.render = function (scene, camera, renderTarget, forceClear) {\n\t                    if (renderTarget === rt) {\n\t                        var size = renderer.getSize();\n\t                        if (size.width !== rt.width || size.height !== rt.height) {\n\t                            rt.setSize(size.width, size.height);\n\t                            rts[0].setSize(size.width, size.height);\n\t                            rts[1].setSize(size.width, size.height);\n\t                            self.resolution.value.set(size.width, size.height, 1/size.width, 1/size.height);\n\t                            self.needsResize = true;\n\t                        }\n\t                        self.cameras.push(camera);\n\t                    }\n\t                    rendererRender.call(renderer, scene, camera, renderTarget, forceClear);\n\t                }\n\t            }        \n\t            this.needsOverride = false;\n\t        }\n\t        this.cameras = [];\n\t        this.time.value = time / 1000;\n\t        this.timeDelta.value = timeDelta / 1000;\n\n\t        if (this.needsUpdate === true) { this.rebuild(); }\n\n\t       this.setupPasses();\n\n\t        this.tDiffuse.value = this.renderTarget.texture;\n\t        this.tDepth.value = this.renderTarget.depthTexture;\n\t        var camera = this.sceneEl.camera;\n\t        this.cameraFar.value = camera.far;\n\t        this.cameraNear.value = camera.near;                \n\t    },\n\n\t    setupPasses : function () {\n\t        var arr = [], rt = this.renderTarget;\n\t        this.passes.forEach(function (p) {\n\t            if (p.behavior && p.behavior.bypass === true) return;\n\t            arr.push(p);\n\t        });\n\t        this.sceneEl.renderTarget = arr.length && this.sceneEl.isPlaying ? rt : null;\n\t        this._passes = arr;\n\t    },\n\t    tock: function () {\n\t        var scene = this.sceneEl, renderer = scene.renderer, self = this;\n\t        if(!scene.renderTarget) { return; }\n\t        var rt = scene.renderTarget, rts = this.targets;\n\t        this._passes.forEach(function (pass, i) {\n\t            var r = i ? rts[i & 1] : rt;\n\t            self.tDiffuse.value = r.texture;   \n\t            if (pass.behavior && pass.behavior.resize) self.isActive(pass.behavior, true);\n\t            pass.pass.render(renderer, i < self._passes.length - 1 ? rts[(i+1) & 1] : null, r);\n\t        });\n\t        this.needsResize = false;\n\t    },\n\n\t    resizeTiles: function () {\n\t        var LightState = this.LightState;\n\t        var width = LightState.width;\n\t        var height = LightState.height;\n\t        LightState.cols = Math.ceil( width / 32 );\n\t        LightState.rows = Math.ceil( LightState.height / 32 );\n\t        LightState.tileData.value = [ width, height, 0.5 / Math.ceil( width / 32 ), 0.5 / Math.ceil( height / 32 ) ];\n\t        LightState.tileTexture.value = new THREE.DataTexture( new Uint8Array( LightState.cols * LightState.rows * 4 ), LightState.cols, LightState.rows );\n\t    },\n\t    \n\t    tileLights: function ( renderer, scene, camera ) {\n\t        if ( ! camera.projectionMatrix ) return;\n\t        var LightState = this.LightState, lights = this.lightComponents;\n\t        var size = renderer.getSize();\n\t        var d = LightState.tileTexture.value.image.data;\n\t        var ld = LightState.lightTexture.value.image.data;\n\t        var viewMatrix = camera.matrixWorldInverse;\n\t        d.fill( 0 );\n\t        var vector = new THREE.Vector3();\n\n\t        var passes;\n\t        if(camera instanceof THREE.ArrayCamera) {\n\t            passes = [ [0.5, 0, camera.cameras[0]], [0.5, 0.5, camera.cameras[1]]];\n\t        } else {\n\t            passes = [1.0, 0, camera];\n\t        }\n\t        passes.forEach(function(pass){\n\t            lights.forEach( function ( light, index ) {\n\t                vector.setFromMatrixPosition( light.el.object3D.matrixWorld );\n\t                var pw = LightState.width * pass[0];\n\t                var pm = LightState.width * pass[1];\n\t                var bs = self.lightBounds( pass[2], vector, light.data.radius, pw );\n\t                vector.applyMatrix4( viewMatrix );\n\t                vector.toArray( ld, 4 * index );\n\t                ld[ 4 * index + 3 ] = light.data.radius;\n\t                light.data.color.toArray( ld, 32 * 4 + 4 * index );\n\t                ld[ 32 * 4 + 4 * index + 3 ] = light.data.decay;\n\t                if ( bs[ 1 ] < 0 || bs[ 0 ] > pw || bs[ 3 ] < 0 || bs[ 2 ] > LightState.height ) return;\n\t                if ( bs[ 0 ] < 0 ) bs[ 0 ] = 0;\n\t                if ( bs[ 1 ] > pw ) bs[ 1 ] = pw;\n\t                if ( bs[ 2 ] < 0 ) bs[ 2 ] = 0;\n\t                if ( bs[ 3 ] > LightState.height ) bs[ 3 ] = LightState.height;\n\t                var i4 = Math.floor( index / 8 ), i8 = 7 - ( index % 8 );\n\t                for ( var i = Math.floor( bs[ 2 ] / 32 ); i <= Math.ceil( bs[ 3 ] / 32 ); i ++ ) {\n\t                    for ( var j = Math.floor( (bs[ 0 ] + pm) / 32  ); j <= Math.ceil( (bs[ 1 ] + pm) / 32 ); j ++ ) {\n\t                        d[ ( LightState.cols * i + j ) * 4 + i4 ] |= 1 << i8;\n\t                    }\n\t                }\n\t            } );\n\t        });\n\t        LightState.tileTexture.value.needsUpdate = true;\n\t        LightState.lightTexture.value.needsUpdate = true;\n\t    },\n\t    \n\t    lightBounds: function () {  \n\t        let v = new THREE.Vector3();\n\t        return function ( camera, pos, r, w ) {\n\t            var LightState = this.LightState;\n\t            var minX = w, maxX = 0, minY = LightState.height, maxY = 0, hw = w / 2, hh = LightState.height / 2;\n\t            for ( var i = 0; i < 8; i ++ ) {\n\t                v.copy( pos );\n\t                v.x += i & 1 ? r : - r;\n\t                v.y += i & 2 ? r : - r;\n\t                v.z += i & 4 ? r : - r;\n\t                var vector = v.project( camera );\n\t                var x = ( vector.x * hw ) + hw;\n\t                var y = ( vector.y * hh ) + hh;\n\t                minX = Math.min( minX, x );\n\t                maxX = Math.max( maxX, x );\n\t                minY = Math.min( minY, y );\n\t                maxY = Math.max( maxY, y );\n\t            }\n\t            return [ minX, maxX, minY, maxY ];\n\t    };\n\t    }()\n\t});\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(4);\n\t__webpack_require__(5);\n\t__webpack_require__(6);\n\t__webpack_require__(8);\n\t__webpack_require__(10);\n\t__webpack_require__(11);\n\t__webpack_require__(12);\n\t__webpack_require__(13);\n\t__webpack_require__(16);\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t// Sobel and freichen shaders from three.js examples\n\n\tAFRAME.registerComponent(\"outline\", {\n\t\tmultiple: true,\n\n\t    schema: {\n\t\t\tenabled: { default: true },\n\t        color: { type: \"color\", default: \"#000000\" },\n\t\t\twidth: { type: \"vec2\", default: new THREE.Vector2(1,1) },\n\t\t\trange: { type: \"vec2\", default: new THREE.Vector2(0,1500) },\n\t\t\tstrength: {type: \"number\", default: 1},\n\t\t\tratio: { type: \"number\", default: 0.5 },\n\t\t\tsmooth: { default: false }  \n\t\t},\n\n\t    init: function () {\n\t        this.system = this.el.sceneEl.systems.effects;\n\t\t\tvar pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };\n\t        this.renderTarget = new THREE.WebGLRenderTarget( 1, 1, pars );\n\t\t\tthis.blurTarget = new THREE.WebGLRenderTarget( 1, 1, pars );\n\t\t\tthis.needsResize = true;\n\t\t\tthis.resolution = { type: \"v4\", value: new THREE.Vector4()};\n\t\t\tthis.tockUniforms = {\n\t\t\t\tresolution: this.resolution,\n\t            color: { type: \"c\", value: new THREE.Color() },\n\t\t\t\twidth: { type: \"v2\", value: null },\n\t\t\t\trange: { type: \"v2\", value: null },\n\t\t\t\tstrength: { type: \"f\", value: 1 }\n\t        };\n\t\t\t\n\t\t\tthis.blurDirection = { type: \"v2\", value: new THREE.Vector2()};\n\t\t\t\n\t\t\tthis.exports = {\n\t\t\t\tsobel: {\n\t\t\t\t\tfragment: this.sobel,\n\t\t\t\t\tuniforms: this.tockUniforms,\n\t\t\t\t\tincludes: [\"packing\"],\n\t\t\t\t\tdepth: true\n\t\t\t\t},\n\n\t\t\t\tblur: {\n\t\t\t\t\tfragment: this.blur,\n\t\t\t\t\tuniforms: { resolution: this.tockUniforms.resolution, direction: this.blurDirection },\n\t\t\t\t\tdiffuse: true\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.currentMaterial = this.system.fuse([this.exports.sobel], true);\n\n\t\t\t\n\t\t\tthis.blurMaterial = this.system.fuse([this.exports.blur], true);\n\n\t\t\tthis.uniforms = {\n\t\t\t\ttexture: { type: \"t\", value: this.renderTarget.texture }\n\t\t\t}\n\t\t\t\n\t\t\tthis.system.register(this);\n\t    },\n\n\t    update: function (oldData) {\n\t\t\tthis.bypass = !this.data.enabled;\n\t        this.tockUniforms.color.value.set(this.data.color);\n\t\t\tthis.tockUniforms.width.value = this.data.width;\n\t\t\tthis.tockUniforms.range.value = this.data.range;\n\t\t\tthis.tockUniforms.strength.value = 1 / this.data.strength;\n\t    },\n\n\t\tsetSize: function(w, h) {\n\t\t\tw = Math.round(w * this.data.ratio);\n\t\t\th = Math.round(h * this.data.ratio);\n\t\t\tthis.renderTarget.setSize(w,h);\n\t\t\tthis.blurTarget.setSize(w,h);\n\t\t\tthis.resolution.value.set(w, h, 1/w, 1/h);\n\t\t},\n\n\t\ttock: function () {\n\t\t\tif (!this.system.isActive(this, true)) return;\n\t\t\tthis.system.renderPass(this.currentMaterial, this.renderTarget);\n\t\t\tthis.system.tDiffuse.value = this.renderTarget;\n\t\t\tif (!this.data.smooth) return;\n\t\t\tthis.blurDirection.value.set(1,0);\n\t\t\tthis.system.renderPass(this.blurMaterial, this.blurTarget);\n\t\t\tthis.system.tDiffuse.value = this.blurTarget;\n\t\t\tthis.blurDirection.value.set(0,1);\n\t\t\tthis.system.renderPass(this.blurMaterial, this.renderTarget);\n\t\t},\n\n\t    remove: function () {\n\t        this.system.unregister(this);\n\t    },\n\n\t    diffuse: true,\n\n\t    sobel: [\n\t\t\t\"mat3 $G[2];\",\n\n\t\t\t\"const mat3 $g0 = mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\",\n\t\t\t\"const mat3 $g1 = mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\",\n\n\n\t\t\t\"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth) {\",\n\t\t\t\n\t\t\t\t\"vec3 I[3];\",\n\t\t\t\t\"float cnv[2];\",\n\t\t\t\t\"float d;\",\n\n\t\t\t\t\"$G[0] = $g0;\",\n\t\t\t\t\"$G[1] = $g1;\",\n\n\t\t\t\t\"for (float i=0.0; i<3.0; i++)\",\n\t\t\t\t\"for (float j=0.0; j<3.0; j++) {\",\n\t\t\t\"           d = texture2D(tDepth, uv + resolution.zw * vec2(i-1.0,j-1.0) ).x;\",\n\t        \"           d = perspectiveDepthToViewZ(d, cameraNear, cameraFar); \",\n\t\t\t\"\t\t\tI[int(i)][int(j)] = viewZToOrthographicDepth(d, cameraNear, cameraFar);\",\n\t\t\t\t\"}\",\n\n\t\t\t\t\"for (int i=0; i<2; i++) {\",\n\t\t\t\t\t\"float dp3 = dot($G[i][0], I[0]) + dot($G[i][1], I[1]) + dot($G[i][2], I[2]);\",\n\t\t\t\t\t\"cnv[i] = dp3 * dp3; \",\n\t\t\t\t\"}\",\n\t\t\t\t\"color = vec4($color, sqrt(cnv[0]*cnv[0]+cnv[1]*cnv[1]));\",\n\t\t\t\"} \"\n\t\t].join(\"\\n\"),\n\n\t\tblur: [\n\t\t\t\"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth){\",\n\t\t\t\"color.a *= 0.44198;\",\n\t\t\t\"color.a += texture2D(tDiffuse, uv + ($direction * $resolution.zw )).a * 0.27901;\",\n\t\t\t\"color.a += texture2D(tDiffuse, uv - ($direction * $resolution.zw )).a * 0.27901;\",\n\t\t\t\"}\"\n\t\t].join(\"\\n\"),\n\n\t\tfragment: [\n\t        \"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth){\",\n\t        \"\tvec4 texel = texture2D($texture, uv);\",\n\t\t\t\"   color.rgb = mix(color.rgb, texel.rgb, smoothstep(0.1,0.3,texel.a));\",\n\t        \"}\"\n\t    ].join(\"\\n\")\n\t});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n\t// Ported from the standard shader in Three.js examples\n\n\tAFRAME.registerComponent(\"film\", {\n\t    multiple: true,\n\n\t    schema: {\n\t        \"speed\":       { default: 1.0 },\n\t        \"nIntensity\": { default: 0.5 },\n\t        \"sIntensity\": { default: 0.05 },\n\t        \"sCount\":     { default: 4096 }\n\t\t},\n\n\t    init: function () {\n\t        this.uniforms = {\n\t            \"speed\":       { type: \"f\", value: 0.0 },\n\t            \"nIntensity\": { type: \"f\", value: 0.5 },\n\t            \"sIntensity\": { type: \"f\", value: 0.05 },\n\t            \"sCount\":     { type: \"f\", value: 4096 }\n\t\t    };\n\t        this.system = this.el.sceneEl.systems.effects;\n\t        this.system.register(this);\n\t    },\n\n\t    update: function () {\n\t        var d = this.data, us =  this.uniforms;\n\t        for(var u in us) {\n\t            if(d[u]) us[u].value = d[u]; \n\t        }\n\t    },\n\n\t    remove: function () {\n\t        this.system.unregister(this);\n\t    },\n\n\t    includes: [\"common\"],\n\n\t    diffuse: true,\n\n\t    fragment: [\n\t\t\t\"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth) {\",\n\t\t\t\"   vec4 cTextureScreen = color;\",\n\t\t\t\"   float dx = rand( uv + mod(time, 3.14) * $speed );\",\n\t\t\t\"   vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\",\n\t\t\t\"   vec2 sc = vec2( sin( uv.y * $sCount ), cos( uv.y * $sCount ) );\",\n\t\t\t\"   cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * $sIntensity;\",\n\t        \"   cResult = cTextureScreen.rgb + clamp( $nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\",\n\t\t\t\"   color.rgb =  cResult; //cResult;\",\n\t\t\t\"}\"\n\t\t].join( \"\\n\" )\n\t});\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// Uses matdesl's three-fxaa-shader\n\n\tvar FXAAShader = __webpack_require__(7);\n\n\tAFRAME.registerComponent(\"fxaa\", {\n\t    schema: { default: true },\n\n\t    init: function () {\n\t        this.system = this.el.sceneEl.systems.effects;\n\t        this.material = new THREE.ShaderMaterial({\n\t            fragmentShader: FXAAShader.fragmentShader,\n\t            vertexShader: FXAAShader.vertexShader,\n\t            uniforms: {\n\t                tDiffuse: this.system.tDiffuse,\n\t                resolution: { type: 'v2', value: new THREE.Vector2() }\n\t            }\n\t        });\n\t        this.system.register(this);\n\t        this.needsResize = true;\n\t    },\n\n\t    update: function () {\n\t        this.bypass = !this.data;\n\t    },\n\n\t    setSize: function (w, h) {\n\t        this.material.uniforms.resolution.value.set(w, h);\n\t    },\n\n\t    resize: true,\n\n\t    remove: function () {\n\t        this.material.dispose();\n\t        this.system.unregister(this);\n\t    }\n\t});\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\n\t\n\t// Adapted from https://github.com/mattdesl/three-shader-fxaa\n\tmodule.exports =  {\n\t  uniforms: {\n\t    tDiffuse: { type: 't', value: null },\n\t    resolution: { type: 'v2', value: new THREE.Vector2() }\n\t  },\n\t  vertexShader: \"#define GLSLIFY 1\\nvarying vec2 vUv;\\n\\nvarying vec2 v_rgbNW;\\nvarying vec2 v_rgbNE;\\nvarying vec2 v_rgbSW;\\nvarying vec2 v_rgbSE;\\nvarying vec2 v_rgbM;\\n\\nuniform vec2 resolution;\\n\\nvoid main() {\\n  vUv = uv;\\n  vec2 fragCoord = uv * resolution;\\n  vec2 inverseVP = 1.0 / resolution.xy;\\n  v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\\n  v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\\n  v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\\n  v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\\n  v_rgbM = vec2(fragCoord * inverseVP);\\n\\n  gl_Position = projectionMatrix *\\n              modelViewMatrix *\\n              vec4(position,1.0);\\n}\\n\",\n\t  fragmentShader: \"#define GLSLIFY 1\\nvarying vec2 vUv;\\n\\n//texcoords computed in vertex step\\n//to avoid dependent texture reads\\nvarying vec2 v_rgbNW;\\nvarying vec2 v_rgbNE;\\nvarying vec2 v_rgbSW;\\nvarying vec2 v_rgbSE;\\nvarying vec2 v_rgbM;\\n\\n//make sure to have a resolution uniform set to the screen size\\nuniform vec2 resolution;\\nuniform sampler2D tDiffuse;\\n\\n/**\\nBasic FXAA implementation based on the code on geeks3d.com with the\\nmodification that the texture2DLod stuff was removed since it's\\nunsupported by WebGL.\\n\\n--\\n\\nFrom:\\nhttps://github.com/mitsuhiko/webgl-meincraft\\n\\nCopyright (c) 2011 by Armin Ronacher.\\n\\nSome rights reserved.\\n\\nRedistribution and use in source and binary forms, with or without\\nmodification, are permitted provided that the following conditions are\\nmet:\\n\\n    * Redistributions of source code must retain the above copyright\\n      notice, this list of conditions and the following disclaimer.\\n\\n    * Redistributions in binary form must reproduce the above\\n      copyright notice, this list of conditions and the following\\n      disclaimer in the documentation and/or other materials provided\\n      with the distribution.\\n\\n    * The names of the contributors may not be used to endorse or\\n      promote products derived from this software without specific\\n      prior written permission.\\n\\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\\n\\\"AS IS\\\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n*/\\n\\n#ifndef FXAA_REDUCE_MIN\\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\\n#endif\\n#ifndef FXAA_REDUCE_MUL\\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\\n#endif\\n#ifndef FXAA_SPAN_MAX\\n    #define FXAA_SPAN_MAX     8.0\\n#endif\\n\\n//optimized version for mobile, where dependent \\n//texture reads can be a bottleneck\\nvec4 fxaa_1540259130(sampler2D tex, vec2 fragCoord, vec2 resolution,\\n            vec2 v_rgbNW, vec2 v_rgbNE, \\n            vec2 v_rgbSW, vec2 v_rgbSE, \\n            vec2 v_rgbM) {\\n    vec4 color;\\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\\n    vec4 texColor = texture2D(tex, v_rgbM);\\n    vec3 rgbM  = texColor.xyz;\\n    vec3 luma = vec3(0.299, 0.587, 0.114);\\n    float lumaNW = dot(rgbNW, luma);\\n    float lumaNE = dot(rgbNE, luma);\\n    float lumaSW = dot(rgbSW, luma);\\n    float lumaSE = dot(rgbSE, luma);\\n    float lumaM  = dot(rgbM,  luma);\\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\\n    \\n    mediump vec2 dir;\\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\\n    \\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\\n    \\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\\n              dir * rcpDirMin)) * inverseVP;\\n    \\n    vec3 rgbA = 0.5 * (\\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\\n\\n    float lumaB = dot(rgbB, luma);\\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\\n        color = vec4(rgbA, texColor.a);\\n    else\\n        color = vec4(rgbB, texColor.a);\\n    return color;\\n}\\n\\nvoid main() {\\n  vec2 fragCoord = vUv * resolution;   \\n  gl_FragColor = fxaa_1540259130(tDiffuse, fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\\n}\\n\"\n\t}\n\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// Adapted from spidersharma UnrealBloomPass\n\tvar LuminosityHighPassShader = __webpack_require__(9);\n\n\tvar BlurDirectionX = new THREE.Vector2( 1.0, 0.0 );\n\tvar BlurDirectionY = new THREE.Vector2( 0.0, 1.0 );\n\n\tAFRAME.registerComponent(\"bloom\", {\n\t\tmultiple: true,\n\n\t    schema: {\n\t\t\tenable: { default: true},\n\t        strength: { default: 1 },\n\t        radius: { default: 0.4 },\n\t        threshold: { default: 0.8 },\n\t\t\tfilter: { type: \"array\", default: [] }\n\t    },\n\n\t    init: function () {\n\t        this.system = this.el.sceneEl.systems.effects;\n\t        var pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };\n\t        this.renderTargetsHorizontal = [];\n\t        this.renderTargetsVertical = [];\n\t        this.nMips = 5;\n\t        \n\t        this.renderTargetBright = new THREE.WebGLRenderTarget( 1, 1, pars );\n\t        this.renderTargetBright.texture.name = \"UnrealBloomPass.bright\";\n\t        this.renderTargetBright.texture.generateMipmaps = false;\n\n\t        for( var i=0; i<this.nMips; i++) {\n\n\t            var renderTarget = new THREE.WebGLRenderTarget( 1, 1, pars );\n\n\t            renderTarget.texture.name = \"UnrealBloomPass.h\" + i;\n\t            renderTarget.texture.generateMipmaps = false;\n\n\t            this.renderTargetsHorizontal.push(renderTarget);\n\n\t            var renderTarget = new THREE.WebGLRenderTarget( 1, 1, pars );\n\n\t            renderTarget.texture.name = \"UnrealBloomPass.v\" + i;\n\t            renderTarget.texture.generateMipmaps = false;\n\n\t            this.renderTargetsVertical.push(renderTarget);\n\n\t        }\n\n\t        // luminosity high pass material, accessable as bloom.filter\n\n\t\t\tthis.exports = {\n\t\t\t\t\"filter\": {\n\t\t\t\t\tuniforms: {\n\t\t\t\t\t\t\"luminosityThreshold\": { type: \"f\", value: 1.0 },\n\t\t\t\t\t\t\"smoothWidth\": { type: \"f\", value: 0.01 },\n\t\t\t\t\t\t\"defaultColor\": { type: \"c\", value: new THREE.Color( 0x000000 ) },\n\t\t\t\t\t\t\"defaultOpacity\":  { type: \"f\", value: 1.0 }\n\t\t\t\t\t},\n\t\t\t\t\tdiffuse: true,\n\t\t\t\t\tfragment: [\n\t\t\t\t\t\t\"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth) {\",\n\t\t\t\t\t\t\t\"vec4 texel = color;\",\n\t\t\t\t\t\t\t\"float v = dot( texel.xyz, vec3( 0.299, 0.587, 0.114 ) );\",\n\t\t\t\t\t\t\t\"vec4 outputColor = vec4( $defaultColor.rgb, $defaultOpacity );\",\n\t\t\t\t\t\t\t\"float alpha = smoothstep( $luminosityThreshold, $luminosityThreshold + $smoothWidth, v );\",\n\t\t\t\t\t\t\t\"color = mix( outputColor, texel, alpha );\",\n\t\t\t\t\t\t\"}\"\n\t\t\t\t\t].join(\"\\n\")\n\t\t\t\t}\n\t\t\t}\n\n\t        this.materialHighPassFilter = null;\n\t        // Gaussian Blur Materials\n\t        this.separableBlurMaterials = [];\n\t        var kernelSizeArray = [3, 5, 7, 9, 11];\n\t        \n\t        for( var i=0; i<this.nMips; i++) {\n\n\t            this.separableBlurMaterials.push(this.getSeperableBlurMaterial(kernelSizeArray[i]));\n\n\t            this.separableBlurMaterials[i].uniforms[ \"texSize\" ].value = new THREE.Vector2(1, 1);\n\n\t        }\n\n\t        // Composite material\n\t        this.compositeMaterial = this.getCompositeMaterial(this.nMips);\n\t        this.compositeMaterial.uniforms[\"blurTexture1\"].value = this.renderTargetsVertical[0].texture;\n\t        this.compositeMaterial.uniforms[\"blurTexture2\"].value = this.renderTargetsVertical[1].texture;\n\t        this.compositeMaterial.uniforms[\"blurTexture3\"].value = this.renderTargetsVertical[2].texture;\n\t        this.compositeMaterial.uniforms[\"blurTexture4\"].value = this.renderTargetsVertical[3].texture;\n\t        this.compositeMaterial.uniforms[\"blurTexture5\"].value = this.renderTargetsVertical[4].texture;\n\t        this.compositeMaterial.needsUpdate = true;\n\n\t        var bloomFactors = [1.0, 0.8, 0.6, 0.4, 0.2];\n\t        this.compositeMaterial.uniforms[\"bloomFactors\"].value = bloomFactors;\n\t        this.bloomTintColors = [new THREE.Vector3(1,1,1), new THREE.Vector3(1,1,1), new THREE.Vector3(1,1,1)\n\t                                                    ,new THREE.Vector3(1,1,1), new THREE.Vector3(1,1,1)];\n\t        this.compositeMaterial.uniforms[\"bloomTintColors\"].value = this.bloomTintColors;\n\t\t\tthis.oldClearColor = new THREE.Color();\n\t        this.uniforms = {\n\t            \"texture\": { type: \"t\", value: this.renderTargetsHorizontal[0] }\n\t        }\n\t        this.needsResize = true;\n\t        this.system.register(this);\n\t    },\n\n\t\tupdate: function (oldData) {\n\t\t\tif (oldData.filter !== this.data.filter) {\n\t\t\t\tif (this.materialHighPassFilter) this.materialHighPassFilter.dispose();\n\t\t\t\tvar chain = this.data.filter.length ? this.data.filter : [this.exports.filter];\n\t\t\t\tthis.materialHighPassFilter = this.system.fuse(chain, false);\n\t\t\t}\n\t\t},\n\n\t    tock: function (time) {\n\t        if (!this.data.enable || !this.system.isActive(this, true)) return;\n\t\t\tvar scene = this.el.sceneEl;\n\t\t\tvar renderer = scene.renderer;\n\t        var readBuffer = scene.renderTarget;\n\t        this.oldClearColor.copy( renderer.getClearColor() );\n\t\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\t\tvar oldAutoClear = renderer.autoClear;\n\t\t\trenderer.autoClear = false;\n\n\t\t\trenderer.setClearColor( new THREE.Color( 0, 0, 0 ), 0 );\n\n\t\t\t// 1. Extract Bright Areas\n\t\t\tthis.system.tDiffuse.value = readBuffer.texture;\n\t\t\tthis.exports.filter.uniforms[ \"luminosityThreshold\" ].value = this.data.threshold;\n\t\t\tthis.system.renderPass(this.materialHighPassFilter, this.renderTargetBright, null, false);\n\n\t\t\t// 2. Blur All the mips progressively\n\t\t\tvar inputRenderTarget = this.renderTargetBright;\n\n\t\t\tfor(var i=0; i<this.nMips; i++) {\n\t\t\n\t\t\t\tthis.separableBlurMaterials[i].uniforms[ \"colorTexture\" ].value = inputRenderTarget.texture;\n\n\t\t\t\tthis.separableBlurMaterials[i].uniforms[ \"direction\" ].value = BlurDirectionX;\n\n\t            this.system.renderPass(this.separableBlurMaterials[i], this.renderTargetsHorizontal[i], true);\n\n\t\t\t\tthis.separableBlurMaterials[i].uniforms[ \"colorTexture\" ].value = this.renderTargetsHorizontal[i].texture;\n\n\t\t\t\tthis.separableBlurMaterials[i].uniforms[ \"direction\" ].value = BlurDirectionY;\n\n\t\t\t\tthis.system.renderPass(this.separableBlurMaterials[i], this.renderTargetsVertical[i], true);\n\n\t\t\t\tinputRenderTarget = this.renderTargetsVertical[i];\n\t\t\t}\n\n\t\t\t// Composite All the mips\n\t\t\tthis.compositeMaterial.uniforms[\"bloomStrength\"].value = this.data.strength;\n\t\t\tthis.compositeMaterial.uniforms[\"bloomRadius\"].value = this.data.radius;\n\t\t\tthis.compositeMaterial.uniforms[\"bloomTintColors\"].value = this.bloomTintColors;\n\t        this.system.renderPass(this.compositeMaterial, this.renderTargetsHorizontal[0], null);\n\n\t\t\trenderer.setClearColor( this.oldClearColor, this.oldClearAlpha );\n\t\t\trenderer.autoClear = oldAutoClear;\n\t\t},\n\n\t    setSize: function ( width, height ) {\n\n\t\t\tvar resx = Math.round(width/2);\n\t\t\tvar resy = Math.round(height/2);\n\n\t\t\tthis.renderTargetBright.setSize(resx, resy);\n\n\t\t\tfor( var i=0; i<this.nMips; i++) {\n\n\t\t\t\tthis.renderTargetsHorizontal[i].setSize(resx, resy);\n\t\t\t\tthis.renderTargetsVertical[i].setSize(resx, resy);\n\n\t\t\t\tthis.separableBlurMaterials[i].uniforms[ \"texSize\" ].value = new THREE.Vector2(resx, resy);\n\n\t\t\t\tresx = Math.round(resx/2);\n\t\t\t\tresy = Math.round(resy/2);\n\t\t\t}\n\t\t},\n\n\t    remove: function () {\n\t        this.system.unregister(this);\n\t        for( var i=0; i< this.renderTargetsHorizontal.length; i++) {\n\t\t\t\tthis.renderTargetsHorizontal[i].dispose();\n\t\t\t}\n\t\t\tfor( var i=0; i< this.renderTargetsVertical.length; i++) {\n\t\t\t\tthis.renderTargetsVertical[i].dispose();\n\t\t\t}\n\t\t\tthis.renderTargetBright.dispose();\n\t    },\n\n\t    getSeperableBlurMaterial: function(kernelRadius) {\n\n\t\t\treturn this.system.materialize( {\n\n\t\t\t\tdefines: {\n\t\t\t\t\t\"KERNEL_RADIUS\" : kernelRadius,\n\t\t\t\t\t\"SIGMA\" : kernelRadius\n\t\t\t\t},\n\n\t\t\t\tuniforms: {\n\t\t\t\t\t\"colorTexture\": { value: null },\n\t\t\t\t\t\"texSize\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) },\n\t\t\t\t\t\"direction\": \t\t\t\t{ value: new THREE.Vector2( 0.5, 0.5 ) }\n\t\t\t\t},\n\n\t\t\t\tvertexShader:\n\t\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t\t}\",\n\n\t\t\t\tfragmentShader:\n\t\t\t\t\t\"#include <common>\\\n\t\t\t\t\tvarying vec2 vUv;\\n\\\n\t\t\t\t\tuniform sampler2D colorTexture;\\n\\\n\t\t\t\t\tuniform vec2 texSize;\\\n\t\t\t\t\tuniform vec2 direction;\\\n\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\\\n\t\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\\\n\t\t\t\t\t}\\\n\t\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\t\tvec2 invSize = 1.0 / texSize;\\\n\t\t\t\t\t\tfloat fSigma = float(SIGMA);\\\n\t\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\\\n\t\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\\\n\t\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\\\n\t\t\t\t\t\t\tfloat x = float(i);\\\n\t\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\\\n\t\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\\\n\t\t\t\t\t\t\tvec3 sample1 = textureVR( colorTexture, vUv + uvOffset).rgb;\\\n\t\t\t\t\t\t\tvec3 sample2 = textureVR( colorTexture, vUv - uvOffset).rgb;\\\n\t\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\\\n\t\t\t\t\t\t\tweightSum += 2.0 * w;\\\n\t\t\t\t\t\t}\\\n\t\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\\n\\\n\t\t\t\t\t}\"\n\t\t\t} );\n\t\t},\n\n\t\tgetCompositeMaterial: function(nMips) {\n\n\t\t\treturn new THREE.ShaderMaterial( {\n\n\t\t\t\tdefines:{\n\t\t\t\t\t\"NUM_MIPS\" : nMips\n\t\t\t\t},\n\n\t\t\t\tuniforms: {\n\t\t\t\t\t\"blurTexture1\": { value: null },\n\t\t\t\t\t\"blurTexture2\": { value: null },\n\t\t\t\t\t\"blurTexture3\": { value: null },\n\t\t\t\t\t\"blurTexture4\": { value: null },\n\t\t\t\t\t\"blurTexture5\": { value: null },\n\t\t\t\t\t\"bloomStrength\" : { value: 1.0 },\n\t\t\t\t\t\"bloomFactors\" : { value: null },\n\t\t\t\t\t\"bloomTintColors\" : { value: null },\n\t\t\t\t\t\"bloomRadius\" : { value: 0.0 }\n\t\t\t\t},\n\n\t\t\t\tvertexShader:\n\t\t\t\t\t\"varying vec2 vUv;\\n\\\n\t\t\t\t\tvoid main() {\\n\\\n\t\t\t\t\t\tvUv = uv;\\n\\\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n\\\n\t\t\t\t\t}\",\n\n\t\t\t\tfragmentShader:\n\t\t\t\t\t\"varying vec2 vUv;\\\n\t\t\t\t\tuniform sampler2D blurTexture1;\\\n\t\t\t\t\tuniform sampler2D blurTexture2;\\\n\t\t\t\t\tuniform sampler2D blurTexture3;\\\n\t\t\t\t\tuniform sampler2D blurTexture4;\\\n\t\t\t\t\tuniform sampler2D blurTexture5;\\\n\t\t\t\t\tuniform float bloomStrength;\\\n\t\t\t\t\tuniform float bloomRadius;\\\n\t\t\t\t\tuniform float bloomFactors[NUM_MIPS];\\\n\t\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\\\n\t\t\t\t\t\\\n\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \\\n\t\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\\\n\t\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\\\n\t\t\t\t\t}\\\n\t\t\t\t\t\\\n\t\t\t\t\tvoid main() {\\\n\t\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \\\n\t\t\t\t\t\t \t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \\\n\t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \\\n\t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \\\n\t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\\\n\t\t\t\t\t}\"\n\t\t\t} );\n\t\t},\n\n\t\tdiffuse: true,\n\t\tdefaults: [\"1.0\"],\n\t    fragment: [\n\t        \"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth){\",\n\t        \"   color.rgb += texture2D($texture, uv).rgb;\",\n\t        \"}\"\n\t    ].join(\"\\n\")\n\t});\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\n\t/**\n\t * @author bhouston / http://clara.io/\n\t *\n\t * Luminosity\n\t * http://en.wikipedia.org/wiki/Luminosity\n\t */\n\n\tmodule.exports = {\n\n\t  shaderID: \"luminosityHighPass\",\n\n\t\tuniforms: {\n\n\t\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\t\"luminosityThreshold\": { type: \"f\", value: 1.0 },\n\t\t\t\"smoothWidth\": { type: \"f\", value: 1.0 },\n\t\t\t\"defaultColor\": { type: \"c\", value: new THREE.Color( 0x000000 ) },\n\t\t\t\"defaultOpacity\":  { type: \"f\", value: 0.0 }\n\n\t\t},\n\n\t\tvertexShader: [\n\n\t\t\t\"varying vec2 vUv;\",\n\n\t\t\t\"void main() {\",\n\n\t\t\t\t\"vUv = uv;\",\n\n\t\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\t\"}\"\n\n\t\t].join(\"\\n\"),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\t\"uniform vec3 defaultColor;\",\n\t\t\t\"uniform float defaultOpacity;\",\n\t\t\t\"uniform float luminosityThreshold;\",\n\t\t\t\"uniform float smoothWidth;\",\n\n\t\t\t\"varying vec2 vUv;\",\n\n\t\t\t\"void main() {\",\n\n\t\t\t\t\"vec4 texel = texture2D( tDiffuse, vUv );\",\n\n\t\t\t\t\"vec3 luma = vec3( 0.299, 0.587, 0.114 );\",\n\n\t\t\t\t\"float v = dot( texel.xyz, luma );\",\n\n\t\t\t\t\"vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\",\n\n\t\t\t\t\"float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\",\n\n\t\t\t\t\"gl_FragColor = mix( outputColor, texel, alpha );\",\n\n\t\t\t\"}\"\n\n\t\t].join(\"\\n\")\n\n\t};\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports) {\n\n\tAFRAME.registerComponent(\"colors\", {\n\t    multiple: true,\n\n\t    schema: {\n\t        \"mode\": { default: \"map\" },\n\t        \"lut\": { type: \"selector\"},\n\t        \"lutClamp\": { default: false },\n\t        \"lutFlip\": { default: false },\n\t        \"add\": { type: \"vec3\", default: new THREE.Vector3(0,0,0) },\n\t        \"mul\": { type: \"vec3\", default: new THREE.Vector3(1,1,1) },\n\t        \"pow\": { type: \"vec3\", default: new THREE.Vector3(1,1,1) },\n\t        \"left\": { type: \"vec3\", default: new THREE.Vector3(0,0,0) },\n\t        \"right\": { type: \"vec3\", default: new THREE.Vector3(1,1,1) },\n\t        \"min\": { type: \"vec3\", default: new THREE.Vector3(0,0,0) },\n\t        \"max\": { type: \"vec3\", default: new THREE.Vector3(1,1,1) },\n\t        \"quant\": { type: \"vec3\", default: new THREE.Vector3(0.2,0.2,0.2) },\n\t        \"orig\": { type: \"vec3\", default: new THREE.Vector3(1,1,1) },\n\t        \"red\": { type: \"vec3\", default: new THREE.Vector3(1,0,0) },\n\t        \"green\": { type: \"vec3\", default: new THREE.Vector3(0,0.5,0.5) },\n\t        \"blue\": { type: \"vec3\", default: new THREE.Vector3(0,0.5,0.5) },\n\t    },\n\n\t    init: function () {\n\t        this.system = this.el.sceneEl.systems.effects;\n\t        this.uniforms = {\n\t            \"add\": { type: \"v3\", value: null },\n\t            \"mul\": { type: \"v3\", value: null },\n\t            \"pow\": { type: \"v3\", value: null },\n\t            \"left\": { type: \"v3\", value: null },\n\t            \"right\": { type: \"v3\", value: null },\n\t            \"min\": { type: \"v3\", value: null },\n\t            \"max\": { type: \"v3\", value: null },\n\t            \"quant\": { type: \"v3\", value: null },\n\t            \"orig\": { type: \"v3\", value: null },\n\t            \"red\": { type: \"v3\", value: null },\n\t            \"green\": { type: \"v3\", value: null },\n\t            \"blue\": { type: \"v3\", value: null },\n\t            \"texture\": { \n\t                type: \"t\", \n\t                value: new THREE.Texture(\n\t                    undefined, // Default Image\n\t                    undefined, // Default Mapping\n\t                    undefined, // Default wrapS\n\t                    undefined, // Default wrapT\n\t                    THREE.NearestFilter, // magFilter\n\t                    THREE.NearestFilter  // minFilter\n\t                )}\n\t        }\n\t        \n\t        this.rebuild();\n\t    \n\t        this.system.register(this);\n\t    },\n\n\t    update: function (oldData) {\n\t        var d = this.data, us =  this.uniforms, needsRebuild = false;\n\t        \n\t        for(var u in us) {\n\t            if(d[u] !== undefined) us[u].value = d[u]; \n\t        }\n\t        []\n\t        if(this.data.lutFlip !== oldData.lutFlip || this.data.lutClamp !== oldData.lutClamp || this.data.mode != oldData.mode) {\n\t            this.rebuild();\n\t        }\n\n\t        if(this.data.lut !== oldData.lut) {\n\t            const texture = this.uniforms.texture.value;\n\t            texture.image = this.data.lut;\n\t            texture.needsUpdate = true;\n\t        }\n\t    },\n\n\t    remove: function () {\n\t        this.system.unregister(this);\n\t    },\n\n\t    rebuild: function () {\n\t        var arr = [], m = this.data.mode;\n\t        for(var i=0; i < m.length; i++){\n\t            var op = this.ops[m[i]];\n\t            if(op) arr.push(op);\n\t        }\n\t        \n\t        this.fragment = [\n\t            this.data.lutClamp ? \"\" : \"#define $LUT_NO_CLAMP 1\",\n\t            this.data.lutFlip ? \"#define $LUT_FLIP_Y 1\" : \"\",\n\t            this.preFragment, \n\t            arr.join(\"\\n\"), \n\t            \"}\"\n\t        ].join(\"\\n\");\n\n\t        this.system.needsUpdate = true;\n\t    },\n\n\t    ops: {\n\t        \"m\": \"color.rgb *= $mul;\",\n\t        \"a\": \"color.rgb += $add;\",\n\t        \"p\": \"color.rgb = pow(color.rgb, $pow);\",\n\t        \"h\": \"color.rgb = $rgb2hsv(color.rgb);\",\n\t        \"r\": \"color.rgb = $hsv2rgb(color.rgb);\",\n\t        \"s\": \"color.rgb = smoothstep($left, $right, color.rgb);\",\n\t        \"l\": \"color.rgb = $lut(color).rgb;\",\n\t        \"q\": \"color.rgb = floor(color.rgb / $quant) * $quant;\",\n\t        \"c\": \"color.rgb = clamp(color.rgb, $min, $max);\",\n\t        \"g\": \"color.rgb = vec3(dot(color.rgb, vec3(0.299, 0.587, 0.114)));\",\n\t        \"o\": \"color.rgb = mix(color.rgb, orig.rgb, $orig);\",\n\t        \"t\": \"color.rgb = vec3(dot(color.rgb, $red), dot(color.rgb, $green), dot(color.rgb, $blue));\",\n\t        \"b\": \"color.rgb = color.rgb;\"\n\t    },\n\n\t    diffuse: true,\n\n\t    preFragment: [\n\t        // Lut from https://github.com/mattdesl/glsl-lut\n\t        \"vec4 $lut(vec4 textureColor) {\",\n\t        \"    #ifndef $LUT_NO_CLAMP\",\n\t        \"        textureColor = clamp(textureColor, 0.0, 1.0);\",\n\t        \"    #endif\",\n\n\t        \"    mediump float blueColor = textureColor.b * 63.0;\",\n\n\t        \"    mediump vec2 quad1;\",\n\t        \"    quad1.y = floor(floor(blueColor) / 8.0);\",\n\t        \"    quad1.x = floor(blueColor) - (quad1.y * 8.0);\",\n\n\t        \"    mediump vec2 quad2;\",\n\t        \"    quad2.y = floor(ceil(blueColor) / 8.0);\",\n\t        \"    quad2.x = ceil(blueColor) - (quad2.y * 8.0);\",\n\n\t        \"    highp vec2 texPos1;\",\n\t        \"    texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\",\n\t        \"    texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g);\",\n\n\t        \"    #ifdef $LUT_FLIP_Y\",\n\t        \"        texPos1.y = 1.0-texPos1.y;\",\n\t        \"    #endif\",\n\n\t        \"    highp vec2 texPos2;\",\n\t        \"    texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\",\n\t        \"    texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g);\",\n\n\t        \"    #ifdef $LUT_FLIP_Y\",\n\t        \"        texPos2.y = 1.0-texPos2.y;\",\n\t        \"    #endif\",\n\n\t        \"    lowp vec4 newColor1 = texture2D($texture, texPos1);\",\n\t        \"    lowp vec4 newColor2 = texture2D($texture, texPos2);\",\n\n\t        \"    lowp vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\",\n\t        \"    return newColor;\",\n\t        \"}\",\n\n\t        \"vec3 $rgb2hsv(vec3 c){\",\n\t        \n\t        \"    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\",\n\t        \"    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\",\n\t        \"    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\",\n\n\t        \"    float d = q.x - min(q.w, q.y);\",\n\t        \"    float e = 1.0e-10;\",\n\t        \"    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\",\n\t        \"}\",\n\n\t        \"vec3 $hsv2rgb(vec3 c)\",\n\t        \"{\",\n\t        \"    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\",\n\t        \"    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\",\n\t        \"    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\",\n\t        \"}\",\n\n\t        \"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth){\",\n\t        \"vec3 orig = color.rgb;\",\n\t    ].join(\"\\n\")\n\t});\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n\t// Ported from three's glitch pass/shader and added VR support\n\n\tAFRAME.registerComponent(\"glitch\", {\n\t    schema: { default: true },\n\n\t    init: function () {\n\t        this.system = this.el.sceneEl.systems.effects;\n\n\t        this.uniforms = {\n\t            \"tDisp\":\t\t{ type: \"t\", value: this.generateHeightmap( 64 ) },\n\t            \"amount\":\t\t{ type: \"f\", value: 0.08 },\n\t            \"angle\":\t\t{ type: \"f\", value: 0.02 },\n\t            \"seed\":\t\t\t{ type: \"f\", value: 0.02 },\n\t            \"seed_x\":\t\t{ type: \"f\", value: 0.02 },//-1,1\n\t            \"seed_y\":\t\t{ type: \"f\", value: 0.02 },//-1,1\n\t            \"distortion_x\":\t{ type: \"f\", value: 0.5 },\n\t            \"distortion_y\":\t{ type: \"f\", value: 0.6 },\n\t            \"col_s\":\t\t{ type: \"f\", value: 0.05 }\n\t\t    };\n\t        \n\t\t\tthis.exports = {\n\t\t\t\tglitch: {\n\t                fragment: this.fragment,\n\t                uniforms: this.uniforms\n\t            }\n\t\t\t}\n\t        // by declaring a .material property we set this component to take a whole pass of it's own\n\t        this.material = this.system.fuse([this.exports.glitch]);\n\n\t        this.system.register(this);\n\t    },\n\n\t    vr: true,\n\n\t    update: function () {\n\t        this.bypass = !this.data;\n\t        this.curF = 0;\n\t        this.generateTrigger();\n\t    },\n\n\t    remove: function () {\n\t        this.system.unregister(this);\n\t    },\n\n\t    tock: function () {\n\t        this.uniforms[ 'seed' ].value = Math.random();//default seeding\n\t\t\t\n\t\t\tif ( this.curF % this.randX == 0) {\n\n\t\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 30;\n\t\t\t\tthis.uniforms[ 'angle' ].value = THREE.Math.randFloat( - Math.PI, Math.PI );\n\t\t\t\tthis.uniforms[ 'seed_x' ].value = THREE.Math.randFloat( - 1, 1 );\n\t\t\t\tthis.uniforms[ 'seed_y' ].value = THREE.Math.randFloat( - 1, 1 );\n\t\t\t\tthis.uniforms[ 'distortion_x' ].value = THREE.Math.randFloat( 0, 1 );\n\t\t\t\tthis.uniforms[ 'distortion_y' ].value = THREE.Math.randFloat( 0, 1 );\n\t\t\t\tthis.curF = 0;\n\t\t\t\tthis.generateTrigger();\n\n\t\t\t} else if ( this.curF % this.randX < this.randX / 5 ) {\n\n\t\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 90;\n\t\t\t\tthis.uniforms[ 'angle' ].value = THREE.Math.randFloat( - Math.PI, Math.PI );\n\t\t\t\tthis.uniforms[ 'distortion_x' ].value = THREE.Math.randFloat( 0, 1 );\n\t\t\t\tthis.uniforms[ 'distortion_y' ].value = THREE.Math.randFloat( 0, 1 );\n\t\t\t\tthis.uniforms[ 'seed_x' ].value = THREE.Math.randFloat( - 0.3, 0.3 );\n\t\t\t\tthis.uniforms[ 'seed_y' ].value = THREE.Math.randFloat( - 0.3, 0.3 );\n\n\t\t\t} \n\n\t\t\tthis.curF ++;\n\t    },\n\n\t    generateTrigger: function() {\n\n\t\t\tthis.randX = THREE.Math.randInt( 120, 240 );\n\n\t\t},\n\n\t\tgenerateHeightmap: function( dt_size ) {\n\n\t\t\tvar data_arr = new Float32Array( dt_size * dt_size * 3 );\n\t\t\tvar length = dt_size * dt_size;\n\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\n\n\t\t\t\tvar val = THREE.Math.randFloat( 0, 1 );\n\t\t\t\tdata_arr[ i * 3 + 0 ] = val;\n\t\t\t\tdata_arr[ i * 3 + 1 ] = val;\n\t\t\t\tdata_arr[ i * 3 + 2 ] = val;\n\n\t\t\t}\n\n\t\t\tvar texture = new THREE.DataTexture( data_arr, dt_size, dt_size, THREE.RGBFormat, THREE.FloatType );\n\t\t\ttexture.needsUpdate = true;\n\t\t\treturn texture;\n\n\t\t},\n\n\t    fragment: [\n\t\t\t\"float $rand(vec2 co){\",\n\t\t\t\t\"return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\",\n\t\t\t\"}\",\n\t\t\t\t\t\n\t\t\t\"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth) {\",\n\t\t\t\t\t\"vec2 p = uv;\",\n\t                \"vec2 p2 = vec2( smoothstep(uvClamp.x, uvClamp.y, p.x),p.y);\",\n\t\t\t\t\t\"float xs = floor(gl_FragCoord.x / 0.5);\",\n\t\t\t\t\t\"float ys = floor(gl_FragCoord.y / 0.5);\",\n\t\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\t\t\"vec4 normal = texture2D ($tDisp, p2 * $seed * $seed);\",\n\t\t\t\t\t\"if(p2.y < $distortion_x + $col_s && p2.y > $distortion_x - $col_s * $seed) {\",\n\t\t\t\t\t\t\"if($seed_x>0.){\",\n\t\t\t\t\t\t\t\"p.y = 1. - (p.y + $distortion_y);\",\n\t\t\t\t\t\t\"}\",\n\t\t\t\t\t\t\"else {\",\n\t\t\t\t\t\t\t\"p.y = $distortion_y;\",\n\t\t\t\t\t\t\"}\",\n\t\t\t\t\t\"}\",\n\t\t\t\t\t\"if(p2.x < $distortion_y + $col_s && p2.x > $distortion_y - $col_s * $seed) {\",\n\t\t\t\t\t\t\"if( $seed_y > 0.){\",\n\t\t\t\t\t\t\t\"p.x = $distortion_x;\",\n\t\t\t\t\t\t\"}\",\n\t\t\t\t\t\t\"else {\",\n\t\t\t\t\t\t\t\"p.x = 1. - (p.x + $distortion_x);\",\n\t\t\t\t\t\t\"}\",\n\t\t\t\t\t\"}\",\n\t\t\t\t\t\"p.x+=normal.x* $seed_x * ($seed/5.);\",\n\t\t\t\t\t\"p.y+=normal.y* $seed_y * ($seed/5.);\",\n\t\t\t\t\t//base from RGB shift shader\n\t\t\t\t\t\"vec2 offset = $amount * vec2( cos($angle), sin($angle));\",\n\t\t\t\t\t\"vec4 cr = textureVR(tDiffuse, p + offset);\",\n\t\t\t\t\t\"vec4 cga = textureVR(tDiffuse, p);\",\n\t\t\t\t\t\"vec4 cb = textureVR(tDiffuse, p - offset);\",\n\t\t\t\t\t\"color = vec4(cr.r, cga.g, cb.b, cga.a);\",\n\t\t\t\t\t//add noise\n\t\t\t\t\t\"vec4 snow = 200.*$amount*vec4($rand(vec2(xs * $seed,ys * $seed*50.))*0.2);\",\n\t\t\t\t\t\"color = color+ snow;\",\n\t\t\t\"}\"\n\t\t].join( \"\\n\" )\n\t});\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\n\t// Ported from the shader in Three.js examples\n\t// with the addition of a separate input pass\n\n\tAFRAME.registerComponent(\"godrays\", {\n\t    schema: {\n\t        \"tint\": { type: \"color\", default: \"#FFFFFF\" },\n\t        \"threshold\": { type: \"vec4\", default: new THREE.Vector4(0,1,1) },\n\t        \"src\": { type: \"selector\", default: null },\n\t        \"intensity\": { default: 1 },\n\t        \"filter\": { type: \"array\", default: [] },\n\t        \"ratio\": { default: 0.25 }\n\t\t},\n\n\t    init: function () {\n\t        this.system = this.el.sceneEl.systems.effects;\n\t        var pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };\n\t\t\tthis.rtFilter = new THREE.WebGLRenderTarget( 1, 1, pars );\n\t        this.rtTextureGodRays1 = new THREE.WebGLRenderTarget( 1, 1, pars );\n\t\t\tthis.rtTextureGodRays2 = new THREE.WebGLRenderTarget( 1, 1, pars );\n\t        \n\t        this.exports = {\n\t            filter: {\n\t                includes: [\"packing\"],\n\t                uniforms: {\n\t                    \"tint\": { type: \"c\", value: new THREE.Color() },\n\t                    \"threshold\": { type: \"v2\", value: new THREE.Vector2(0,1) },\n\t                },\n\t                depth: true, \n\t                fragment: [\n\t                    \"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth) {\",\n\t                    \"   float v = viewZToOrthographicDepth(perspectiveDepthToViewZ(depth, cameraNear, cameraFar), cameraNear, cameraFar);\",\n\t                    \"   color.rgb = vec3(smoothstep($threshold.x, $threshold.y, v)) * $tint;\",\n\t                    \"}\"\n\t                ].join( \"\\n\" ),\n\t            },\n\t            blur: {\n\t                uniforms: {\n\t                    step: { type:\"f\", value: 1.0 },\n\t                    src: { type: \"v3\", value: new THREE.Vector3( 0.5, 0.5, 0. ) }\n\t                },\n\t                fragment: [\n\t                    \"void $main(inout vec4 color, vec4 orig, vec2 uv, float depth) {\",\n\t                        \"vec2 center = vec2(mix(uvClamp.x, uvClamp.y, $src.x), $src.y);\",\n\t                        \"vec2 delta = center - uv;\",\n\t                        \"float dist = length( delta );\",\n\t                        \"vec2 stepv = $step * delta / dist;\",\n\t                        \"float iters = dist/$step;\",\n\t                        \"vec4 col = vec4(0.0);\",\n\t                        \"if ( 0.0 <= iters && uv.y < 1.0 ) col += textureVR( tDiffuse, uv );\",\n\t                        \"uv += stepv;\",\n\t                        \"if ( 1.0 <= iters && uv.y < 1.0 ) col += textureVR( tDiffuse, uv );\",\n\t                        \"uv += stepv;\",\n\t                        \"if ( 2.0 <= iters && uv.y < 1.0 ) col += textureVR( tDiffuse, uv );\",\n\t                        \"uv += stepv;\",\n\t                        \"if ( 3.0 <= iters && uv.y < 1.0 ) col += textureVR( tDiffuse, uv );\",\n\t                        \"uv += stepv;\",\n\t                        \"if ( 4.0 <= iters && uv.y < 1.0 ) col += textureVR( tDiffuse, uv );\",\n\t                        \"uv += stepv;\",\n\t                        \"if ( 5.0 <= iters && uv.y < 1.0 ) col += textureVR( tDiffuse, uv );\",\n\t                        \"color = col/6.0;\",\n\t                    \"}\"\n\n\t                ].join( \"\\n\" )\n\t            }\n\t        }\n\t        \n\t        this.materialGodraysGenerate = this.system.fuse([this.exports.blur]);\n\t        this.uniforms = {\n\t            \"intensity\": { type: \"f\", value: 1 },\n\t            \"attenuation\": {type: \"f\", value: 1 },\n\t            \"texture\": { type: \"t\", value: this.rtTextureGodRays2 }\n\t\t    };\n\n\t        this.materialFilter = null;\n\t        \n\t        this.needsResize = true;\n\t        this.system.register(this);\n\t    },\n\n\t    setSize: function (w,h) {\n\t       w = Math.round(w * this.data.ratio);\n\t       h = Math.round(h * this.data.ratio);\n\t       this.rtTextureGodRays1.setSize(w,h);\n\t       this.rtTextureGodRays2.setSize(w,h);\n\t       this.rtFilter.setSize(w,h);\n\t    },\n\n\t    update: function (oldData) {\n\t        this.exports.filter.uniforms.tint.value.set(this.data.tint);\n\t        this.uniforms.intensity.value = this.data.intensity;\n\t        if(this.data.filter !== oldData.filter) {\n\t            if(this.materialFilter) this.materialFilter.dispose();\n\t            this.materialFilter = this.system.fuse(this.data.filter.length ? this.data.filter : [this.exports.filter]);\n\t        }\n\t        this.bypass = this.data.src === null;\n\t    },\n\n\t    tock: function () {\n\t        if (!this.system.isActive(this, true)) return;\n\t        var self = this;\n\t        \n\t        this.system.tDiffuse.value = this.system.renderTarget.texture;\n\t        this.system.renderPass(this.materialFilter, this.rtFilter, fn )\n\n\t        var fn = function (material, camera, eye) {\n\t            var cp3 = new THREE.Vector3(), cd3 = new THREE.Vector3();\n\t            var v3 = self.exports.blur.uniforms[ \"src\" ].value;\n\t            self.data.src.object3D.getWorldPosition(v3);\n\t            camera.getWorldPosition(cp3);\n\t            camera.getWorldDirection(cd3);\n\t            cp3.sub(v3);\n\t            cp3.normalize();\n\t            cd3.normalize();\n\t            self.uniforms.attenuation.value = Math.pow(Math.max(0, -cd3.dot(cp3)), 1.33);\n\t            \n\t            v3.project( camera );\n\t            v3.set((v3.x + 1 ) / 2, (v3.y + 1 ) / 2, 0);\n\t            \n\t        };\n\n\t        var filterLen = 1.0;\n\t\t\tvar TAPS_PER_PASS = 6.0;\n\t        \n\t        var pass = 1.0;\n\t        var stepLen = filterLen * Math.pow( TAPS_PER_PASS, -pass );\n\t        this.exports.blur.uniforms[ \"step\" ].value = stepLen;\n\t        this.system[ \"tDiffuse\" ].value = this.rtFilter.texture;\n\t        this.system.renderPass(this.materialGodraysGenerate, this.rtTextureGodRays2, fn )\n\t        \n\t        pass = 2.0;\n\t        stepLen = filterLen * Math.pow( TAPS_PER_PASS, -pass );\n\t        this.exports.blur.uniforms[ \"step\" ].value = stepLen;\n\t        this.system[ \"tDiffuse\" ].value = this.rtTextureGodRays2.texture;\n\t        this.system.renderPass(this.materialGodraysGenerate, this.rtTextureGodRays1, fn );\n\t        \n\t        pass = 3.0;\n\t        stepLen = filterLen * Math.pow( TAPS_PER_PASS, -pass );\n\t        this.exports.blur.uniforms[ \"step\" ].value = stepLen;\n\t        this.system[ \"tDiffuse\" ].value = this.rtTextureGodRays1.texture;\n\t        this.system.renderPass(this.materialGodraysGenerate, this.rtTextureGodRays2, fn )\n\t    },\n\n\t    remove: function () {\n\t        this.rtTextureGodRays1.dispose();\n\t        this.rtTextureGodRays2.dispose();\n\t        this.rtFilter.dispose();\n\n\t        this.materialGodraysGenerate.dispose();\n\t        this.materialFilter.dispose();\n\t        this.system.unregister(this);\n\t    },\n\n\t    diffuse: true,\n\n\t    fragment: [\n\t        \"float $blendScreen(float base, float blend) {\",\n\t        \"    return 1.0-((1.0-base)*(1.0-blend));\",\n\t        \"}\",\n\n\t        \"vec3 $blendScreen(vec3 base, vec3 blend) {\",\n\t        \"    return vec3($blendScreen(base.r,blend.r),$blendScreen(base.g,blend.g),$blendScreen(base.b,blend.b));\",\n\t        \"}\",\n\n\t        \"vec3 $blendScreen(vec3 base, vec3 blend, float opacity) {\",\n\t\t    \"    return ($blendScreen(base, blend) * opacity + base * (1.0 - opacity));\",\n\t        \"}\",\n\n\t\t\t\"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth) {\",\n\t\t\t\"   vec4 texel = texture2D($texture, uv);\",\n\t        \"   color.rgb = $blendScreen( color.rgb, texel.rgb, $intensity * $attenuation);\",\n\t        \"}\"\n\t\t].join( \"\\n\" )\n\t});\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar SAOShader = __webpack_require__(14);\n\tvar DepthLimitedBlurShader = __webpack_require__(15);\n\n\tAFRAME.registerComponent(\"ssao\", {\n\t    schema: {\n\t        \"samples\": { type: \"number\", default: 16},\n\t        \"rings\": { type: \"number\", default: 7 },\n\t        \"radius\": { type: \"number\", default: 0.5 },\n\t        \"ratio\": { default: 0.5 },\n\t        \"intensity\": { default: 1.0 },\n\t        \"maxDepth\": { default: 0.99 },\n\t        \"bias\": { default: 0.05 },\n\t        \"scale\": { default: 0.15 },\n\t        \"blurRadius\": { default: 7 },\n\t        \"depthCutoff\":  { default: 10 }\n\t\t},\n\n\t    init: function () {\n\t        this.system = this.el.sceneEl.systems.effects;\n\t        var pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };\n\t        this.renderTargets = [];\n\t\t\tthis.renderTargets.push(new THREE.WebGLRenderTarget( 1, 1, pars));\n\t\t\tthis.renderTargets.push(new THREE.WebGLRenderTarget( 1, 1, pars));\t\n\t        this.uniforms = {\n\t            \"texture\": { type: \"t\", value: this.renderTargets[0].texture },\n\t            \"intensity\": { type: \"f\", value: 1.0 },\n\t            \"maxDepth\": { type: \"f\", value: 0.99 },\n\t            \"depthCutoff\": { type: \"f\", default: 1}\n\t\t    };\n\t        this.SAOMaterial = null;\n\t        this.hBlurMaterial = null;\n\t        this.vBlurMaterial = null;\n\t        this.sizeUniform = { type: \"v2\", value: new THREE.Vector2()};\n\t        this.system.register(this);\n\t    },\n\n\t    update: function (od) {\n\t        var d = this.data, self=this;\n\n\t        this.rebuild(d.rings !== od.rings || d.samples !== od.samples, d.blurRadius !== od.blurRadius);\n\t        this.uniforms.depthCutoff.value = d.depthCutoff;\n\t        this.uniforms.intensity.value = d.intensity;\n\t        this.uniforms.maxDepth.value = d.maxDepth;\n\t        this.SAOMaterial.uniforms.bias.value = d.bias;\n\t        this.SAOMaterial.uniforms.scale.value = d.scale;\n\t        this.SAOMaterial.uniforms.kernelRadius.value = d.radius;\n\t        this.hBlurMaterial.uniforms.depthCutoff.value = d.depthCutoff;\n\t        this.vBlurMaterial.uniforms.depthCutoff.value = d.depthCutoff;\n\t    },\n\n\t    rebuild: function (sao, blur) {\n\t        var d = this.data;\n\t        if(sao) {\n\t            if (this.SAOMaterial) {\n\t                this.SAOMaterial.dispose();\n\t            }\n\t            this.SAOMaterial = this.system.materialize(SAOShader(true));\n\t\t\t\tthis.SAOMaterial.defines[\"RINGS\"] = parseInt(d.rings) + \".\";\n\t\t\t\tthis.SAOMaterial.defines[\"SAMPLES\"] = parseInt(d.samples) + \".\";\n\t\t\t\tthis.SAOMaterial.uniforms.cameraFar = this.system.cameraFar;\n\t            this.SAOMaterial.uniforms.cameraNear = this.system.cameraNear;\n\t        }\n\t        if(blur) {\n\t            if (this.hBlurMaterial) {\n\t                this.hBlurMaterial.dispose();\n\t                this.vBlurMaterial.dispose();\n\t            }\n\t            this.hBlurMaterial = this.system.materialize(DepthLimitedBlurShader(d.blurRadius, d.blurRadius/2, new THREE.Vector2(1,0)));\n\t            this.vBlurMaterial = this.system.materialize(DepthLimitedBlurShader(d.blurRadius, d.blurRadius/2, new THREE.Vector2(0,1)));\n\t            this.hBlurMaterial.uniforms.size = this.sizeUniform;\n\t            this.vBlurMaterial.uniforms.size = this.sizeUniform;\n\t            this.hBlurMaterial.uniforms.cameraFar = this.system.cameraFar;\n\t            this.hBlurMaterial.uniforms.cameraNear = this.system.cameraNear;\n\t            this.vBlurMaterial.uniforms.cameraFar = this.system.cameraFar;\n\t            this.vBlurMaterial.uniforms.cameraNear = this.system.cameraNear;\n\t        }\n\t    },\n\n\t    setSize: function(w, h) {\n\t        w = Math.ceil(w * this.data.ratio);\n\t        h = Math.ceil(h * this.data.ratio);\n\t        \n\t        this.sizeUniform.value.set(w,h);\n\n\t        this.renderTargets.forEach(function (rt) {\n\t            rt.setSize(w,h);\n\t        });\n\t    },\n\n\t    tock: function (time) {\n\t        if (!this.system.isActive(this, true)) return;\n\t        //this.SAOMaterial.uniforms.randomSeed.value = Math.random();\n\t        this.SAOMaterial.uniforms[ 'cameraInverseProjectionMatrix' ].value.getInverse( this.el.sceneEl.camera.projectionMatrix );\n\t\t\tthis.SAOMaterial.uniforms[ 'cameraProjectionMatrix' ].value = this.el.sceneEl.camera.projectionMatrix;\n\t    \n\t        this.SAOMaterial.uniforms.tDepth.value = this.el.sceneEl.renderTarget.depthTexture;\n\t        this.system.renderPass(this.SAOMaterial, this.renderTargets[0], true);\n\n\t\t\tif(this.data.blurRadius) {\n\t\t\t\tthis.hBlurMaterial.uniforms.tDiffuse.value = this.renderTargets[0].texture;\n\t\t\t\tthis.system.renderPass(this.hBlurMaterial, this.renderTargets[1], true);\n\n\t\t\t\tthis.vBlurMaterial.uniforms.tDiffuse.value = this.renderTargets[1].texture;\n\t\t\t\tthis.system.renderPass(this.vBlurMaterial, this.renderTargets[0], true);\n\t\t\t}\n\t\t},\n\n\t    remove: function () {\n\t        this.SAOMaterial.dispose();\n\t        this.hBlurMaterial.dispose();\n\t        this.vBlurMaterial.dispose();\n\t        this.renderTargets[0].dispose();\n\t        this.renderTargets[1].dispose();\n\t        this.system.unregister(this);\n\t    },\n\n\t    includes: [\"packing\"],\n\n\t    depth: true,\n\n\t    diffuse: true,\n\t    \n\t    fragment: [\n\t        \"float $unpackDepth(vec3 pack) {\",\n\t        \"\tfloat depth = dot( pack, 1.0 / vec3(1.0, 256.0, 256.0*256.0) );\",\n\t        \"\treturn depth * (256.0*256.0*256.0) / (256.0*256.0*256.0 - 1.0);\",\n\t        \"}\",\n\t\t\t\"void $main(inout vec4 color, vec4 origColor, vec2 uv, float depth) {\",\n\t\t\t\"   vec4 texel = texture2D($texture, uv);\",\n\t        \"   float z = perspectiveDepthToViewZ( $unpackDepth(texel.xyz), cameraNear, cameraFar );\",\n\t        \"   float Z = perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t        \"   color.rgb *= abs(z-Z) > $depthCutoff || Z >= $maxDepth * cameraFar ? 1.0  :  1.0 - texel.a * $intensity;\",\n\t        \"}\"\n\t\t].join( \"\\n\" )\n\t});\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\n\t/**\n\t * @author bhouston / http://clara.io/\n\t *\n\t * Scalable Ambient Occlusion\n\t *\n\t */\n\n\tmodule.exports = function (isFirst) {\n\t\treturn {\n\t\t\tdefines: {},\n\n\t\t\tuniforms: {\n\n\t\t\t\t\"tDepth\":       { type: \"t\", value: null },\n\t\t\t\t\n\t\t\t\t\"cameraNear\":   { type: \"f\", value: 1 },\n\t\t\t\t\"cameraFar\":    { type: \"f\", value: 100 },\n\t\t\t\t\"cameraProjectionMatrix\": { type: \"m4\", value: new THREE.Matrix4() },\n\t\t\t\t\"cameraInverseProjectionMatrix\": { type: \"m4\", value: new THREE.Matrix4() },\n\n\t\t\t\t\"scale\":        { type: \"f\", value: 1.0 },\n\t\t\t\t\"bias\":         { type: \"f\", value: 0.5 },\n\n\t\t\t\t\"minResolution\": { type: \"f\", value: 0.0 },\n\t\t\t\t\"kernelRadius\": { type: \"f\", value: 0.5 },\n\t\t\t\t\"randomSeed\":   { type: \"f\", value: 0.0 },\n\t\t\t\t\"maxDepth\":   { type: \"f\", value: 1.0 }\n\t\t\t},\n\n\t\t\tvertexShader: [\n\n\t\t\t\t\"varying vec2 vUv;\",\n\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\"vUv = uv;\",\n\n\t\t\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\t\t\"}\"\n\n\t\t\t].join( \"\\n\" ),\n\n\t\t\tfragmentShader: [\n\n\t\t\t\t// total number of samples at each fragment\",\n\t\t\t\t\n\t\t\t\t\"#include <common>\",\n\t\t\t\t\"#include <packing>\",\n\n\t\t\t\t\"varying vec2 vUv;\",\n\n\t\t\t\t\"uniform sampler2D tDepth;\",\n\n\t\t\t\t\"uniform float cameraNear;\",\n\t\t\t\t\"uniform float cameraFar;\",\n\t\t\t\t\"uniform mat4 cameraProjectionMatrix;\",\n\t\t\t\t\"uniform mat4 cameraInverseProjectionMatrix;\",\n\n\t\t\t\t\"uniform float scale;\",\n\t\t\t\t\"uniform float intensity;\",\n\t\t\t\t\"uniform float bias;\",\n\t\t\t\t\"uniform float kernelRadius;\",\n\t\t\t\t\"uniform float minResolution;\",\n\t\t\t\t\"uniform float randomSeed;\",\n\t\t\t\t\"uniform float maxDepth;\",\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\"float unpackDepth(vec3 pack) {\",\n\t\t\t\t\"\tfloat depth = dot( pack, 1.0 / vec3(1.0, 256.0, 256.0*256.0) );\",\n\t  \t\t\t\"\treturn depth * (256.0*256.0*256.0) / (256.0*256.0*256.0 - 1.0);\",\n\t\t\t\t\"}\",\n\t\t\t\t\n\t\t\t\t\"vec3 packDepth(float depth) {\",\n\t\t\t\t\"\tfloat depthVal = depth * (256.0*256.0*256.0 - 1.0) / (256.0*256.0*256.0);\",\n\t   \t\t\t\"\tvec4 encode = fract( depthVal * vec4(1.0, 256.0, 256.0*256.0, 256.0*256.0*256.0) );\",\n\t    \t\t\"\treturn encode.xyz - encode.yzw / 256.0 + 1.0/512.0;\",\n\t\t\t\t\"}\",\n\n\t\t\t\t\n\t\t\t\t\"float getViewZ( const in float depth ) {\",\n\n\t\t\t\t\t\"return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\",\n\n\t\t\t\t\"}\",\n\n\t\t\t\t\"vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\",\n\n\t\t\t\t\t\"float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\",\n\t\t\t\t\t\"vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\",\n\t\t\t\t\t\"clipPosition *= clipW;\", // unprojection.\n\t\t\t\t\t\"return ( cameraInverseProjectionMatrix * clipPosition ).xyz;\",\n\n\t\t\t\t\"}\",\n\n\t\t\t\t\"vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {\",\n\n\t\t\t\t\t\"return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );\",\n\t\t\t\t\n\t\t\t\t\"}\",\n\n\t\t\t\t\"float scaleDividedByCameraFar;\",\n\t\t\t\t\"float minResolutionMultipliedByCameraFar;\",\n\n\t\t\t\t\"float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {\",\n\n\t\t\t\t\t\"vec3 viewDelta = sampleViewPosition - centerViewPosition;\",\n\t\t\t\t\t\"float viewDistance = length( viewDelta );\",\n\t\t\t\t\t\"float scaledScreenDistance = scaleDividedByCameraFar * viewDistance;\",\n\t\t\t\t\t\"return max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );\",\n\n\t\t\t\t\"}\",\n\n\t\t\t\t// moving costly divides into consts\n\t\t\t\t\"const float ANGLE_STEP = PI2 * RINGS / SAMPLES;\",\n\t\t\t\t\"const float INV_NUM_SAMPLES = 1.0 / SAMPLES;\",\n\n\t\t\t\t\"float getAmbientOcclusion( const in vec3 centerViewPosition) {\",\n\n\t\t\t\t\t// precompute some variables require in getOcclusion.\n\t\t\t\t\t\"scaleDividedByCameraFar = scale;\",\n\t\t\t\t\t\"minResolutionMultipliedByCameraFar = minResolution * cameraFar;\",\n\t\t\t\t\t\"vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );\",\n\n\t\t\t\t\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/\n\t\t\t\t\t\"float angle = rand( vUv + randomSeed ) * PI2;\",\n\t\t\t\t\t\"vec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES );\",\n\t\t\t\t\t\"vec2 radiusStep = radius;\",\n\t\t\t\t\t\"float occlusionSum = 0.;\",\n\t\t\t\t\t\"float weightSum = 0.;\",\n\t\t\t\t\t\"for( int i = 0; i < int(SAMPLES); i ++ ) {\",\n\t\t\t\t\t\t\"vec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;\",\n\t\t\t\t\t\t\"radius += radiusStep;\",\n\t\t\t\t\t\t\"angle += ANGLE_STEP;\",\n\n\t\t\t\t\t\t\"float sampleDepth = textureVR( tDepth, sampleUv ).x;\",\n\t\t\t\t\t\t\"if( sampleDepth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\t\t\t\t\t\"continue;\",\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\t\"float sampleViewZ = getViewZ( sampleDepth );\",\n\t\t\t\t\t\t\"vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );\",\n\t\t\t\t\t\t\"occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );\",\n\t\t\t\t\t\t\"weightSum += 1.0;\",\n\n\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\"if( weightSum == 0.0 ) discard;\",\n\t\t\t\t\t\"return occlusionSum / weightSum;\",\n\t\t\t\t\t\n\t\t\t\t\"}\",\n\n\n\t\t\t\t\"void main() {\",\n\t\t\t\t\t\"vec4 texel = texture2D( tDepth, vUv );\",\n\t\t\t\t\t\"float centerDepth = texel.x;\",\n\t\t\t\t\t\n\t\t\t\t\t\"if( centerDepth >= ( maxDepth - EPSILON ) ) {\",\n\t\t\t\t\t\t\"discard;\",\n\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\"float centerViewZ = getViewZ( centerDepth );\",\n\t\t\t\t\t\"vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );\",\n\n\t\t\t\t\t\"gl_FragColor =  vec4(packDepth(texel.x), getAmbientOcclusion( viewPosition));\",\n\t\t\t\t\"}\"\n\n\t\t\t].join( \"\\n\" )\n\n\t\t};\n\t}\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\n\t/**\n\t * @author bhouston / http://clara.io\n\t *\n\t * For a horizontal blur, use X_STEP 1, Y_STEP 0\n\t * For a vertical blur, use X_STEP 0, Y_STEP 1\n\t *\n\t *\n\t */\n\n\t// Adapted by wizgrav to pack depth and AO in a single rgba texture\n\n\tTHREE.BlurShaderUtils = {\n\n\t\tcreateSampleWeights: function( kernelRadius, stdDev ) {\n\n\t\t\tvar gaussian = function( x, stdDev ) {\n\t\t\t\treturn Math.exp( - ( x*x ) / ( 2.0 * ( stdDev * stdDev ) ) ) / ( Math.sqrt( 2.0 * Math.PI ) * stdDev );\n\t\t\t};\n\n\t\t\tvar weights = [];\n\n\t\t\tfor( var i = 0; i <= kernelRadius; i ++ ) {\n\t\t\t\tweights.push( gaussian( i, stdDev ) );\n\t\t\t}\n\n\t\t\treturn weights;\n\t\t},\n\n\t\tcreateSampleOffsets: function( kernelRadius, uvIncrement ) {\n\n\t\t\tvar offsets = [];\n\n\t\t\tfor( var i = 0; i <= kernelRadius; i ++ ) {\n\t\t\t\toffsets.push( uvIncrement.clone().multiplyScalar( i ) );\n\t\t\t}\n\n\t\t\treturn offsets;\n\n\t\t},\n\n\t\tconfigure: function( kernelRadius, stdDev, uvIncrement ) {\n\t\t\treturn {\n\t\t\t\t'sampleUvOffsets': THREE.BlurShaderUtils.createSampleOffsets( kernelRadius, uvIncrement ),\n\t\t\t\t'sampleWeights': THREE.BlurShaderUtils.createSampleWeights( kernelRadius, stdDev )\n\t\t\t}\n\t\t}\n\n\t};\n\n\n\tmodule.exports =  function (radius, stdDev, uvIncrement) {\n\t\tradius = radius || 4;\n\t\tvar config = THREE.BlurShaderUtils.configure(radius, stdDev, uvIncrement )\n\t\treturn {\n\t\t\tdefines: {\n\n\t\t\t\t\"KERNEL_RADIUS\": radius,\n\n\t\t\t},\n\n\t\t\tuniforms: {\n\n\t\t\t\t\"tDiffuse\":         { type: \"t\", value: null },\n\t\t\t\t\"size\":             { type: \"v2\", value: new THREE.Vector2( 512, 512 ) },\n\t\t\t\t\"sampleUvOffsets\":  { type: \"v2v\", value: config.sampleUvOffsets },\n\t\t\t\t\"sampleWeights\":    { type: \"1fv\", value: config.sampleWeights },\n\t\t\t\t\"depthCutoff\":      { type: \"f\", value: 10 },\n\t\t\t\t\"cameraFar\":      { type: \"f\", value: 1 },\n\t\t\t\t\"cameraNear\":      { type: \"f\", value: 1000 }\n\t\t\t},\n\n\t\t\tvertexShader: [\n\n\t\t\t\t\"#include <common>\",\n\n\t\t\t\t\"uniform vec2 size;\",\n\n\t\t\t\t\"varying vec2 vUv;\",\n\t\t\t\t\"varying vec2 vInvSize;\",\n\n\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\"vUv = uv;\",\n\t\t\t\t\t\"vInvSize = 1.0 / size;\",\n\n\t\t\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\t\t\"}\"\n\n\t\t\t].join( \"\\n\" ),\n\n\t\t\tfragmentShader: [\n\n\t\t\t\t\"#include <common>\",\n\t\t\t\t\"#include <packing>\",\n\n\t\t\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\t\t\n\t\t\t\t\"uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];\",\n\t\t\t\t\"uniform float sampleWeights[ KERNEL_RADIUS + 1 ];\",\n\t\t\t\t\"uniform float depthCutoff;\",\n\t\t\t\t\"uniform float cameraFar;\",\n\t\t\t\t\"uniform float cameraNear;\",\n\n\t\t\t\t\"varying vec2 vUv;\",\n\t\t\t\t\"varying vec2 vInvSize;\",\n\t\t\t\t\n\t\t\t\t\"float unpackDepth(vec3 pack) {\",\n\t\t\t\t\"\tfloat depth = dot( pack, 1.0 / vec3(1.0, 256.0, 256.0*256.0) );\",\n\t  \t\t\t\"\treturn depth * (256.0*256.0*256.0) / (256.0*256.0*256.0 - 1.0);\",\n\t\t\t\t\"}\",\n\t\t\t\t\n\t\t\t\t\"float getViewZ( const in float depth ) {\",\n\n\t\t\t\t \"return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\",\n\n\t\t\t \t\"}\",\n\t\t\t\t\"void main() {\",\n\t\t\t\t\t\"vec4 texel = texture2D( tDiffuse, vUv );\",\n\t\t\t\t\t\"vec3 orig = texel.xyz;\",\n\t\t\t\t\t\"float depth = unpackDepth( orig );\",\n\t\t\t\t\t\"if( depth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\t\t\t\t\"discard;\",\n\t\t\t\t\t\"}\",\n\t\t\t\t\t\"float centerViewZ = -getViewZ( depth );\",\n\t\t\t\t\t\"bool rBreak = false, lBreak = false;\",\n\n\t\t\t\t\t\"float weightSum = sampleWeights[0];\",\n\t\t\t\t\t\"float AOSum = texel.a * weightSum;\",\n\n\t\t\t\t\t\"for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {\",\n\n\t\t\t\t\t\t\"float sampleWeight = sampleWeights[i];\",\n\t\t\t\t\t\t\"vec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;\",\n\n\t\t\t\t\t\t\"vec2 sampleUv = vUv + sampleUvOffset;\",\n\t\t\t\t\t\t\"texel = textureVR( tDiffuse, sampleUv );\",\n\t\t\t\t\t\t\"float viewZ = -getViewZ(unpackDepth( texel.xyz ));\",\n\n\t\t\t\t\t\t\"if( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;\",\n\n\t\t\t\t\t\t\"if( ! rBreak ) {\",\n\t\t\t\t\t\t\t\"AOSum += texel.a * sampleWeight;\",\n\t\t\t\t\t\t\t\"weightSum += sampleWeight;\",\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\t\"sampleUv = vUv - sampleUvOffset;\",\n\t\t\t\t\t\t\"texel = textureVR( tDiffuse, sampleUv );\",\n\t\t\t\t\t\t\"viewZ = -getViewZ(unpackDepth( texel.xyz ));\",\n\n\t\t\t\t\t\t\"if( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;\",\n\n\t\t\t\t\t\t\"if( ! lBreak ) {\",\n\t\t\t\t\t\t\t\"AOSum += texel.a * sampleWeight;\",\n\t\t\t\t\t\t\t\"weightSum += sampleWeight;\",\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\"gl_FragColor = vec4(orig, AOSum / weightSum);\",\n\n\t\t\t\t\"}\"\n\n\t\t\t].join( \"\\n\" )\n\n\t};\n\t}\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\n\tAFRAME.registerComponent(\"lighty\", {\n\t\tschema: {\n\t\t\tcolor: { type: \"color\", default: \"#000000\" },\n\t\t\tradius: { type: \"number\", default: 0 },\n\t\t\tdecay: { type: \"number\", default: 1 }\n\t\t},\n\t\t\n\t\tinit: function () {\n\t\t\tthis.el.sceneEl.systems.effects.addLight(this);\n\t\t},\n\t\t\n\t\tremove: function () {\n\t\t\tthis.el.sceneEl.systems.effects.removeLight(this);\n\t\t}\n\t});\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports) {\n\n\tTHREE.ShaderChunk[ 'lights_pars_maps' ] += [\n\t\t'#if defined TILED_FORWARD',\n\t\t'uniform vec4 tileData;',\n\t\t'uniform sampler2D tileTexture;',\n\t\t'uniform sampler2D lightTexture;',\n\t\t'#endif'\n\t].join( '\\n' );\n\n\tTHREE.ShaderChunk[ 'lights_fragment_maps' ] += [\n\t\t'',\n\t\t'#if defined TILED_FORWARD',\n\t\t'vec2 tUv = floor(gl_FragCoord.xy / tileData.xy * 32.) / 32. + tileData.zw;',\n\t\t'vec4 tile = texture2D(tileTexture, tUv);',\n\t\t'for (int i=0; i < 4; i++) {',\n\t\t'\tfloat tileVal = tile.x * 255.;',\n\t\t'  \ttile.xyzw = tile.yzwx;',\n\t\t'\tif(tileVal == 0.){ continue; }',\n\t\t'  \tfloat tileDiv = 128.;',\n\t\t'\tfor (int j=0; j < 8; j++) {',\n\t\t'  \t\tif (tileVal < tileDiv) {  tileDiv *= 0.5; continue; }',\n\t\t'\t\ttileVal -= tileDiv;',\n\t\t'\t\ttileDiv *= 0.5;',\n\t\t'  \t\tPointLight pointlight;',\n\t\t'\t\tfloat uvx = (float(8 * i + j) + 0.5) / 32.;',\n\t\t'  \t\tvec4 lightData = texture2D(lightTexture, vec2(uvx, 0.));',\n\t\t'  \t\tvec4 lightColor = texture2D(lightTexture, vec2(uvx, 1.));',\n\t\t'  \t\tpointlight.position = lightData.xyz;',\n\t\t'  \t\tpointlight.distance = lightData.w;',\n\t\t'  \t\tpointlight.color = lightColor.rgb;',\n\t\t'  \t\tpointlight.decay = lightColor.a;',\n\t\t'  \t\tgetPointDirectLightIrradiance( pointlight, geometry, directLight );',\n\t\t'\t\tRE_Direct( directLight, geometry, material, reflectedLight );',\n\t\t'\t}',\n\t\t'}',\n\t\t'#endif'\n\t].join( '\\n' );\n\n\tvar utils = AFRAME.utils;\n\n\tvar CubeLoader = new THREE.CubeTextureLoader();\n\tvar texturePromises = {};\n\n\t/**\n\t * Standard (physically-based) shader with tiled forward lighting.\n\t */\n\tAFRAME.registerShader('standard-fx', {\n\t  schema: {\n\t    ambientOcclusionMap: {type: 'map'},\n\t    ambientOcclusionMapIntensity: {default: 1},\n\t    ambientOcclusionTextureOffset: {type: 'vec2'},\n\t    ambientOcclusionTextureRepeat: {type: 'vec2', default: {x: 1, y: 1}},\n\n\t    color: {type: 'color'},\n\n\t    displacementMap: {type: 'map'},\n\t    displacementScale: {default: 1},\n\t    displacementBias: {default: 0.5},\n\t    displacementTextureOffset: {type: 'vec2'},\n\t    displacementTextureRepeat: {type: 'vec2', default: {x: 1, y: 1}},\n\t    emissive: {type: 'color', default: '#000'},\n\t    emissiveIntensity: {default: 1},\n\t    envMap: {default: ''},\n\n\t    fog: {default: true},\n\t    height: {default: 256},\n\n\t    metalness: {default: 0.0, min: 0.0, max: 1.0},\n\t    metalnessMap: {type: 'map'},\n\t    metalnessTextureOffset: {type: 'vec2'},\n\t    metalnessTextureRepeat: {type: 'vec2', default: {x: 1, y: 1}},\n\n\t    normalMap: {type: 'map'},\n\t    normalScale: {type: 'vec2', default: {x: 1, y: 1}},\n\t    normalTextureOffset: {type: 'vec2'},\n\t    normalTextureRepeat: {type: 'vec2', default: {x: 1, y: 1}},\n\n\t    offset: {type: 'vec2', default: {x: 0, y: 0}},\n\t    repeat: {type: 'vec2', default: {x: 1, y: 1}},\n\n\t    roughness: {default: 0.5, min: 0.0, max: 1.0},\n\t    roughnessMap: {type: 'map'},\n\t    roughnessTextureOffset: {type: 'vec2'},\n\t    roughnessTextureRepeat: {type: 'vec2', default: {x: 1, y: 1}},\n\n\t    sphericalEnvMap: {type: 'map'},\n\t    src: {type: 'map'},\n\t    width: {default: 512},\n\t    wireframe: {default: false},\n\t    wireframeLinewidth: {default: 2}\n\t  },\n\n\t  /**\n\t   * Initializes the shader.\n\t   * Adds a reference from the scene to this entity as the camera.\n\t   */\n\t  init: function (data) {\n\t    this.material = new THREE.MeshStandardMaterial(getMaterialData(data));\n\t    utils.material.updateMap(this, data);\n\t    if (data.normalMap) { utils.material.updateDistortionMap('normal', this, data); }\n\t    if (data.displacementMap) { utils.material.updateDistortionMap('displacement', this, data); }\n\t    if (data.ambientOcclusionMap) { utils.material.updateDistortionMap('ambientOcclusion', this, data); }\n\t    if (data.metalnessMap) { utils.material.updateDistortionMap('metalness', this, data); }\n\t    if (data.roughnessMap) { utils.material.updateDistortionMap('roughness', this, data); }\n\t    this.updateEnvMap(data);\n\t\tthis.material.onBeforeCompile = function ( shader ) {\n\t\t\tshader.uniforms.tileData = State.tileData;\n\t\t\tshader.uniforms.tileTexture = State.tileTexture;\n\t\t\tshader.uniforms.lightTexture = State.lightTexture;\n\t\t\tshader.defines[ 'TILED_FORWARD' ] = 1;  \n\t\t}\n\t  },\n\n\t  update: function (data) {\n\t    this.updateMaterial(data);\n\t    utils.material.updateMap(this, data);\n\t    if (data.normalMap) { utils.material.updateDistortionMap('normal', this, data); }\n\t    if (data.displacementMap) { utils.material.updateDistortionMap('displacement', this, data); }\n\t    if (data.ambientOcclusionMap) { utils.material.updateDistortionMap('ambientOcclusion', this, data); }\n\t    if (data.metalnessMap) { utils.material.updateDistortionMap('metalness', this, data); }\n\t    if (data.roughnessMap) { utils.material.updateDistortionMap('roughness', this, data); }\n\t    this.updateEnvMap(data);\n\t  },\n\n\t  /**\n\t   * Updating existing material.\n\t   *\n\t   * @param {object} data - Material component data.\n\t   * @returns {object} Material.\n\t   */\n\t  updateMaterial: function (data) {\n\t    var material = this.material;\n\t    data = getMaterialData(data);\n\t    Object.keys(data).forEach(function (key) {\n\t      material[key] = data[key];\n\t    });\n\t  },\n\n\t  /**\n\t   * Handle environment cubemap. Textures are cached in texturePromises.\n\t   */\n\t  updateEnvMap: function (data) {\n\t    var self = this;\n\t    var material = this.material;\n\t    var envMap = data.envMap;\n\t    var sphericalEnvMap = data.sphericalEnvMap;\n\n\t    // No envMap defined or already loading.\n\t    if ((!envMap && !sphericalEnvMap) || this.isLoadingEnvMap) {\n\t      material.envMap = null;\n\t      material.needsUpdate = true;\n\t      return;\n\t    }\n\t    this.isLoadingEnvMap = true;\n\n\t    // if a spherical env map is defined then use it.\n\t    if (sphericalEnvMap) {\n\t      this.el.sceneEl.systems.material.loadTexture(sphericalEnvMap, {src: sphericalEnvMap}, function textureLoaded (texture) {\n\t        self.isLoadingEnvMap = false;\n\t        texture.mapping = THREE.SphericalReflectionMapping;\n\t        material.envMap = texture;\n\t        utils.material.handleTextureEvents(self.el, texture);\n\t        material.needsUpdate = true;\n\t      });\n\t      return;\n\t    }\n\n\t    // Another material is already loading this texture. Wait on promise.\n\t    if (texturePromises[envMap]) {\n\t      texturePromises[envMap].then(function (cube) {\n\t        self.isLoadingEnvMap = false;\n\t        material.envMap = cube;\n\t        utils.material.handleTextureEvents(self.el, cube);\n\t        material.needsUpdate = true;\n\t      });\n\t      return;\n\t    }\n\n\t    // Material is first to load this texture. Load and resolve texture.\n\t    texturePromises[envMap] = new Promise(function (resolve) {\n\t      utils.srcLoader.validateCubemapSrc(envMap, function loadEnvMap (urls) {\n\t        CubeLoader.load(urls, function (cube) {\n\t          // Texture loaded.\n\t          self.isLoadingEnvMap = false;\n\t          material.envMap = cube;\n\t          utils.material.handleTextureEvents(self.el, cube);\n\t          resolve(cube);\n\t        });\n\t      });\n\t    });\n\t  }\n\t});\n\n\t/**\n\t * Builds and normalize material data, normalizing stuff along the way.\n\t *\n\t * @param {object} data - Material data.\n\t * @returns {object} data - Processed material data.\n\t */\n\tfunction getMaterialData (data) {\n\t  var newData = {\n\t    color: new THREE.Color(data.color),\n\t    emissive: new THREE.Color(data.emissive),\n\t    emissiveIntensity: data.emissiveIntensity,\n\t    fog: data.fog,\n\t    metalness: data.metalness,\n\t    roughness: data.roughness,\n\t    wireframe: data.wireframe,\n\t    wireframeLinewidth: data.wireframeLinewidth\n\t  };\n\n\t  if (data.normalMap) { newData.normalScale = data.normalScale; }\n\n\t  if (data.ambientOcclusionMap) { newData.aoMapIntensity = data.ambientOcclusionMapIntensity; }\n\n\t  if (data.displacementMap) {\n\t    newData.displacementScale = data.displacementScale;\n\t    newData.displacementBias = data.displacementBias;\n\t  }\n\n\t  return newData;\n\t}\n\n/***/ })\n/******/ ]);\n  \n  \n})()","export default (function cloud(){\n  \n  \nAFRAME.registerComponent('cloud', {\n  schema:{\n   color: {type:'string',default:'blue'}\n  },\n  init: function () {\n    const el = this.el;\n    el.setAttribute('material', 'shader','cloud-shader');\n    el.setAttribute('material', 'myColor', this.data.color);\n  },\n  update: function () {\n    this.el.setAttribute('material', 'myColor', this.data.color);\n  }\n});\n\n// from https://github.com/hughsk/glsl-noise/blob/master/periodic/3d.glsl\nconst pnoise3 = `\n\n//\n// GLSL textureless classic 3D noise \"cnoise\",\n// with an RSL-style periodic variant \"pnoise\".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-10-11\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise, periodic variant\nfloat pnoise3(vec3 P, vec3 rep)\n{\n  vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n  vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n\n`;\n\nAFRAME.registerShader('cloud-shader', {\n  schema: {\n    timeMsec: {type:'time', is:'uniform'},\n    myOffset: {type:'vec3', is:'uniform'},\n    myColor: {type:'color', is:'uniform', default:'pink'}\n  },\n  vertexShader: pnoise3 + `\n\n//\n// Based on @thespite's article:\n// \n// \"Vertex displacement with a noise function using GLSL and three.js\"\n// Source: https://www.clicktorelease.com/blog/vertex-displacement-noise-3d-webgl-glsl-three-js/\n//\n\nvarying float noise;\nuniform float timeMsec; // A-Frame time in milliseconds.\nuniform vec3 myOffset;\n\nfloat turbulence( vec3 p ) {\n\n  float w = 100.0;\n  float t = -.5;\n\n  for (float f = 1.0 ; f <= 10.0 ; f++ ){\n    float power = pow( 2.0, f );\n    t += abs( pnoise3( vec3( power * p ), vec3( 10.0, 10.0, 10.0 ) ) / power );\n  }\n\n  return t;\n\n}\n\nvoid main() {\n  float time = timeMsec / 1000.0; // Convert from A-Frame milliseconds to typical time in seconds.\n  noise = 10.0 *  -.10 * turbulence( .5 * normal + time / 3.0 );\n  float b = 5.0 * pnoise3( 0.05 * position, vec3( 100.0 ) );\n  float displacement = (- 10. * noise + b) / 50.0;\n\n  vec3 newPosition = position + normal * displacement + myOffset;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n}\n\n`,\n  fragmentShader: `\n\nvarying float noise;\nuniform vec3 myColor;\n\nvoid main() {\n\n  vec3 color = myColor  - vec3(2. * noise);\n  gl_FragColor = vec4( color.rgb , 1.0 );\n\n}\n\n`\n});\n\n  \n  \n  \n  \n  \n  \n  \n  \n})()","export default CS1=>{\n  \n  AFRAME.registerComponent('npc', {\n    schema:{\n      waypoints:{type:'array'},\n      name:{type:'string'},\n      roam:{type:'boolean',default:false}\n    },\n    init: function () {\n      this.waypoints=this.data.waypoints;\n      this.waypointsIndex=0;\n      this.moves=0;\n      if(this.data.name){\n        this.name = this.data.name;\n      }else{\n        this.name = (CS1.npc)? `npc${CS1.npc.length}`:'npc0';\n      }\n      if(CS1.npc){\n        CS1.npc[this.name]=this;\n      }else{\n        CS1.npc={};\n        CS1.npc[this.name]=this;\n      }\n      this.addListeners();\n      CS1.socket.emit('register-npc',{name:this.name,waypoints:this.waypoints});\n      if(this.data.roam)this.requestMove();\n    },\n    addListeners: function(){\n      let self = this;\n      this.el.addEventListener('navigation-end',this.onNavigationEnd.bind(self));\n      if(!CS1.socket._callbacks[\"$npc-move\"])\n      CS1.socket.on('npc-move',data=>{\n        if(data.dest===self.dest)return;\n        CS1.npc[data.name].dest = data.dest;\n        CS1.npc[data.name].setPosition(data.pos);\n        CS1.npc[data.name].move(data.dest);\n      });\n    },\n    setWaypoints: function(waypointsArray){\n      this.waypoints = waypointsArray;\n      CS1.socket.emit('set-npc-waypoints',{name:this.name,waypoints:waypointsArray});\n    },\n    addWaypoint: function(waypoint){\n      this.waypoints.push(waypoint);\n      CS1.socket.emit('add-npc-waypoint',{name:this.name,waypoint:waypoint});\n    },\n    move: function (destination=false) {\n      this.moves++;\n      let s;\n      let dest={};\n      if(destination){\n        s = destination;\n      }else{\n        s=this.waypoints[this.waypointsIndex];\n      }\n      if(!s){\n          console.error('You must define some waypoints for your npc to roam! < npc component >');\n          return;\n      }else{\n          let a = s.split(' ');\n          dest.x=a[0];\n          dest.y=a[1];\n          dest.z=a[2];\n          if (dest) this.el.setAttribute('nav-agent', {\n            active: true,\n            destination: dest,\n            speed: 2\n          });\n      \n      }\n    },\n    setPosition: function (position) {\n      this.el.setAttribute('position',position);\n    },\n    tick: function(t,dt){\n    \n     \n    },\n    requestMove: function (dest=''){\n      CS1.socket.emit('npc-move',{\n          name:this.name,\n          pos:this.el.getAttribute('position'),\n          dest:dest \n      });\n    },\n    onNavigationEnd: function(e){\n      //this.dest=false;\n      //console.log(`NPC Navigation has ended for ${this.name}.`)\n      //console.log(e);\n      this.waypointsIndex++;\n      if( this.waypointsIndex==this.waypoints.length)this.waypointsIndex=0;\n      let d = this.waypoints[this.waypointsIndex];\n      if(this.data.roam)this.requestMove(d);\n    }\n  });\n  \n}","export default (function dotrow(){\n   \nAFRAME.registerComponent('dotrow', {\n  schema:{\n   change: {type:'string',default:'x'},\n   to: {type:'number',default:10}\n  },\n  init: function () {\n    \n    let changeDimension = this.data.change;\n    let to = this.data.to;\n    let elPosition = this.el.getAttribute('position');\n    let from = elPosition[changeDimension];\n    let yPosition = 1;\n    let delta = (to>from)?2:-2;\n    let cdIsX = (changeDimension=='x');\n    \n    //console.log(`preparing to add dots from ${from} to ${to} in the ${changeDimension} dimension with a delta of ${delta}.`);\n    \n    this.dots = [];\n\n    let scn = document.querySelector('a-scene');\n    \n    for(let i = from;i*(delta/2) < to*(delta/2); i += delta){\n      //console.log('adding dot...');\n      let c = document.createElement('a-sphere');\n      c.setAttribute('position',(cdIsX)?`${i} 1 ${elPosition.z}`:`${elPosition.x} 1 ${i}`);\n      c.setAttribute('shader-frog', 'name:Ova_Shader');\n      c.setAttribute('radius', '0.5');\n      c.setAttribute('collectible','affects:pointsDial;value:10;threshold:1.6')  \n      scn.appendChild(c);\n      this.dots.push(c);\n      \n    }\n    \n    this.firstInitTime = Date.now();\n    \n  },\n  update: function(){\n\n     if((Date.now()-this.firstInitTime)<5000)return;\n     console.log('updating dotrow...');\n     \n     this.dots.forEach(\n       d=>{\n         d.parentNode.removeChild(d);\n       }\n     );\n     this.init();\n  \n  }\n  \n});\n\n})()","export default CS1=>{\n   \nAFRAME.registerComponent('userdata', {\n  init: function () {\n    //{avatar:'Mary'}\n    CS1.db = {};\n    CS1.db.set = (keyValueObject,cb)=>{\n      CS1.socket.emit('db-set', keyValueObject, cb);\n    }\n    //'avatar'\n    CS1.db.get = (key,cb)=>{\n      CS1.socket.emit('db-get', key, cb);\n    }\n  }\n  \n});\n\n}","export default CS1=>{\n  \n  AFRAME.registerComponent('iot-api', {\n    schema:{\n      LED:{type:'string',default:'on'}\n    },\n    init: function () {   \n      const self = this;\n      this.el.addEventListener('click',e=>{\n        console.log('Click detected on LED.');\n        self.toggleLED();\n      }); \n      CS1.iot = {};\n      CS1.iot.set = (keyValueObject,cb)=>{\n       CS1.socket.emit('iot-set', keyValueObject, cb);\n      }\n      CS1.iot.get = (key,cb)=>{\n        CS1.socket.emit('iot-get', key, cb);\n      }\n      CS1.socket.on('iot-update', data=>{\n        \n        console.log('LED update');\n        if(data.LED == 'on'){\n          this.onLED();\n        }else{   \n          this.offLED();\n        }\n      \n      });\n      CS1.iot.get('LED',v=>{\n        \n        console.log('LED INITIALIZE');\n        if(v == 'on'){\n          this.onLED();\n        }else{   \n          this.offLED();\n        }\n      \n      });\n    },\n    setLED: function (state) {\n      \n    },\n    offLED: function(){\n      let mat = 'color:#551818;emissiveIntensity:0';\n      this.data.LED = 'off';\n      this.el.setAttribute('material',mat);\n    },\n    onLED: function(){\n      let mat = 'color:red;emissiveIntensity:4'; \n      this.data.LED = 'on';\n      this.el.setAttribute('material',mat);\n    },\n    toggleLED: function () {\n      let mat;\n      if(this.data.LED == 'on'){\n        this.offLED();\n        CS1.iot.set({LED:'off'},()=>{});\n      }else{   \n        this.onLED();\n        CS1.iot.set({LED:'on'},()=>{});\n      }\n       \n    },\n    tick: function(t,dt){\n    \n     \n    }\n  });\n  \n}","export default(()=>{\n\nAFRAME.registerSystem('log', {\n\t  schema: {\n\t    console: {default: true}\n\t  },\n\n\t  init: function () {\n\t    var data = this.data;\n\t    var logs = this.logs = [];\n\t    var loggers = this.loggers = [];\n\n\t    // Register global function for logging.\n\t    window.CS1.log = function (message, channel) {\n\t      logs.push([message, channel]);\n\t      loggers.forEach(function (loggerComponent) {\n\t        loggerComponent.receiveLog(message, channel);\n\t      });\n\n\t      if (data.console) {\n\t        console.log('[log:' + (channel || '') + '] ' + message);\n\t      }\n\t    };\n      \n      window.CS1.socket.on('vr-log',data=>{\n        window.CS1.log(data.msg,data.channel);\n      });\n      \n      window.CS1.logall = function (message, channel){\n        window.CS1.socket.emit('logall',{msg:message,channel:channel});    \n      }\n      \n      \n\t  },\n\n\t  registerLogger: function (component) {\n\t    this.loggers.push(component);\n\t    this.logs.forEach(function (log) {\n\t      component.receiveLog.apply(component, log);\n\t    });\n\t  },\n\n\t  unregisterLogger: function (component) {\n\t    this.loggers.splice(this.loggers.indexOf(component), 1);\n\t  }\n\t});\n\n\t/**\n\t * In-VR logging using text component.\n\t */\n\tAFRAME.registerComponent('log', {\n\t  schema: {\n\t    channel: {type: 'string'},\n\t    filter: {type: 'string'},\n\t    max: {default: 100},\n\t    showErrors: {default: true}\n\t  },\n\n\t  init: function () {\n\t    this.logs = [];\n\t    this.system.registerLogger(this);\n\t  },\n\n\t  play: function () {\n\t    var self = this;\n\n\t    // Listen for `<a-scene>.emit('log')`.\n\t    this.el.sceneEl.addEventListener('log', function (evt) {\n\t      if (!evt.detail) { return; }\n\t      self.receiveLog(evt.detail.message, evt.detail.channel);\n\t    });\n\n\t    window.onerror = function (errorMsg, url, lineNumber, column, errorObj) {\n\t      self.receiveLog('Error: ' + errorMsg);\n\t    }\n\t  },\n\n\t  receiveLog: function (message, channel) {\n\t    var data = this.data;\n\n\t    // Coerce to string.\n\t    if (typeof message !== 'string') {\n\t      message = JSON.stringify(message);\n\t    }\n\n\t    // Match with ID if defined in data or event detail.\n\t    if (data.channel && channel && data.channel !== channel) { return; }\n\n\t    // Apply filter if `filter` defined.\n\t    if (data.filter && message.indexOf(data.filter) === -1) { return; }\n\n\t    // Add log.\n\t    this.logs.push(message);\n\n\t    // Truncate logs if `max` defined.\n\t    if (data.max && this.logs.length > data.max) { this.logs.shift(); }\n\n\t    // Update text. Each log gets its own line.\n\t    this.el.setAttribute('text', {value: this.logs.join('\\n')});\n      \n\t  },\n\n\t  remove: function () {\n\t    this.el.removeAttribute('text');\n\t    this.system.unregisterLogger(this);\n\t  }\n\t});\n  \n})()","export default (()=>{\n  \n  AFRAME.registerSystem('launchable', {\n  schema: {},  // System schema. Parses into `this.data`.\n\n  init: function () {\n\n    CS1.socket.on('launch-sound',name=>{\n      CS1.grabbables[name].components.sound__launch.playSound();\n    });\n    \n  },\n\n  \n});\n  \n  AFRAME.registerComponent('launchable', {\n    schema:{\n      burst:{type:'boolean',default:true},\n      launchSound:{type:'string',default:'https://cdn.glitch.com/83b7f985-f6ce-40dd-ac98-772aff98ebbf%2Fwoosh.mp3'}\n    },\n    // will listen for the grabbable release event \n    dependencies: ['grabbable'],\n    \n    init: function () {\n      \n      let self = this;\n      \n      self.grabbable = self.el.components.grabbable;\n      \n      self.el.setAttribute('sound__launch',`src:url(${this.data.launchSound})`);\n      \n      self.el.addEventListener('grabEnd',e=>{\n        CS1.socket.emit('logall',{msg:`${CS1.myPlayer.name} launched grabbable ${self.grabbable.name}!`,channel:'0'});\n        self.grabbable.isDragging = true; // can't grab while it is in launch\n        let launchData = {name:self.grabbable.name,dir:self.getDir()};\n        //console.log(launchData);\n        CS1.socket.emit('launch',launchData);\n      });\n      \n      \n      \n      \n         \n    },\n    \n    getDir: function(){\n     if(CS1.device == 'Oculus Quest'){\n       let d = this.grabbable.cursor.components.raycaster.raycaster.ray.direction;\n       d.x *= -1;\n       d.y *= -1;\n       d.z *= -1;\n       return d;\n     }else{\n       return this.grabbable.cursor.object3D.getWorldDirection(); \n     }\n     \n    }\n    \n    \n  });\n\n})()","export default (function launchrow(){\n   \nAFRAME.registerComponent('launchrow', {\n  schema:{\n   change: {type:'string',default:'x'},\n   to: {type:'number',default:10}\n  },\n  init: function () {\n    \n    let changeDimension = this.data.change;\n    let to = this.data.to;\n    let elPosition = this.el.getAttribute('position');\n    let from = elPosition[changeDimension];\n    let yPosition = 1;\n    let delta = (to>from)?4:-4;\n    let cdIsX = (changeDimension=='x');\n    \n    //console.log(`preparing to add dots from ${from} to ${to} in the ${changeDimension} dimension with a delta of ${delta}.`);\n    \n    this.dots = [];\n\n    let scn = document.querySelector('a-scene');\n    \n    for(let i = from;i*(delta/2) < to*(delta/2); i += delta){\n      //console.log('adding dot...');\n      let c = document.createElement('a-sphere');\n      c.setAttribute('position',(cdIsX)?`${i} 1.4 ${elPosition.z}`:`${elPosition.x} 1.4 ${i}`);\n      c.setAttribute('shader-frog', 'name:Disco_Shader');\n      c.setAttribute('radius', '1');\n      c.setAttribute('collectible','affects:energyDial;value:-10;threshold:1.6');\n      c.setAttribute('grabbable','');\n      c.setAttribute('launchable','');  \n      scn.appendChild(c);\n      this.dots.push(c);\n      \n    }\n    \n    this.firstInitTime = Date.now();\n    \n  },\n  update: function(){\n\n     if((Date.now()-this.firstInitTime)<5000)return;\n     console.log('updating dotrow...');\n     \n     this.dots.forEach(\n       d=>{\n         d.parentNode.removeChild(d);\n       }\n     );\n     this.init();\n  \n  }\n  \n});\n\n})()","import config from '../../../../.data/client-config.json';\nimport page1 from './page1.html';\nimport page2 from './page2.html';\nimport page3 from './page3.html';\nimport page4 from './page4.html';\n\nexport const controls = {\n  \n init: function(){ \n   \n AFRAME.registerComponent('showbutton', {\n      schema: {\n        'target': {type: 'selector'},\n      },\n      init: function () {\n        var show=false;    \n        this.el.addEventListener(\"click\",()=>{\n          if(show){\n            this.data.target.setAttribute(\"visible\",\"false\");\n            this.el.querySelector(\"button\").innerHTML=\"Show Box\";\n          }else{\n            this.data.target.setAttribute(\"visible\",\"true\");\n            this.el.querySelector(\"button\").innerHTML=\"Hide Box\";\n          }\n          show=!show;\n        });\n      }\n    });\n   \n \n const m1 = document.querySelector('#menu1');\n const m = document.querySelector('#main');\n const m2 = document.querySelector('#menu2');\n\n function runOnce(){\n      m1.setAttribute('sound','src:url(https://cdn.glitch.com/36918312-2de3-4283-951d-240b263949f7%2Fclick.mp3?v=1561929149589)');\n      m2.setAttribute('sound','src:url(https://cdn.glitch.com/36918312-2de3-4283-951d-240b263949f7%2Fclick.mp3?v=1561929149589)');\n      document.removeEventListener('click',runOnce);\n    }\n\n\n    document.addEventListener('click',runOnce);\n    \n    const box = document.querySelector('#box');\n\n    let topBtn = document.querySelector('#top-btn');\n    if(topBtn)topBtn.addEventListener('mouseenter',e=>{\n  \n      if(CS1.stats.container.getAttribute('visible')&&m2.components.sound)m2.components.sound.playSound()\n\n    });\n    if(topBtn)topBtn.addEventListener('click',e=>{\n      e.preventDefault();\n      box.setAttribute('material','src:#chip');\n      CS1.socket.playerData.faceIndex = 1;\n      CS1.myPlayer._avatarType = config.avatar.models[CS1.socket.playerData.faceIndex].type;\n    });\n\n    let midBtn = document.querySelector('#mid-btn');\n    if(midBtn)midBtn.addEventListener('mouseenter',e=>{\n\n      if(CS1.stats.container.getAttribute('visible')&&m2.components.sound)m2.components.sound.playSound()\n\n    });\n    if(midBtn)midBtn.addEventListener('click',e=>{\n      e.preventDefault();\n      box.setAttribute('material','src:#mel');\n      CS1.socket.playerData.faceIndex = 2;\n      CS1.myPlayer._avatarType = config.avatar.models[CS1.socket.playerData.faceIndex].type;\n    });\n\n    let botBtn = document.querySelector('#bot-btn');\n    if(botBtn)botBtn.addEventListener('mouseenter',e=>{\n\n      if(CS1.stats.container.getAttribute('visible')&&m2.components.sound)m2.components.sound.playSound()\n\n    });\n    if(botBtn)botBtn.addEventListener('click',e=>{\n      e.preventDefault();\n      box.setAttribute('material','src:#vr1');\n      CS1.socket.playerData.faceIndex = 0;\n      CS1.myPlayer._avatarType = config.avatar.models[CS1.socket.playerData.faceIndex].type;\n    });\n\n\n    let Btn1 = document.querySelector('#b1');\n    if(Btn1)Btn1.addEventListener('mouseenter',e=>{\n\n      if(CS1.stats.container.getAttribute('visible')&&m1.components.sound)m1.components.sound.playSound()\n\n    });\n    Btn1.onclick = e=>{\n      CS1.__display__stats();\n    }\n\n    let Btn2 = document.querySelector('#b2');\n    if(Btn2)Btn2.addEventListener('mouseenter',e=>{\n\n      if(CS1.stats.container.getAttribute('visible')&&m1.components.sound)m1.components.sound.playSound()\n\n    });\n    Btn2.onclick = e=>{\n      m.innerHTML = page2;\n    }\n\n    let Btn3 = document.querySelector('#b3');\n    if(Btn3)Btn3.addEventListener('mouseenter',e=>{\n\n      if(CS1.stats.container.getAttribute('visible')&&m1.components.sound)m1.components.sound.playSound()\n\n    });\n    Btn3.onclick = e=>{\n      m.innerHTML = page3;\n    }\n\n    let Btn4 = document.querySelector('#b4');\n    if(Btn4)Btn4.addEventListener('mouseenter',e=>{\n\n      if(CS1.stats.container.getAttribute('visible')&&m1.components.sound)m1.components.sound.playSound()\n\n    });\n    Btn4.onclick = e=>{\n      m.innerHTML = page4;\n    }\n  \n },\n  \n  }","\nimport styles from './styles.html';\nimport panels from './panels.html';\nimport {controls} from './controls';\n\nexport default(()=>{\n\nAFRAME.registerSystem('vrui', {\n  schema: {\n\t  panels: {default: 3}\n  },\n  \n  dependencies: ['htmlembed'],\n  \n  init: ()=>{\n     \n    \n    \n    document.head.innerHTML += styles;\n    \n    const ec = document.createElement('a-entity');\n    ec.setAttribute('style','visibility:hidden');\n    ec.setAttribute('vrui','');\n    ec.id = 'embed-container';\n    ec.innerHTML = panels;\n    let scn = document.querySelector('a-scene');\n    scn.appendChild(ec);\n        \n    \n    document.addEventListener('gameStart',e=>{\n      \n      const w = document.createElement('div');\n      w.style.width = '100%';\n      w.style.height = '100%';\n      w.appendChild(CS1.stats.container);\n     \n      \n    CS1.__display__stats = function(){\n      const c = document.querySelector('#main');\n      c.innerHTML='';\n      c.appendChild(w); \n    }\n    \n    \n   document.querySelector('#main').appendChild(w);  \n      \n    let scn = document.querySelector('a-scene');\n    let ctr = document.querySelector('#embed-container');\n    ctr.setAttribute('visible',false);\n    ctr.setAttribute('position','0 0.3 0');\n    CS1.myPlayer.add(ctr);\n    CS1.stats.container = ctr;\n    let m = document.querySelector('#main');\n    let m1 = document.querySelector('#menu1');\n    let m2 = document.querySelector('#menu2');\n    m.setAttribute('htmlembed','');\n    m1.setAttribute('htmlembed','');\n    m2.setAttribute('htmlembed','');\n\n\n   controls.init();\n      \n      \n    document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.remove('screen')\n              })  \n      \n    \n    let lh = CS1.myPlayer.components.player.lh.components[\"oculus-touch-controls\"];\n    let rh = CS1.myPlayer.components.player.rh.components[\"oculus-touch-controls\"];\n    if(CS1.device==\"Oculus Quest\"){\n       //AFRAME.utils.device.checkHeadsetConnected()\n      \n        let cursor = document.querySelector('a-cursor');\n        cursor.pause();\n        if(CS1.cam.components.raycaster)CS1.cam.components.raycaster.pause();\n          lh.el.addEventListener('abuttondown',e=>{\n            CS1.stats.container.object3D.rotation.y = CS1.cam.object3D.rotation.y;\n            let v = CS1.stats.container.getAttribute('visible');\n            CS1.stats.container.setAttribute('visible',!v);\n            if(v){\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.remove('screen')\n              })\n            }else{\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.add('screen')\n              })\n            }\n          });\n          rh.el.addEventListener('abuttondown',e=>{\n            CS1.stats.container.object3D.rotation.y = CS1.cam.object3D.rotation.y;\n            let v = CS1.stats.container.getAttribute('visible');\n            CS1.stats.container.setAttribute('visible',!v); \n            if(v){\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.remove('screen')\n              })\n            }else{\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.add('screen')\n              })\n            }\n          });   \n    } else if(CS1.device==\"Standard\") {\n      \n      document.addEventListener('keypress',e=>{\n          if(e.code=='Backquote'){\n            CS1.stats.container.object3D.rotation.y = CS1.cam.object3D.rotation.y;\n            let v = CS1.stats.container.getAttribute('visible');\n            CS1.stats.container.setAttribute('visible',!v);\n            if(v){\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.remove('screen')\n              })\n            }else{\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.add('screen')\n              })\n            }\n          }\n        });       \n          \n    } else if(CS1.device==\"Mobile\"){\n      \n      \n      document.addEventListener('doubleTapMenu',e=>{\n        CS1.stats.container.object3D.rotation.y = CS1.cam.object3D.rotation.y;\n        let v = CS1.stats.container.getAttribute('visible');\n        CS1.stats.container.setAttribute('visible',!v);\n        if(v){\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.remove('screen')\n              })\n            }else{\n              document.querySelectorAll('.dark').forEach(e=>{\n               e.classList.add('screen')\n              })\n            }\n        \n      });\n      \n      \n    }  \n      \n      \n      \n    });\n    \n       \n    \n  },\n\n  \n  \n  \n});\n  \n})()","export default(()=>{\n\nAFRAME.registerComponent('chat', {\n  schema: {\n\t  inputColor: {default: '#fff'},\n    keyboardColor: {default: '#fff'},\n    highlightColor: {default: '#1a79dc'}\n  },\n  \n  dependencies: ['aframe-keyboard'],\n  \n  init: function(){\n    \n    \n    \n    this.container = document.createElement('a-entity');\n    this.container.setAttribute('visible',false);\n    \n    this.input = document.createElement('a-text');\n    this.input.setAttribute('font','dejavu');\n    this.input.setAttribute('color',this.data.inputColor);\n    this.input.setAttribute('value','Enter message ...');\n    this.input.setAttribute('scale','0.7 0.7 0.7');\n    this.input.setAttribute('rotation','-20 0 0');\n    this.input.setAttribute('position','-0.5 1.9 -1.5');\n    \n    this.keyboard = document.createElement('a-entity');\n    this.keyboard.setAttribute('a-keyboard','dismissable:false');\n    this.keyboard.setAttribute('position','-1 1.6 -1.5');\n    this.keyboard.setAttribute('rotation','-20 0 0');\n    this.keyboard.setAttribute('scale','4 4 4');\n    \n   \n    this.container.appendChild(this.input);\n    this.container.appendChild(this.keyboard);\n    this.el.appendChild(this.container);\n    \n    \n    \n    const self = this;\n    \n    document.addEventListener('gameStart',e=>{\n      \n      self.normalKeys = document.querySelectorAll('.collidable');\n          \n      document.querySelectorAll('.collidable').forEach(e=>{\n                 e.classList.remove('collidable')\n                });\n            \n        \n      const dummy = document.querySelector('#standard-chat-dummy');\n      \n      self.value = '';\n      \n      function submit(){\n        self.input.setAttribute('value', self.value);\n            self.container.setAttribute('visible',false);\n            document.querySelectorAll('.collidable').forEach(e=>{\n                 e.classList.remove('collidable')\n                }) \n            self.keyboard.components['a-keyboard'].pause();\n            document.removeEventListener('a-keyboard-update', updateInput)\n            CS1.socket.emit('msg',{msg:self.value});\n            dummy.blur(); \n      }\n      \n      function updateInput(e){\n        let code = parseInt(e.detail.code)\n        switch(code) {\n          case 8:\n            self.value = self.value.slice(0, -1)\n            break\n          case 999:\n            submit();\n            return\n          case 13:\n            submit();\n            return \n          default:\n            if(!e.detail.value)return;\n            if(e.detail.code==40)e.detail.value='\\n';\n            self.value = self.value + e.detail.value;\n            break\n          }\n          self.input.setAttribute('value', self.value + '_')\n      }\n      \n      \n      function submitQuest(){\n        self.input.setAttribute('value', self.value);\n            self.container.setAttribute('visible',false);\n            document.querySelectorAll('.collidable').forEach(e=>{\n                 e.classList.remove('collidable')\n                });\n            self.keyboard.components['a-keyboard'].pause();\n            document.removeEventListener('a-keyboard-update', updateInputQuest)\n            CS1.socket.emit('msg',{msg:self.value});\n      }\n      \n      \n      function updateInputQuest(e){\n        let code = parseInt(e.detail.code)\n        switch(code) {\n          case 8:\n            self.value = self.value.slice(0, -1)\n            break\n          case 999:\n            submitQuest();\n            return\n          default:\n            if(!e.detail.value)return;\n            if(e.detail.code==40)e.detail.value='\\n';\n            self.value = self.value + e.detail.value\n            break\n          }\n          self.input.setAttribute('value', self.value + '_')\n      }\n      \n      let lh = CS1.myPlayer.components.player.lh.components[\"oculus-touch-controls\"];\n      let rh = CS1.myPlayer.components.player.rh.components[\"oculus-touch-controls\"];\n      \n      switch(CS1.device){\n          \n        case \"Oculus Quest\":\n          \n          let cursor = document.querySelector('a-cursor');\n          cursor.pause();\n          if(CS1.cam.components.raycaster)CS1.cam.components.raycaster.pause();\n          lh.el.addEventListener('bbuttondown',e=>{\n            self.value = '';\n            self.input.setAttribute('value', self.value);\n            document.addEventListener('a-keyboard-update', updateInputQuest)\n            self.container.object3D.rotation.y = CS1.cam.object3D.rotation.y;\n            let v = self.container.getAttribute('visible');\n            self.container.setAttribute('visible',!v);\n            self.keyboard.components['a-keyboard'].play();\n            if(v){\n               document.querySelectorAll('.collidable').forEach(e=>{\n                 e.classList.remove('collidable')\n                });\n            }else{\n              self.keys.forEach(e=>{\n                 e.classList.add('collidable')\n                }) \n            }\n          });\n          rh.el.addEventListener('bbuttondown',e=>{\n            self.value = '';\n            self.input.setAttribute('value', self.value);\n            document.addEventListener('a-keyboard-update', updateInputQuest)\n            self.container.object3D.rotation.y = CS1.cam.object3D.rotation.y;\n            let v = self.container.getAttribute('visible');\n            self.container.setAttribute('visible',!v);\n            self.keyboard.components['a-keyboard'].play();\n            if(v){\n               document.querySelectorAll('.collidable').forEach(e=>{\n                 e.classList.remove('collidable')\n                });\n            }else{\n              AFK.template.toggleActiveMode('normal');\n            }\n          });  \n          \n          \n          \n          break;\n        case \"Mobile\":\n          CS1.chatInput = document.querySelector('#mobile-chat-input');\n          CS1.chatInput.style.position = 'absolute';\n          CS1.chatInput.style.top = '10px';\n          CS1.chatInput.style.margin = '0 auto';\n          \n          CS1.chatInput.addEventListener('keydown',e=>{\n            switch(e.keyCode){\n              case 13:\n                CS1.socket.emit('msg',{msg:CS1.chatInput.value});\n                CS1.chatInput.style.zIndex = -1000;\n                CS1.chatInput.style.top = '-100px';\n                CS1.chatInput.blur();\n                break;\n            }\n          });\n          document.addEventListener('doubleTapChat',e=>{\n            \n            if(CS1.chatInput.style.zIndex == -1000){\n              CS1.chatInput.style.zIndex = 200;\n              CS1.chatInput.style.top = '10px';\n            }else{\n              CS1.chatInput.style.zIndex = -1000;\n              CS1.chatInput.style.top = '-100px';\n            }\n\n            \n\n          });\n          \n          break;\n        case \"Standard\":\n          document.querySelector('#mobile-chat-input').setAttribute('style','position:absolute;top:-1000px');\n          const dummy = document.querySelector('#standard-chat-dummy');\n          document.addEventListener('keypress',e=>{\n            if(e.keyCode==61){\n              self.value = '';\n              self.input.setAttribute('value', self.value);\n              document.addEventListener('a-keyboard-update', updateInput)\n              self.container.object3D.rotation.y = CS1.cam.object3D.rotation.y;\n              let v = self.container.getAttribute('visible');\n              self.container.setAttribute('visible',!v); \n              self.keyboard.components['a-keyboard'].play();\n              if(v){\n               document.querySelectorAll('.collidable').forEach(e=>{\n                 dummy.blur();\n                 e.classList.remove('collidable');\n                })  \n            }else{\n              AFK.template.toggleActiveMode('normal');\n              self.normalKeys.forEach(e=>{\n                 dummy.focus();\n                 e.classList.add('collidable');\n                })  \n            }\n            }\n          });     \n          break;\n          \n      }\n      \n      \n    });\n    \n    \n    \n  },\n  \n \n  \n  \n});\n  \n})()","export default(()=>{\n\nAFRAME.registerComponent('cs1-jukebox', {\n  schema: {\n\t\n  },\n  \n  init: function(){\n    CS1.jukebox.audio.addEventListener('jukeboxplay',e=>{\n      CS1.socket.emit('jukebox',{action:'play',index:e.detail.index,player:CS1.myPlayer.name});\n      CS1.log(`${CS1.myPlayer.name} is playing ${CS1.jukebox.songNames[e.detail.index]}.`);\n    });\n    CS1.jukebox.audio.addEventListener('jukeboxpause',e=>{\n      CS1.socket.emit('jukebox',{action:'pause',player:CS1.myPlayer.name});\n      CS1.log(`${CS1.myPlayer.name} has paused the jukebox.`);\n    }); \n    CS1.socket.on('jukebox',data=>{\n      if(data.player==CS1.myPlayer.name)return;\n      switch(data.action){\n        case 'play':\n          CS1.jukebox.play(data.index);\n          CS1.log(`${data.player} is playing ${CS1.jukebox.songNames[data.index]}!`);\n          break;\n        case 'pause':\n          CS1.jukebox.pause(false);\n          CS1.log(`${data.player} has paused the jukebox!`);\n          break;\n      }\n    });\n  }\n});\n  \n})()","export default (()=>{\n  \n  document.addEventListener('gameStart',e=>{\n    \n  \n  });\n  \n  \n  AFRAME.registerComponent('mycomponent', {\n    \n    \n    schema: {\n      color: {default: 'red'}\n    },\n\n    init: function(){\n\n    }\n    \n    \n  });\n  \n\n\n  \n})()","let CS1 = window.CS1 = {};\nimport utils from './core/utils/utils';\nutils(CS1);\nimport loadSpinner from './core/load/load-spinner';\nimport './core/load/load-spinner.css';\nimport grabbable from './core/components/grabbable';\nimport navpointer from './core/components/nav-pointer';\nimport weatherviz from './core/components/weather-viz';\nimport shaderfrog from './core/components/shaderfrog/shader-frog';\nshaderfrog(CS1);\nimport particles from './aps/particles';\nparticles(CS1);\nimport proximityGlitch from './demo/components/proximity-glitch'\nproximityGlitch(CS1);\nimport stats from './stats/stats';\nimport './stats/stats.css';\nstats(CS1);\nimport game from './core/components/game';\ngame(CS1);\nimport player from './core/components/player';\nplayer(CS1);\nimport {bgmlite} from './core/services/bgm';\nbgmlite(CS1);\nimport socket from './core/socket/client-socket';\nsocket(CS1);\nimport collectible from './core/components/collectible';\ncollectible(CS1);\nimport './main.css';\nimport login from './core/login/login';\nimport './core/login/login.css';\nimport aframeEffects from './ae/aframe-effects';\nimport cloud from './demo/components/cloud';\nimport npc from './demo/components/npc';\nnpc(CS1);\nimport dotrow from './demo/components/dotrow';\nimport userdata from './core/components/userdata';\nuserdata(CS1);\nimport iotAPI from './demo/components/iot-api';\niotAPI(CS1);\nimport log from './core/components/log';\nimport launchable from './core/components/launchable';\nimport launchrow from './demo/components/launchrow';\nimport vrui from './core/components/vrui/vrui';\nimport chat from './core/components/chat';\nimport cs1Jukebox from './core/components/cs1-jukebox';\nimport mycomponents from './core/components/my-components';\n\n//supress console.warn\nwindow.console.warn = function(){};\n\n\n  \n\n  ","import config from '../../../.data/client-config.json';\nexport function bgmlite(CS1){\n  let tracks = config.bgm.songs;\n  let audio = document.createElement('audio');\n  let bgmUrlStart = 'https://api.soundcloud.com/tracks/';\n  let bgmUrlEnd = '/stream?client_id=b9d11449cd4c64d461b8b5c30650cd06';\n  // audio.src = bgmUrlStart +tracks[0]+ bgmUrlEnd;\n  // audio.crossorigin = 'anonymous';\n  // audio.autoplay = 'autoplay';\n  // if(config.bgm.playAll) audio.loop = true;\n  // audio.volume = 0.00;\n  \n  let nextSongBtn = document.createElement('button');\n  nextSongBtn.innerHTML = \"PLAY NEXT SONG\";\n  nextSongBtn.zIndex = 100;\n  nextSongBtn.style.display = \"none\";\n  nextSongBtn.addEventListener('click',e=>{\n    CS1.bgm.playNext();\n  });\n  let ui = document.createElement('div');\n  ui.style.margin = '0 auto';\n  ui.style.width = '800px';\n  setTimeout(()=>{\n   document.body.appendChild(ui);\n   ui.appendChild(nextSongBtn);\n  },5000);\n  \n  if(config.bgm.playAll){\n   audio.addEventListener('ended',e=>{\n    console.log('bgm song ended');\n    CS1.bgm.playNext();\n   });\n}\n  \nlet currentSongIndex = 0;\n  \n  CS1.bgm = {\n    tracks: tracks,\n    play: ()=>{\n      audio.volume = config.bgm.volume;\n      audio.play();\n    },\n    playTrackIndex: n=>{\n      currentSongIndex=n;\n      audio.src = bgmUrlStart + tracks[currentSongIndex] + bgmUrlEnd;\n      audio.crossorigin = 'anonymous';\n      audio.load();\n      audio.loop = !config.bgm.playAll;\n      audio.play();\n    },\n    pause: ()=>{\n      audio.pause();\n    },\n    playNext: ()=>{\n      currentSongIndex++;\n      if(currentSongIndex == tracks.length) currentSongIndex = 0;\n      audio.src = bgmUrlStart + tracks[currentSongIndex] + bgmUrlEnd;\n      audio.crossorigin = 'anonymous';\n      audio.load();\n      audio.loop = !config.bgm.playAll;\n      audio.play();\n    },\n    \n  }//end of CS1.bgm definition\n  \n   document.addEventListener('gameStart',e=>{\n    if(CS1.bgm.tracks.length) CS1.bgm.playTrackIndex(0);\n  })\n\n}//end of bgmlite\n\n\n"],"names":["CS1","utils","uid","firstItem","value","counter","split","reduce","acc","curValue","curIndex","arr","curObj","prev","now","Date","performance","toString","replace","Math","random","substr","isEqual","other","key","hasOwnProperty","item1","item2","itemType","Object","prototype","call","toColor","num","join","randomFromArray","array","length","floor","window","addEventListener","loadSpinner","document","createElement","className","i","appendChild","style","left","innerWidth","loadingScreen","querySelector","width","height","innerHeight","copyTransform","scratchMat","THREE","Matrix4","source","destination","matrix","copy","matrixWorld","applyMatrix","getInverse","parent","AFRAME","registerSystem","schema","init","grabbables","__updateGrabbables","grabbablesData","keys","name","game","hasBegun","forEach","d","index","b","debug","console","log","position","object3D","scale","rotation","quaternion","socket","on","origin","id","entity","type","setAttribute","set","data","x","y","z","setRotationFromQuaternion","Quaternion","w","soundState","custom","entries","scene","registerComponent","remote","default","onGameStart","device","self","el","e","grab","setTimeout","release","color","removeEventListener","cancelBubble","isDragging","cursor","detail","cursorEl","sceneEl","createProxyObject","originEl","emit","addState","proxyObject","remove","getAttribute","removeState","cursorObject","Object3D","visible","add","this","classList","components","String","_callbacks","msg","channel","c","s","src","nodeName","checkHeadsetConnected","tick","ctrlEl","active","intersection","point","raycaster","refreshObjects","side","url","dependencies","canvas","ctx","getContext","fillStyle","fillRect","dataProcessed","fetch","then","resp","json","processData","catch","err","dataToProcess","list","day","push","dt","dt_txt","temp_max","k2f","main","k","round","t","visualizeData","updateCanvas","dt_width","hue","drawRectangles","material","getObject3D","map","needsUpdate","shaders","Polkadot_Shader","Sun_Shader","Jelly_Shader","Green_Dance_Shader","Cosmic_Shader","Cool_Tiles_Shader","Disco_Shader","Marching_Ants_Shader","Goo_Shader","Psycho_Shader","Ova_Shader","Thruster_Shader","Flowing_Circles_Shader","Electric_Shader","CS1_Shader","ShaderRuntime","extend","arguments","obj","l","clone","omit","cloned","shaderfrog","mainCamera","cubeCameras","reserved","time","cameraPosition","umap","float","int","vec2","[object Object]","Vector2","vec3","Vector3","vec4","Vector4","samplerCube","sampler2D","camera","Camera","Error","renderTarget","identifier","config","findBy","shaderTypes","shader","newShaderData","runningShaders","oldName","newName","shaderType","initted","create","shaderName","uniform","newData","fragmentShader","fragment","vertexShader","vertex","uniformName","uniforms","getUmap","glslType","RawShaderMaterial","viewMatrix","matrixWorldInverse","registerCamera","systems","frog_runtime","clock","Clock","hasLoaded","bind","updateShaders","getElapsedTime","originalMaterial","shaderData","update","system","get","modules","__webpack_require__","moduleId","installedModules","exports","module","m","getter","o","defineProperty","configurable","enumerable","n","__esModule","object","property","p","BufferGeometryUtils","computeTangents","geometry","handleVertex","v","fromArray","normals","n2","tan1","tmp","sub","multiplyScalar","dot","normalize","tmp2","crossVectors","test","tan2","tangents","attributes","undefined","normal","uv","warn","indices","positions","uvs","nVertices","tangent","addAttribute","BufferAttribute","Float32Array","vA","vB","vC","uvA","uvB","uvC","sdir","tdir","groups","start","count","il","j","group","jl","a","x1","x2","y1","y2","z1","z2","s1","s2","t1","t2","r","mergeBufferGeometries","geometries","useGroups","isIndexed","attributesUsed","Set","morphAttributesUsed","morphAttributes","mergedGeometry","BufferGeometry","offset","has","userData","mergedUserData","addGroup","indexOffset","mergedIndex","getX","setIndex","mergedAttribute","mergeBufferAttributes","numMorphTargets","morphAttributesToMerge","mergedMorphAttribute","TypedArray","itemSize","normalized","arrayLength","attribute","isInterleavedBufferAttribute","constructor","transformPlane","particleIndex","originalArray","NUM_PLANE_POSITIONS","tri","vertices","rotateX","rotateY","rotateZ","copyArray","dest","BLENDINGS","NormalBlending","additive","AdditiveBlending","substractive","SubstractiveBlending","multiply","MultiplyBlending","SHADERS","flat","MeshBasicMaterial","lambert","MeshLambertMaterial","phong","MeshPhongMaterial","standard","MeshStandardMaterial","OFFSCREEN_VEC3","blending","oneOf","delay","dur","img","interpolate","loop","poolSize","protation","pscale","multiple","frame","framedata","indexPool","lastFrame","msPerFrame","numFrames","numParticles","originalVertexPositions","particleCount","particleSystems","restPositions","restRotations","sprite_rotation","useRotation","particles","oldData","loadParticlesJSON","parseInt","min","max","Array","materialParams","Color","DoubleSide","TextureLoader","load","depthWrite","opacity","transparent","createParticles","alive","jsonData","frames","precision","frameIndex","rawP","tempGeometries","numParticleSystems","isNaN","Number","MAX_VALUE","particleSystem","activeParticleIndices","loopCount","loopTotal","mesh","ratio","PlaneBufferGeometry","PI","mergedBufferGeometry","Mesh","setObject3D","evt","startAfterDelay","found","oldestTime","Euler","resetParticles","doLoop","resetParticle","rand","helperPositionVec3","delta","fdata","fdataNext","frameTime","particleSystemIndex","activeParticleIndex","lerpVectors","_transformPlane","Geometry","faces","Face3","dust","Particles_Dust","energy","Particles_Energy","orb","Particles_Orb","pos","posString","p1","p2","p3","fire","particleplayer","threshold","affects","sound","soundIsPlaying","baseEffects","playerDistanceTo","hud","setValue","playSound","defaults","labelText","suffix","labelColor","gradientColor1","gradientColor2","RingDial","opts","assign","size","strokeWidth","radius","cachedValue","targetValue","isAnimating","direction","svg","defs","slice","overlay","text","label","arrow","createSvg","createDefs","createSlice","createOverlay","createText","createLabel","container","createElementNS","gc1","gc2","linearGradient","stop1","stop2","linearGradientBackground","circle","navigator","vendor","includes","fontSize","tspanSize","innerHTML","createArrow","arrowYOffset","arrowSize","arrowPosX","arrowPosY","arrowDOffset","animateStart","intervalOne","setInterval","toFixed","clearInterval","animateTo","to","currentScale","changeBy","amt","animateReset","polarToCartesian","centerX","centerY","angleInDegrees","angleInRadians","cos","sin","describeArc","startAngle","endAngle","end","largeArcFlag","xy","Meter","low","high","optimum","widget","marginTop","marginBottom","parseFloat","range","textAlign","stats","statsElement","containers","top","pointerEvents","pointsDial","energyDial","magicDial","oxygenMeter","mode","isRunning","determineDevice","gameName","announcements","welcomeMsg","welcomeDelay","voice","display","voices","speechSynthesis","getVoices","say","SpeechSynthesisUtterance","filter","pitch","rate","volume","speak","sayall","printVoices","lang","sounds","soundName","Audio","scenes","otherPlayers","logall","myPlayer","leftHand","player","lh","rightHand","rh","event","CustomEvent","message","bubbles","cancelable","body","dispatchEvent","distanceTo","fireParticles","getVRDisplays","displays","scn","displayName","pause","isMobile","mylatesttap","mbc","icon","getTime","timesince","icon2","avatars","avatar","models","avatarType2Add","model","removeAttribute","HEAD","HAND_L","HAND_R","lefthand","righthand","__addOtherPlayer","newPlayerObject","faceIndex","avatarType","playerJoined","play","__updateOtherPlayers","op","yOffset","degToRad","isWalking","timePlayed","lhp","lhr","rhp","rhr","__removePlayer","parentNode","removeChild","playerLeft","__setPlayerMessage","me","eyelevel","cursorcolor","rayobjects","rayfar","speed","addCam","addHands","addMyListeners","spawnPos","spawnRot","totalSteps","ic","cam","cc","_","setOculusCtls","enterVR","loaded","traverse","node","isMesh","setTouchCtls","setKeyCtls","setSpeed","playerData","rot","_avatarType","which","setPlayerData","sendUpdateToServer","registerPrimitive","defaultComponents","mappings","io","authid","lastPlayerData","isInitialized","login","un","pw","success","zIndex","getElementById","clips","anim","firstElementChild","setAvatar","initializePlayerData","deepEqual","bodiesData","states","dirty","welcome","ibs","playersObject","playerLeftMsg","location","reload","collectibles","collectedEntity","sound__loop","sound__collect","cb","collector","cloneNode","spawns","spawnDelay","soundCollect","soundLoop","collect","parentElement","disconnected","indexOf","onload","preventDefault","connected","loginContainer","startSpeed","loginHTML","theme","overlayColor","formColor","logo","titleFontColor","formButtonColor","focus","code","Component","attrName","System","registerShader","definition","NewComponent","proto","writable","attr","NewSystem","fx","renderer","cameras","isArray","isPlaying","effects","chain","sys","pro","nd","render","behaviors","timeDelta","behavior","tock","Effects","passes","_passes","setupPostState","needsOverride","lightComponents","LightState","rows","cols","tileData","tileTexture","lightTexture","DataTexture","RGBAFormat","FloatType","addLight","removeLight","splice","WebGLRenderTarget","minFilter","LinearFilter","magFilter","format","texture","generateMipmaps","depthBuffer","depthTexture","DepthTexture","UnsignedShortType","stencilBuffer","Scene","OrthographicCamera","quad","frustumCulled","sceneLeft","quadLeft","sceneRight","quadRight","targets","tDiffuse","tDepth","cameraFar","cameraNear","uvClamp","uvBoth","resolution","uvLeft","uvRight","parseToken","renderPass","viewCb","forceClear","setView","h","viewport","scissor","setViewport","setScissor","isFn","getSize","oldClear","autoClear","materialize","fs","ShaderMaterial","depthTest","NoBlending","fog","extensions","derivatives","defines","fuse","temp","alpha","chunks","head","needsDepth","needsDiffuse","callMain","swapMain","args","tok","exec","prop","Document","textContent","depth","dataset","diffuse","trim","prefix","u","inc","t2u","f","v2","v3","v4","m2","m3","m4","premain","rebuild","pickup","pass","makepass","dispose","writeBuffer","readBuffer","vr","isActive","resize","bypass","needsResize","setSize","register","unregister","rt","effect","rts","onBeforeRender","resizeTiles","ArrayCamera","tileLights","rendererRender","setupPasses","far","near","ceil","Uint8Array","projectionMatrix","lights","image","ld","fill","vector","light","setFromMatrixPosition","pm","bs","lightBounds","applyMatrix4","toArray","decay","i4","i8","minX","maxX","minY","maxY","hw","hh","project","enabled","strength","smooth","pars","blurTarget","tockUniforms","blurDirection","sobel","blur","currentMaterial","blurMaterial","nIntensity","sIntensity","sCount","us","FXAAShader","BlurDirectionX","BlurDirectionY","enable","renderTargetsHorizontal","renderTargetsVertical","nMips","renderTargetBright","luminosityThreshold","smoothWidth","defaultColor","defaultOpacity","materialHighPassFilter","separableBlurMaterials","kernelSizeArray","getSeperableBlurMaterial","compositeMaterial","getCompositeMaterial","bloomFactors","bloomTintColors","oldClearColor","getClearColor","oldClearAlpha","getClearAlpha","oldAutoClear","setClearColor","inputRenderTarget","resx","resy","kernelRadius","KERNEL_RADIUS","SIGMA","colorTexture","texSize","NUM_MIPS","blurTexture1","blurTexture2","blurTexture3","blurTexture4","blurTexture5","bloomStrength","bloomRadius","shaderID","lut","lutClamp","lutFlip","mul","pow","right","quant","orig","red","green","blue","Texture","NearestFilter","ops","preFragment","q","g","tDisp","generateHeightmap","amount","angle","seed","seed_x","seed_y","distortion_x","distortion_y","col_s","glitch","curF","generateTrigger","randX","randFloat","randInt","dt_size","data_arr","val","RGBFormat","tint","intensity","rtFilter","rtTextureGodRays1","rtTextureGodRays2","step","materialGodraysGenerate","attenuation","materialFilter","fn","eye","cp3","cd3","getWorldPosition","getWorldDirection","stepLen","SAOShader","DepthLimitedBlurShader","samples","rings","maxDepth","bias","blurRadius","depthCutoff","renderTargets","SAOMaterial","hBlurMaterial","vBlurMaterial","sizeUniform","od","sao","isFirst","cameraProjectionMatrix","cameraInverseProjectionMatrix","minResolution","randomSeed","BlurShaderUtils","createSampleWeights","stdDev","weights","exp","sqrt","createSampleOffsets","uvIncrement","offsets","configure","sampleUvOffsets","sampleWeights","getMaterialData","emissive","emissiveIntensity","metalness","roughness","wireframe","wireframeLinewidth","normalMap","normalScale","ambientOcclusionMap","aoMapIntensity","ambientOcclusionMapIntensity","displacementMap","displacementScale","displacementBias","ShaderChunk","CubeLoader","CubeTextureLoader","texturePromises","ambientOcclusionTextureOffset","ambientOcclusionTextureRepeat","displacementTextureOffset","displacementTextureRepeat","envMap","metalnessMap","metalnessTextureOffset","metalnessTextureRepeat","normalTextureOffset","normalTextureRepeat","repeat","roughnessMap","roughnessTextureOffset","roughnessTextureRepeat","sphericalEnvMap","updateMap","updateDistortionMap","updateEnvMap","onBeforeCompile","State","updateMaterial","isLoadingEnvMap","loadTexture","mapping","SphericalReflectionMapping","handleTextureEvents","cube","Promise","resolve","srcLoader","validateCubemapSrc","urls","timeMsec","is","myOffset","myColor","pnoise3","waypoints","roam","waypointsIndex","moves","npc","addListeners","requestMove","onNavigationEnd","setPosition","move","setWaypoints","waypointsArray","addWaypoint","waypoint","error","change","changeDimension","elPosition","from","cdIsX","dots","firstInitTime","db","keyValueObject","LED","toggleLED","iot","onLED","offLED","setLED","state","logs","loggers","loggerComponent","receiveLog","registerLogger","component","apply","unregisterLogger","showErrors","onerror","errorMsg","lineNumber","column","errorObj","JSON","stringify","shift","sound__launch","burst","launchSound","grabbable","launchData","dir","getDir","ray","controls","runOnce","m1","target","show","box","topBtn","midBtn","botBtn","Btn1","onclick","__display__stats","Btn2","Btn3","Btn4","panels","ec","ctr","querySelectorAll","inputColor","keyboardColor","highlightColor","input","keyboard","submit","updateInput","dummy","submitQuest","updateInputQuest","normalKeys","AFK","template","toggleActiveMode","chatInput","margin","keyCode","jukebox","audio","action","songNames","proximityGlitch","tracks","bgm","songs","bgmUrlStart","bgmUrlEnd","nextSongBtn","playNext","ui","currentSongIndex","playTrackIndex","crossorigin","playAll","collectible","userdata","iotAPI"],"mappings":"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"}